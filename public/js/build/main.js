// i18next, v1.7.7
// Copyright (c)2014 Jan Mühlemann (jamuhl).
// Distributed under MIT license
// http://i18next.com

/*!
 * jQuery JavaScript Library v1.10.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:48Z
 */

/*!
 * Sizzle CSS Selector Engine v1.10.2
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03
 */

/*!
 * Bootstrap v3.3.5 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under the MIT license
 */

// Backbone.Validation v0.11.3
//
// Copyright (c) 2011-2015 Thomas Pedersen
// Distributed under MIT License
//
// Documentation and full license available at:
// http://thedersen.com/projects/backbone-validation

/*
  html2canvas 0.5.0-alpha1 <http://html2canvas.hertzen.com>
  Copyright (c) 2015 Niklas von Hertzen

  Released under MIT License
*/

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.0.1
 */

/*! https://mths.be/punycode v1.3.1 by @mathias */

/*
 * base64-arraybuffer
 * https://github.com/niklasvh/base64-arraybuffer
 *
 * Copyright (c) 2012 Niklas von Hertzen
 * Licensed under the MIT license.
 */

/*
 * Konva JavaScript Framework v0.10.0
 * http://konvajs.github.io/
 * Licensed under the MIT or GPL Version 2 licenses.
 * Date: Tue Oct 27 2015
 *
 * Original work Copyright (C) 2011 - 2013 by Eric Rowell (KineticJS)
 * Modified work Copyright (C) 2014 - 2015 by Anton Lavrenov (Konva)
 *
 * @license
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

/**
     * Sepia Filter
     * Based on: Pixastic Lib - Sepia filter - v0.1.0
     * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/
     * @function
     * @name Sepia
     * @memberof Konva.Filters
     * @param {Object} imageData
     * @author Jacob Seidelin <jseidelin@nihilogic.dk>
     * @license MPL v1.1 [http://www.pixastic.com/lib/license.txt]
     * @example
     * node.cache();
     * node.filters([Konva.Filters.Sepia]);
     */

!function(){function t(t){throw new Error(t)}function e(e){t(e)}if(function(){var t,e=this,n=e.Backbone,i=[],r=i.push,o=i.slice,a=i.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.0.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=t.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var i=this,r=s.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,o,a,l,h,u,d;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:s.keys(this._events),l=0,h=a.length;h>l;l++)if(t=a[l],o=this._events[t]){if(this._events[t]=i=[],e||n)for(u=0,d=o.length;d>u;u++)r=o[u],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&u(n,e),i&&u(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o];return this}},h=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(h.test(n)){for(var o=n.split(h),a=0,s=o.length;s>a;a++)t[e].apply(t,[o[a]].concat(i));return!1}return!0},u=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},d={listenTo:"on",listenToOnce:"once"};s.each(d,function(t,e){l[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=s.uniqueId("l"));return r[o]=e,"object"==typeof n&&(i=this),e[t](n,i,this),this}}),l.bind=l.on,l.unbind=l.off,s.extend(t,l);var f=t.Model=function(t,e){var n,i=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(e,p)),e.parse&&(i=this.parse(i,e)||{}),(n=s.result(this,"defaults"))&&(i=s.defaults({},i,n)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},p=["url","urlRoot","collection"];s.extend(f.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,o,a,l,h,c,u;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;o=n.unset,l=n.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=s.clone(this.attributes),this.changed={}),u=this.attributes,c=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)e=r[i],s.isEqual(u[i],e)||a.push(i),s.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e,o?delete u[i]:u[i]=e;if(!l){a.length&&(this._pending=!0);for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,u[a[d]],n)}if(h)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)s.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},R(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,r,o,a=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,!(!i||n&&n.wait||this.set(i,n)))return!1;if(n=s.extend({validate:!0},n),!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=s.extend({},a,i)),void 0===n.parse&&(n.parse=!0);var l=this,h=n.success;return n.success=function(t){l.attributes=a;var e=l.parse(t,n);return n.wait&&(e=s.extend(i||{},e)),s.isObject(e)&&!l.set(e,n)?!1:(h&&h(l,t,n),void l.trigger("sync",l,t,n))},R(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),o=this.sync(r,this,n),i&&n.wait&&(this.attributes=a),o},destroy:function(t){t=t?s.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1;R(this,t);var r=this.sync("delete",this,t);return t.wait||i(),r},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||$();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,s.extend(e||{},{validationError:n})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];s.each(g,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}});var m=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},v={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};s.extend(m.prototype,l,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.defaults(e||{},y))},remove:function(t,e){t=s.isArray(t)?t.slice():[t],e||(e={});var n,i,r,o;for(n=0,i=t.length;i>n;n++)o=this.get(t[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,e.silent||(e.index=r,o.trigger("remove",o,this,e)),this._removeReference(o));return this},set:function(t,e){e=s.defaults(e||{},v),e.parse&&(t=this.parse(t,e)),s.isArray(t)||(t=t?[t]:[]);var n,i,o,l,h,c=e.at,u=this.comparator&&null==c&&e.sort!==!1,d=s.isString(this.comparator)?this.comparator:null,f=[],p=[],g={};for(n=0,i=t.length;i>n;n++)(o=this._prepareModel(t[n],e))&&((l=this.get(o))?(e.remove&&(g[l.cid]=!0),e.merge&&(l.set(o.attributes,e),u&&!h&&l.hasChanged(d)&&(h=!0))):e.add&&(f.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(e.remove){for(n=0,i=this.length;i>n;++n)g[(o=this.models[n]).cid]||p.push(o);p.length&&this.remove(p,e)}if(f.length&&(u&&(h=!0),this.length+=f.length,null!=c?a.apply(this.models,[c,0].concat(f)):r.apply(this.models,f)),h&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=f.length;i>n;n++)(o=f[n]).trigger("add",o,this,e);return h&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models,this._reset(),this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,n){e||(e=this.comparator);var i=s.isFunction(e)?e:function(t){return t.get(e)};return s.sortedIndex(this.models,t,i,n)},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},R(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(r){e.wait&&n.add(t,e),i&&i(t,r,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(b,function(t){m.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var w=["groupBy","countBy","sortBy"];s.each(w,function(t){m.prototype[t]=function(e,n){var i=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,i,n)}});var x=t.View=function(t){this.cid=s.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];s.extend(x.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(s.isFunction(n)||(n=this[t[e]]),n){var i=e.match(S),r=i[1],o=i[2];n=s.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=s.extend({},s.result(this,"options"),t)),s.extend(this,s.pick(t,_)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className"));var n=t.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,i){var r=C[e];s.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(i.url||(o.url=s.result(n,"url")||$()),null!=i.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",i.emulateJSON&&(o.data._method=r);var a=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===o.type||i.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=i.xhr=t.ajax(s.extend(o,i));return n.trigger("request",n,l,i),l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,F=/(\(\?)?:\w+/g,E=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(k.prototype,l,{initialize:function(){},route:function(e,n,i){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var r=this;return t.history.route(e,function(o){var a=r._extractParameters(e,o);i&&i.apply(r,a),r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),t.history.trigger("route",r,n,a)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace(T,"(?:$1)?").replace(F,function(t,e){return e?t:"([^/]+)"}).replace(E,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return s.map(n,function(t){return t?decodeURIComponent(t):null})}});var D=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,L=/msie [\w.]+/,P=/\/$/;D.started=!1,s.extend(D.prototype,l,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(P,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(N,"")},start:function(e){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,r=L.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(M,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),D.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!D.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),t.history=new D;var I=function(t,e){var n,i=this;n=t&&s.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},s.extend(n,i,e);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,t&&s.extend(n.prototype,t),n.__super__=i.prototype,n};f.extend=m.extend=k.extend=x.extend=D.extend=I;var $=function(){throw new Error('A "url" property or function must be specified')},R=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}}}.call(this),define("backbone",function(){}),!function(){function t(t,e){if(!e||"function"==typeof e)return t;for(var n in e)t[n]=e[n];return t}function e(t,n){for(var i in n)i in t?e(t[i],n[i]):t[i]=n[i];return t}function n(t,e,n){var i,r=0,o=t.length,a=void 0===o||"[object Array]"!==Object.prototype.toString.apply(t)||"function"==typeof t;if(n)if(a){for(i in t)if(e.apply(t[i],n)===!1)break}else for(;o>r&&e.apply(t[r++],n)!==!1;);else if(a){for(i in t)if(e.call(t[i],i,t[i])===!1)break}else for(;o>r&&e.call(t[r],r,t[r++])!==!1;);return t}function i(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,function(t){return H[t]}):t}function r(t){var e=function(t){if(window.XMLHttpRequest)return t(null,new XMLHttpRequest);if(window.ActiveXObject)try{return t(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(e){return t(null,new ActiveXObject("Microsoft.XMLHTTP"))}return t(new Error)},n=function(t){if("string"==typeof t)return t;var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},i=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n);128>i?e+=String.fromCharCode(i):i>127&&2048>i?(e+=String.fromCharCode(192|i>>6),e+=String.fromCharCode(128|63&i)):(e+=String.fromCharCode(224|i>>12),e+=String.fromCharCode(128|63&i>>6),e+=String.fromCharCode(128|63&i))}return e},r=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t=i(t);var n,r,o,a,s,l,h,c="",u=0;do n=t.charCodeAt(u++),r=t.charCodeAt(u++),o=t.charCodeAt(u++),a=n>>2,s=(3&n)<<4|r>>4,l=(15&r)<<2|o>>6,h=63&o,isNaN(r)?l=h=64:isNaN(o)&&(h=64),c+=e.charAt(a)+e.charAt(s)+e.charAt(l)+e.charAt(h),n=r=o="",a=s=l=h="";while(u<t.length);return c},o=function(){for(var t=arguments[0],e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},a=function(t,i,r,s){"function"==typeof r&&(s=r,r={}),r.cache=r.cache||!1,r.data=r.data||{},r.headers=r.headers||{},r.jsonp=r.jsonp||!1,r.async=void 0===r.async?!0:r.async;var l,h=o({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},a.headers,r.headers);if(l="application/json"===h["content-type"]?JSON.stringify(r.data):n(r.data),"GET"===t){var c=[];if(l&&(c.push(l),l=null),r.cache||c.push("_="+(new Date).getTime()),r.jsonp&&(c.push("callback="+r.jsonp),c.push("jsonp="+r.jsonp)),c=c.join("&"),c.length>1&&(i+=i.indexOf("?")>-1?"&"+c:"?"+c),r.jsonp){var u=document.getElementsByTagName("head")[0],d=document.createElement("script");return d.type="text/javascript",d.src=i,void u.appendChild(d)}}e(function(e,n){if(e)return s(e);n.open(t,i,r.async);for(var o in h)h.hasOwnProperty(o)&&n.setRequestHeader(o,h[o]);n.onreadystatechange=function(){if(4===n.readyState){var t=n.responseText||"";if(!s)return;s(n.status,{text:function(){return t},json:function(){try{return JSON.parse(t)}catch(e){return U.error("Can not parse JSON. URL: "+i),{}}}})}},n.send(l)})},s={authBasic:function(t,e){a.headers.Authorization="Basic "+r(t+":"+e)},connect:function(t,e,n){return a("CONNECT",t,e,n)},del:function(t,e,n){return a("DELETE",t,e,n)},get:function(t,e,n){return a("GET",t,e,n)},head:function(t,e,n){return a("HEAD",t,e,n)},headers:function(t){a.headers=t||{}},isAllowed:function(t,e,n){this.options(t,function(t,i){n(-1!==i.text().indexOf(e))})},options:function(t,e,n){return a("OPTIONS",t,e,n)},patch:function(t,e,n){return a("PATCH",t,e,n)},post:function(t,e,n){return a("POST",t,e,n)},put:function(t,e,n){return a("PUT",t,e,n)},trace:function(t,e,n){return a("TRACE",t,e,n)}},l=t.type?t.type.toLowerCase():"get";s[l](t.url,t,function(e,n){200===e||0===e&&n.text()?t.success(n.json(),e,null):t.error(n.text(),e,null)})}function o(t,e){"function"==typeof t&&(e=t,t={}),t=t||{},U.extend(j,t),delete j.fixLng,j.functions&&(delete j.functions,U.extend(U,t.functions)),"string"==typeof j.ns&&(j.ns={namespaces:[j.ns],defaultNs:j.ns}),"string"==typeof j.fallbackNS&&(j.fallbackNS=[j.fallbackNS]),("string"==typeof j.fallbackLng||"boolean"==typeof j.fallbackLng)&&(j.fallbackLng=[j.fallbackLng]),j.interpolationPrefixEscaped=U.regexEscape(j.interpolationPrefix),j.interpolationSuffixEscaped=U.regexEscape(j.interpolationSuffix),j.lng||(j.lng=U.detectLanguage()),R=U.toLanguages(j.lng),N=R[0],U.log("currentLng set to: "+N),j.useCookie&&U.cookie.read(j.cookieName)!==N&&U.cookie.create(j.cookieName,N,j.cookieExpirationTime,j.cookieDomain),j.detectLngFromLocalStorage&&"undefined"!=typeof document&&window.localStorage&&U.localStorage.setItem("i18next_lng",N);var n=k;t.fixLng&&(n=function(t,e){return e=e||{},e.lng=e.lng||n.lng,k(t,e)},n.lng=N),X.setCurrentLng(N),L&&j.setJqueryExt&&y();var i;if(L&&L.Deferred&&(i=L.Deferred()),!j.resStore){var r=U.toLanguages(j.lng);"string"==typeof j.preload&&(j.preload=[j.preload]);for(var o=0,a=j.preload.length;a>o;o++)for(var s=U.toLanguages(j.preload[o]),l=0,h=s.length;h>l;l++)r.indexOf(s[l])<0&&r.push(s[l]);return P.sync.load(r,j,function(t,r){I=r,O=!0,e&&e(n),i&&i.resolve(n)}),i?i.promise():void 0}return I=j.resStore,O=!0,e&&e(n),i&&i.resolve(n),i?i.promise():void 0}function a(t,e){"string"==typeof t&&(t=[t]);for(var n=0,i=t.length;i>n;n++)j.preload.indexOf(t[n])<0&&j.preload.push(t[n]);return o(e)}function s(t,e,n,i){"string"!=typeof e?(n=e,e=j.ns.defaultNs):j.ns.namespaces.indexOf(e)<0&&j.ns.namespaces.push(e),I[t]=I[t]||{},I[t][e]=I[t][e]||{},i?U.deepExtend(I[t][e],n):U.extend(I[t][e],n)}function l(t,e){"string"!=typeof e&&(e=j.ns.defaultNs),I[t]=I[t]||{};var n=I[t][e]||{},i=!1;for(var r in n)n.hasOwnProperty(r)&&(i=!0);return i}function h(t,e){"string"!=typeof e&&(e=j.ns.defaultNs),I[t]=I[t]||{},I[t][e]={}}function c(t,e,n,i){"string"!=typeof e?(resource=e,e=j.ns.defaultNs):j.ns.namespaces.indexOf(e)<0&&j.ns.namespaces.push(e),I[t]=I[t]||{},I[t][e]=I[t][e]||{};for(var r=n.split(j.keyseparator),o=0,a=I[t][e];r[o];)o==r.length-1?a[r[o]]=i:(null==a[r[o]]&&(a[r[o]]={}),a=a[r[o]]),o++}function u(t,e,n){"string"!=typeof e?(resource=e,e=j.ns.defaultNs):j.ns.namespaces.indexOf(e)<0&&j.ns.namespaces.push(e);for(var i in n)"string"==typeof n[i]&&c(t,e,i,n[i])}function d(t){j.ns.defaultNs=t}function f(t,e){p([t],e)}function p(t,e){var n={dynamicLoad:j.dynamicLoad,resGetPath:j.resGetPath,getAsync:j.getAsync,customLoad:j.customLoad,ns:{namespaces:t,defaultNs:""}},i=U.toLanguages(j.lng);"string"==typeof j.preload&&(j.preload=[j.preload]);for(var r=0,o=j.preload.length;o>r;r++)for(var a=U.toLanguages(j.preload[r]),s=0,l=a.length;l>s;s++)i.indexOf(a[s])<0&&i.push(a[s]);for(var h=[],c=0,u=i.length;u>c;c++){var d=!1,f=I[i[c]];if(f)for(var p=0,g=t.length;g>p;p++)f[t[p]]||(d=!0);else d=!0;d&&h.push(i[c])}h.length?P.sync._fetch(h,n,function(n,i){var r=t.length*h.length;U.each(t,function(t,n){j.ns.namespaces.indexOf(n)<0&&j.ns.namespaces.push(n),U.each(h,function(t,o){I[o]=I[o]||{},I[o][n]=i[o][n],r--,0===r&&e&&(j.useLocalStorage&&P.sync._storeLocal(I),e())})})}):e&&e()}function g(t,e,n){return"function"==typeof e?(n=e,e={}):e||(e={}),e.lng=t,o(e,n)}function m(){return N}function v(t){I={},g(N,t)}function y(){function t(t,e,n){if(0!==e.length){var i="text";if(0===e.indexOf("[")){var r=e.split("]");e=r[1],i=r[0].substr(1,r[0].length-1)}e.indexOf(";")===e.length-1&&(e=e.substr(0,e.length-2));var o;if("html"===i)o=j.defaultValueFromContent?L.extend({defaultValue:t.html()},n):n,t.html(L.t(e,o));else if("text"===i)o=j.defaultValueFromContent?L.extend({defaultValue:t.text()},n):n,t.text(L.t(e,o));else if("prepend"===i)o=j.defaultValueFromContent?L.extend({defaultValue:t.html()},n):n,t.prepend(L.t(e,o));else if("append"===i)o=j.defaultValueFromContent?L.extend({defaultValue:t.html()},n):n,t.append(L.t(e,o));else if(0===i.indexOf("data-")){var a=i.substr("data-".length);o=j.defaultValueFromContent?L.extend({defaultValue:t.data(a)},n):n;var s=L.t(e,o);t.data(a,s),t.attr(i,s)}else o=j.defaultValueFromContent?L.extend({defaultValue:t.attr(i)},n):n,t.attr(i,L.t(e,o))}}function e(e,n){var i=e.attr(j.selectorAttr);if(i||"undefined"==typeof i||i===!1||(i=e.text()||e.val()),i){var r=e,o=e.data("i18n-target");if(o&&(r=e.find(o)||e),n||j.useDataAttrOptions!==!0||(n=e.data("i18n-options")),n=n||{},i.indexOf(";")>=0){var a=i.split(";");L.each(a,function(e,i){""!==i&&t(r,i,n)})}else t(r,i,n);j.useDataAttrOptions===!0&&e.data("i18n-options",n)}}L.t=L.t||k,L.fn.i18n=function(t){return this.each(function(){e(L(this),t);var n=L(this).find("["+j.selectorAttr+"]");n.each(function(){e(L(this),t)})})}}function b(t,e,n,i){if(!t)return t;if(i=i||e,t.indexOf(i.interpolationPrefix||j.interpolationPrefix)<0)return t;var r=i.interpolationPrefix?U.regexEscape(i.interpolationPrefix):j.interpolationPrefixEscaped,o=i.interpolationSuffix?U.regexEscape(i.interpolationSuffix):j.interpolationSuffixEscaped,a="HTML"+o,s=e.replace&&"object"==typeof e.replace?e.replace:e;return U.each(s,function(e,s){var l=n?n+j.keyseparator+e:e;"object"==typeof s&&null!==s?t=b(t,s,l,i):i.escapeInterpolation||j.escapeInterpolation?(t=t.replace(new RegExp([r,l,a].join(""),"g"),U.regexReplacementEscape(s)),t=t.replace(new RegExp([r,l,o].join(""),"g"),U.regexReplacementEscape(U.escape(s)))):t=t.replace(new RegExp([r,l,o].join(""),"g"),U.regexReplacementEscape(s))}),t}function w(t,e){var n=",",i="{",r="}",o=U.extend({},e);for(delete o.postProcess;-1!=t.indexOf(j.reusePrefix)&&($++,!($>j.maxRecursion));){var a=t.lastIndexOf(j.reusePrefix),s=t.indexOf(j.reuseSuffix,a)+j.reuseSuffix.length,l=t.substring(a,s),h=l.replace(j.reusePrefix,"").replace(j.reuseSuffix,"");if(a>=s)return U.error("there is an missing closing in following translation value",t),"";if(-1!=h.indexOf(n)){var c=h.indexOf(n);if(-1!=h.indexOf(i,c)&&-1!=h.indexOf(r,c)){var u=h.indexOf(i,c),d=h.indexOf(r,u)+r.length;try{o=U.extend(o,JSON.parse(h.substring(u,d))),h=h.substring(0,c)}catch(f){}}}var p=E(h,o);t=t.replace(l,U.regexReplacementEscape(p))}return t}function x(t){return t.context&&("string"==typeof t.context||"number"==typeof t.context)}function S(t){return void 0!==t.count&&"string"!=typeof t.count}function _(t){return void 0!==t.indefinite_article&&"string"!=typeof t.indefinite_article&&t.indefinite_article}function C(t,e){e=e||{};var n=T(t,e),i=A(t,e);return void 0!==i||i===n}function k(t,e){return e=e||{},O?($=0,E.apply(null,arguments)):(U.log("i18next not finished initialization. you might have called t function before loading resources finished."),e.defaultValue||"")}function T(t,e){return void 0!==e.defaultValue?e.defaultValue:t}function F(){for(var t=[],e=1;e<arguments.length;e++)t.push(arguments[e]);return{postProcess:"sprintf",sprintf:t}}function E(t,e){if(e&&"object"!=typeof e?"sprintf"===j.shortcutFunction?e=F.apply(null,arguments):"defaultValue"===j.shortcutFunction&&(e={defaultValue:e}):e=e||{},"object"==typeof j.defaultVariables&&(e=U.extend({},j.defaultVariables,e)),void 0===t||null===t||""===t)return"";"string"==typeof t&&(t=[t]);var n=t[0];if(t.length>1)for(var i=0;i<t.length&&(n=t[i],!C(n,e));i++);var r,o=T(n,e),a=A(n,e),s=e.lng?U.toLanguages(e.lng,e.fallbackLng):R,l=e.ns||j.ns.defaultNs;n.indexOf(j.nsseparator)>-1&&(r=n.split(j.nsseparator),l=r[0],n=r[1]),void 0===a&&j.sendMissing&&"function"==typeof j.missingKeyHandler&&(e.lng?j.missingKeyHandler(s[0],l,n,o,s):j.missingKeyHandler(j.lng,l,n,o,s));var h=e.postProcess||j.postProcess;void 0!==a&&h&&Y[h]&&(a=Y[h](a,n,e));var c=o;if(o.indexOf(j.nsseparator)>-1&&(r=o.split(j.nsseparator),c=r[1]),c===n&&j.parseMissingKey&&(o=j.parseMissingKey(o)),void 0===a&&(o=b(o,e),o=w(o,e),h&&Y[h])){var u=T(n,e);a=Y[h](u,n,e)}return void 0!==a?a:o}function A(t,e){e=e||{};var n,i,r=T(t,e),o=R;if(!I)return r;if("cimode"===o[0].toLowerCase())return r;if(e.lngs&&(o=e.lngs),e.lng&&(o=U.toLanguages(e.lng,e.fallbackLng),!I[o[0]])){var a=j.getAsync;j.getAsync=!1,P.sync.load(o,j,function(t,e){U.extend(I,e),j.getAsync=a})}var s=e.ns||j.ns.defaultNs;if(t.indexOf(j.nsseparator)>-1){var l=t.split(j.nsseparator);s=l[0],t=l[1]}if(x(e)){n=U.extend({},e),delete n.context,n.defaultValue=j.contextNotFound;var h=s+j.nsseparator+t+"_"+e.context;if(i=k(h,n),i!=j.contextNotFound)return b(i,{context:e.context})}if(S(e,o[0])){n=U.extend({lngs:[o[0]]},e),delete n.count,delete n.lng,n.defaultValue=j.pluralNotFound;var c;if(X.needsPlural(o[0],e.count)){c=s+j.nsseparator+t+j.pluralSuffix;var u=X.get(o[0],e.count);u>=0?c=c+"_"+u:1===u&&(c=s+j.nsseparator+t)}else c=s+j.nsseparator+t;if(i=k(c,n),i!=j.pluralNotFound)return b(i,{count:e.count,interpolationPrefix:e.interpolationPrefix,interpolationSuffix:e.interpolationSuffix});if(!(o.length>1))return i;var d=o.slice();if(d.shift(),e=U.extend(e,{lngs:d}),delete e.lng,i=k(s+j.nsseparator+t,e),i!=j.pluralNotFound)return i}if(_(e)){var f=U.extend({},e);delete f.indefinite_article,f.defaultValue=j.indefiniteNotFound;var p=s+j.nsseparator+t+(e.count&&!S(e,o[0])||!e.count?j.indefiniteSuffix:"");if(i=k(p,f),i!=j.indefiniteNotFound)return i}for(var g,m=t.split(j.keyseparator),v=0,y=o.length;y>v&&void 0===g;v++){for(var C=o[v],F=0,D=I[C]&&I[C][s];m[F];)D=D&&D[m[F]],F++;if(void 0!==D){var N=Object.prototype.toString.apply(D);if("string"==typeof D)D=b(D,e),D=w(D,e);else if("[object Array]"!==N||j.returnObjectTrees||e.returnObjectTrees){if(null===D&&j.fallbackOnNull===!0)D=void 0;else if(null!==D)if(j.returnObjectTrees||e.returnObjectTrees){
if("[object Number]"!==N&&"[object Function]"!==N&&"[object RegExp]"!==N){var M="[object Array]"===N?[]:{};U.each(D,function(n){M[n]=E(s+j.nsseparator+t+j.keyseparator+n,e)}),D=M}}else j.objectTreeKeyHandler&&"function"==typeof j.objectTreeKeyHandler?D=j.objectTreeKeyHandler(t,D,C,s,e):(D="key '"+s+":"+t+" ("+C+")' returned an object instead of string.",U.log(D))}else D=D.join("\n"),D=b(D,e),D=w(D,e);"string"==typeof D&&""===D.trim()&&j.fallbackOnEmpty===!0&&(D=void 0),g=D}}if(void 0===g&&!e.isFallbackLookup&&(j.fallbackToDefaultNS===!0||j.fallbackNS&&j.fallbackNS.length>0)){if(e.isFallbackLookup=!0,j.fallbackNS.length){for(var L=0,$=j.fallbackNS.length;$>L;L++)if(g=A(j.fallbackNS[L]+j.nsseparator+t,e),g||""===g&&j.fallbackOnEmpty===!1){var O=g.indexOf(j.nsseparator)>-1?g.split(j.nsseparator)[1]:g,z=r.indexOf(j.nsseparator)>-1?r.split(j.nsseparator)[1]:r;if(O!==z)break}}else g=A(t,e);e.isFallbackLookup=!1}return g}function D(){var t,e=j.lngWhitelist||[],n=[];if("undefined"!=typeof window&&!function(){for(var t=window.location.search.substring(1),e=t.split("&"),i=0;i<e.length;i++){var r=e[i].indexOf("=");if(r>0){var o=e[i].substring(0,r);o==j.detectLngQS&&n.push(e[i].substring(r+1))}}}(),j.useCookie&&"undefined"!=typeof document){var i=U.cookie.read(j.cookieName);i&&n.push(i)}if(j.detectLngFromLocalStorage&&"undefined"!=typeof window&&window.localStorage&&n.push(window.localStorage.getItem("i18next_lng")),"undefined"!=typeof navigator){if(navigator.languages)for(var r=0;r<navigator.languages.length;r++)n.push(navigator.languages[r]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return function(){for(var i=0;i<n.length;i++){var r=n[i];if(r.indexOf("-")>-1){var o=r.split("-");r=j.lowerCaseLng?o[0].toLowerCase()+"-"+o[1].toLowerCase():o[0].toLowerCase()+"-"+o[1].toUpperCase()}if(0===e.length||e.indexOf(r)>-1){t=r;break}}}(),t||(t=j.fallbackLng[0]),t}Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var i=0;if(arguments.length>0&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&1/0!=i&&i!=-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=n)return-1;for(var r=i>=0?i:Math.max(n-Math.abs(i),0);n>r;r++)if(r in e&&e[r]===t)return r;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var i=n;arguments.length>1&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&i!=1/0&&i!=-(1/0)&&(i=(i>0||-1)*Math.floor(Math.abs(i))));for(var r=i>=0?Math.min(i,n-1):n-Math.abs(i);r>=0;r--)if(r in e&&e[r]===t)return r;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var N,M=this,L=M.jQuery||M.Zepto,P={},I={},$=0,R=[],O=!1,z={};if("undefined"!=typeof module&&module.exports){if(!L)try{L=require("jquery")}catch(B){}L&&(L.i18n=L.i18n||P),module.exports=P}else L&&(L.i18n=L.i18n||P),M.i18n=M.i18n||P;z={load:function(t,e,n){e.useLocalStorage?z._loadLocal(t,e,function(i,r){for(var o=[],a=0,s=t.length;s>a;a++)r[t[a]]||o.push(t[a]);o.length>0?z._fetch(o,e,function(t,e){U.extend(r,e),z._storeLocal(e),n(null,r)}):n(null,r)}):z._fetch(t,e,function(t,e){n(null,e)})},_loadLocal:function(t,e,n){var i={},r=(new Date).getTime();if(window.localStorage){var o=t.length;U.each(t,function(t,a){var s=window.localStorage.getItem("res_"+a);s&&(s=JSON.parse(s),s.i18nStamp&&s.i18nStamp+e.localStorageExpirationTime>r&&(i[a]=s)),o--,0===o&&n(null,i)})}},_storeLocal:function(t){if(window.localStorage)for(var e in t)t[e].i18nStamp=(new Date).getTime(),U.localStorage.setItem("res_"+e,JSON.stringify(t[e]))},_fetch:function(t,e,n){var i=e.ns,r={};if(e.dynamicLoad){var o=function(t,e){n(null,e)};if("function"==typeof e.customLoad)e.customLoad(t,i.namespaces,e,o);else{var a=b(e.resGetPath,{lng:t.join("+"),ns:i.namespaces.join("+")});U.ajax({url:a,success:function(t){U.log("loaded: "+a),o(null,t)},error:function(t,e,n){U.log("failed loading: "+a),o("failed loading resource.json error: "+n)},dataType:"json",async:e.getAsync})}}else{var s,l=i.namespaces.length*t.length;U.each(i.namespaces,function(i,o){U.each(t,function(t,i){var a=function(t,e){t&&(s=s||[],s.push(t)),r[i]=r[i]||{},r[i][o]=e,l--,0===l&&n(s,r)};"function"==typeof e.customLoad?e.customLoad(i,o,e,a):z._fetchOne(i,o,e,a)})})}},_fetchOne:function(t,e,n,i){var r=b(n.resGetPath,{lng:t,ns:e});U.ajax({url:r,success:function(t){U.log("loaded: "+r),i(null,t)},error:function(t,e,n){if(e&&200==e||t&&t.status&&200==t.status)U.error("There is a typo in: "+r);else if(e&&404==e||t&&t.status&&404==t.status)U.log("Does not exist: "+r);else{var o=e?e:t&&t.status?t.status:null;U.log(o+" when loading "+r)}i(n,{})},dataType:"json",async:n.getAsync})},postMissing:function(t,e,n,i,r){var o={};o[n]=i;var a=[];if("fallback"===j.sendMissingTo&&j.fallbackLng[0]!==!1)for(var s=0;s<j.fallbackLng.length;s++)a.push({lng:j.fallbackLng[s],url:b(j.resPostPath,{lng:j.fallbackLng[s],ns:e})});else if("current"===j.sendMissingTo||"fallback"===j.sendMissingTo&&j.fallbackLng[0]===!1)a.push({lng:t,url:b(j.resPostPath,{lng:t,ns:e})});else if("all"===j.sendMissingTo)for(var s=0,l=r.length;l>s;s++)a.push({lng:r[s],url:b(j.resPostPath,{lng:r[s],ns:e})});for(var h=0,c=a.length;c>h;h++){var u=a[h];U.ajax({url:u.url,type:j.sendType,data:o,success:function(){U.log("posted missing key '"+n+"' to: "+u.url);for(var t=n.split("."),r=0,o=I[u.lng][e];t[r];)o=o[t[r]]=r===t.length-1?i:o[t[r]]||{},r++},error:function(){U.log("failed posting missing key '"+n+"' to: "+u.url)},dataType:"json",async:j.postAsync})}},reload:v};var j={lng:void 0,load:"all",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",detectLngFromLocalStorage:!1,ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"locales/__lng__/__ns__.json",resPostPath:"locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",defaultVariables:!1,reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,indefiniteSuffix:"_indefinite",indefiniteNotFound:["indefinite_not_found",Math.random()].join(""),setJqueryExt:!0,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,missingKeyHandler:z.postMissing,shortcutFunction:"sprintf"},H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},W={create:function(t,e,n,i){var r;if(n){var o=new Date;o.setTime(o.getTime()+6e4*n),r="; expires="+o.toGMTString()}else r="";i=i?"domain="+i+";":"",document.cookie=t+"="+e+r+";"+i+"path=/"},read:function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null},remove:function(t){this.create(t,"",-1)}},G={create:function(){},read:function(){return null},remove:function(){}},U={extend:L?L.extend:t,deepExtend:e,each:L?L.each:n,ajax:L?L.ajax:"undefined"!=typeof document?r:function(){},cookie:"undefined"!=typeof document?W:G,detectLanguage:D,escape:i,log:function(t){j.debug&&"undefined"!=typeof console&&console.log(t)},error:function(t){"undefined"!=typeof console&&console.error(t)},getCountyIndexOfLng:function(t){var e=0;return("nb-NO"===t||"nn-NO"===t||"nb-no"===t||"nn-no"===t)&&(e=1),e},toLanguages:function(t){function e(t){var e=t;if("string"==typeof t&&t.indexOf("-")>-1){var n=t.split("-");e=j.lowerCaseLng?n[0].toLowerCase()+"-"+n[1].toLowerCase():n[0].toLowerCase()+"-"+n[1].toUpperCase()}else e=j.lowerCaseLng?t.toLowerCase():t;return e}var n=this.log,i=[],r=j.lngWhitelist||!1,o=function(t){!r||r.indexOf(t)>-1?i.push(t):n("rejecting non-whitelisted language: "+t)};if("string"==typeof t&&t.indexOf("-")>-1){var a=t.split("-");"unspecific"!==j.load&&o(e(t)),"current"!==j.load&&o(e(a[this.getCountyIndexOfLng(t)]))}else o(e(t));for(var s=0;s<j.fallbackLng.length;s++)-1===i.indexOf(j.fallbackLng[s])&&j.fallbackLng[s]&&i.push(e(j.fallbackLng[s]));return i},regexEscape:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},regexReplacementEscape:function(t){return"string"==typeof t?t.replace(/\$/g,"$$$$"):t},localStorage:{setItem:function(t,e){if(window.localStorage)try{window.localStorage.setItem(t,e)}catch(n){U.log('failed to set value for key "'+t+'" to localStorage.')}}}};U.applyReplacement=b;var q=[["ach","Acholi",[1,2],1],["af","Afrikaans",[1,2],2],["ak","Akan",[1,2],1],["am","Amharic",[1,2],1],["an","Aragonese",[1,2],2],["ar","Arabic",[0,1,2,3,11,100],5],["arn","Mapudungun",[1,2],1],["ast","Asturian",[1,2],2],["ay","Aymará",[1],3],["az","Azerbaijani",[1,2],2],["be","Belarusian",[1,2,5],4],["bg","Bulgarian",[1,2],2],["bn","Bengali",[1,2],2],["bo","Tibetan",[1],3],["br","Breton",[1,2],1],["bs","Bosnian",[1,2,5],4],["ca","Catalan",[1,2],2],["cgg","Chiga",[1],3],["cs","Czech",[1,2,5],6],["csb","Kashubian",[1,2,5],7],["cy","Welsh",[1,2,3,8],8],["da","Danish",[1,2],2],["de","German",[1,2],2],["dev","Development Fallback",[1,2],2],["dz","Dzongkha",[1],3],["el","Greek",[1,2],2],["en","English",[1,2],2],["eo","Esperanto",[1,2],2],["es","Spanish",[1,2],2],["es_ar","Argentinean Spanish",[1,2],2],["et","Estonian",[1,2],2],["eu","Basque",[1,2],2],["fa","Persian",[1],3],["fi","Finnish",[1,2],2],["fil","Filipino",[1,2],1],["fo","Faroese",[1,2],2],["fr","French",[1,2],9],["fur","Friulian",[1,2],2],["fy","Frisian",[1,2],2],["ga","Irish",[1,2,3,7,11],10],["gd","Scottish Gaelic",[1,2,3,20],11],["gl","Galician",[1,2],2],["gu","Gujarati",[1,2],2],["gun","Gun",[1,2],1],["ha","Hausa",[1,2],2],["he","Hebrew",[1,2],2],["hi","Hindi",[1,2],2],["hr","Croatian",[1,2,5],4],["hu","Hungarian",[1,2],2],["hy","Armenian",[1,2],2],["ia","Interlingua",[1,2],2],["id","Indonesian",[1],3],["is","Icelandic",[1,2],12],["it","Italian",[1,2],2],["ja","Japanese",[1],3],["jbo","Lojban",[1],3],["jv","Javanese",[0,1],13],["ka","Georgian",[1],3],["kk","Kazakh",[1],3],["km","Khmer",[1],3],["kn","Kannada",[1,2],2],["ko","Korean",[1],3],["ku","Kurdish",[1,2],2],["kw","Cornish",[1,2,3,4],14],["ky","Kyrgyz",[1],3],["lb","Letzeburgesch",[1,2],2],["ln","Lingala",[1,2],1],["lo","Lao",[1],3],["lt","Lithuanian",[1,2,10],15],["lv","Latvian",[1,2,0],16],["mai","Maithili",[1,2],2],["mfe","Mauritian Creole",[1,2],1],["mg","Malagasy",[1,2],1],["mi","Maori",[1,2],1],["mk","Macedonian",[1,2],17],["ml","Malayalam",[1,2],2],["mn","Mongolian",[1,2],2],["mnk","Mandinka",[0,1,2],18],["mr","Marathi",[1,2],2],["ms","Malay",[1],3],["mt","Maltese",[1,2,11,20],19],["nah","Nahuatl",[1,2],2],["nap","Neapolitan",[1,2],2],["nb","Norwegian Bokmal",[1,2],2],["ne","Nepali",[1,2],2],["nl","Dutch",[1,2],2],["nn","Norwegian Nynorsk",[1,2],2],["no","Norwegian",[1,2],2],["nso","Northern Sotho",[1,2],2],["oc","Occitan",[1,2],1],["or","Oriya",[2,1],2],["pa","Punjabi",[1,2],2],["pap","Papiamento",[1,2],2],["pl","Polish",[1,2,5],7],["pms","Piemontese",[1,2],2],["ps","Pashto",[1,2],2],["pt","Portuguese",[1,2],2],["pt_br","Brazilian Portuguese",[1,2],2],["rm","Romansh",[1,2],2],["ro","Romanian",[1,2,20],20],["ru","Russian",[1,2,5],4],["sah","Yakut",[1],3],["sco","Scots",[1,2],2],["se","Northern Sami",[1,2],2],["si","Sinhala",[1,2],2],["sk","Slovak",[1,2,5],6],["sl","Slovenian",[5,1,2,3],21],["so","Somali",[1,2],2],["son","Songhay",[1,2],2],["sq","Albanian",[1,2],2],["sr","Serbian",[1,2,5],4],["su","Sundanese",[1],3],["sv","Swedish",[1,2],2],["sw","Swahili",[1,2],2],["ta","Tamil",[1,2],2],["te","Telugu",[1,2],2],["tg","Tajik",[1,2],1],["th","Thai",[1],3],["ti","Tigrinya",[1,2],1],["tk","Turkmen",[1,2],2],["tr","Turkish",[1,2],1],["tt","Tatar",[1],3],["ug","Uyghur",[1],3],["uk","Ukrainian",[1,2,5],4],["ur","Urdu",[1,2],2],["uz","Uzbek",[1,2],1],["vi","Vietnamese",[1],3],["wa","Walloon",[1,2],1],["wo","Wolof",[1],3],["yo","Yoruba",[1,2],2],["zh","Chinese",[1],3]],V={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(){return 0},4:function(t){return Number(1==t%10&&11!=t%100?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2)},5:function(t){return Number(0===t?0:1==t?1:2==t?2:t%100>=3&&10>=t%100?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&4>=t?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:7>t?2:11>t?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&20>t?2:3)},12:function(t){return Number(1!=t%10||11==t%100)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(1==t%10&&11!=t%100?0:t%10>=2&&(10>t%100||t%100>=20)?1:2)},16:function(t){return Number(1==t%10&&11!=t%100?0:0!==t?1:2)},17:function(t){return Number(1==t||1==t%10?0:1)},18:function(t){return Number(1==t?1:2)},19:function(t){return Number(1==t?0:0===t||t%100>1&&11>t%100?1:t%100>10&&20>t%100?2:3)},20:function(t){return Number(1==t?0:0===t||t%100>0&&20>t%100?1:2)},21:function(t){return Number(1==t%100?1:2==t%100?2:3==t%100||4==t%100?3:0)}},X={rules:function(){var t,e={};for(t=q.length;t--;)e[q[t][0]]={name:q[t][1],numbers:q[t][2],plurals:V[q[t][3]]};return e}(),addRule:function(t,e){X.rules[t]=e},setCurrentLng:function(t){if(!X.currentRule||X.currentRule.lng!==t){var e=t.split("-");X.currentRule={lng:t,rule:X.rules[e[0]]}}},needsPlural:function(t,e){var n,i=t.split("-");return n=X.currentRule&&X.currentRule.lng===t?X.currentRule.rule:X.rules[i[U.getCountyIndexOfLng(t)]],n&&n.numbers.length<=1?!1:1!==this.get(t,e)},get:function(t,e){function n(e,n){var i;if(i=X.currentRule&&X.currentRule.lng===t?X.currentRule.rule:X.rules[e]){var r;r=i.noAbs?i.plurals(n):i.plurals(Math.abs(n));var o=i.numbers[r];return 2===i.numbers.length&&1===i.numbers[0]&&(2===o?o=-1:1===o&&(o=1)),o}return 1===n?"1":"-1"}var i=t.split("-");return n(i[U.getCountyIndexOfLng(t)],e)}},Y={},J=function(t,e){Y[t]=e},Q=function(){function t(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function e(t,e){for(var n=[];e>0;n[--e]=t);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,i){var r,o,a,s,l,h,c,u=1,d=n.length,f="",p=[];for(o=0;d>o;o++)if(f=t(n[o]),"string"===f)p.push(n[o]);else if("array"===f){if(s=n[o],s[2])for(r=i[u],a=0;a<s[2].length;a++){if(!r.hasOwnProperty(s[2][a]))throw Q('[sprintf] property "%s" does not exist',s[2][a]);r=r[s[2][a]]}else r=s[1]?i[s[1]]:i[u++];if(/[^s]/.test(s[8])&&"number"!=t(r))throw Q("[sprintf] expecting number but found %s",t(r));switch(s[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=s[7]?r.toExponential(s[7]):r.toExponential();break;case"f":r=s[7]?parseFloat(r).toFixed(s[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&s[7]?r.substring(0,s[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(s[8])&&s[3]&&r>=0?"+"+r:r,h=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",c=s[6]-String(r).length,l=s[6]?e(h,c):"",p.push(s[5]?r+l:l+r)}return p.join("")},n.cache={},n.parse=function(t){for(var e=t,n=[],i=[],r=0;e;){if(null!==(n=/^[^\x25]+/.exec(e)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(e)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(e)))throw"[sprintf] huh?";if(n[2]){r|=1;var o=[],a=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?";for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?";o.push(s[1])}n[2]=o}else r|=2;if(3===r)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(n)}e=e.substring(n[0].length)}return i},n}(),K=function(t,e){return e.unshift(t),Q.apply(null,e)};J("sprintf",function(t,e,n){return n.sprintf?"[object Array]"===Object.prototype.toString.apply(n.sprintf)?K(t,n.sprintf):"object"==typeof n.sprintf?Q(t,n.sprintf):t:t}),P.init=o,P.setLng=g,P.preload=a,P.addResourceBundle=s,P.hasResourceBundle=l,P.addResource=c,P.addResources=u,P.removeResourceBundle=h,P.loadNamespace=f,P.loadNamespaces=p,P.setDefaultNamespace=d,P.t=k,P.translate=k,P.exists=C,P.detectLanguage=U.detectLanguage,P.pluralExtensions=X,P.sync=z,P.functions=U,P.lng=m,P.addPostProcessor=J,P.options=j}(),define("i18n",function(){}),define("models/profile/option",["backbone"],function(t){return t.Model.extend({initialize:function(){},defaults:{name:null,value:null,type:null}})}),function(t,e){"object"==typeof exports&&"function"==typeof require?module.exports=e(require("backbone")):"function"==typeof define&&define.amd?define("localstorage",["backbone"],function(n){return e(n||t.Backbone)}):e(Backbone)}(this,function(t){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function n(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function i(t){return t===Object(t)}function r(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1}function o(t,e){for(var n in e)t[n]=e[n];return t}function a(t,e){if(null==t)return void 0;var n=t[e];return"function"==typeof n?t[e]():n}return t.LocalStorage=window.Store=function(t,e){if(!this.localStorage)throw"Backbone.localStorage: Environment does not support localStorage.";this.name=t,this.serializer=e||{serialize:function(t){return i(t)?JSON.stringify(t):t},deserialize:function(t){return t&&JSON.parse(t)}};var n=this.localStorage().getItem(this.name);this.records=n&&n.split(",")||[]},o(t.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(t){return!t.id&&0!==t.id&&(t.id=n(),t.set(t.idAttribute,t.id)),this.localStorage().setItem(this._itemName(t.id),this.serializer.serialize(t)),this.records.push(t.id.toString()),this.save(),this.find(t)},update:function(t){this.localStorage().setItem(this._itemName(t.id),this.serializer.serialize(t));var e=t.id.toString();return r(this.records,e)||(this.records.push(e),this.save()),this.find(t)},find:function(t){return this.serializer.deserialize(this.localStorage().getItem(this._itemName(t.id)))},findAll:function(){for(var t,e,n=[],i=0;i<this.records.length;i++)t=this.records[i],e=this.serializer.deserialize(this.localStorage().getItem(this._itemName(t))),null!=e&&n.push(e);return n},destroy:function(t){this.localStorage().removeItem(this._itemName(t.id));for(var e=t.id.toString(),n=0;n<this.records.length;n++)this.records[n]===e&&this.records.splice(n,1);return this.save(),t},localStorage:function(){return localStorage},_clear:function(){var t=this.localStorage(),e=new RegExp("^"+this.name+"-");t.removeItem(this.name);for(var n in t)e.test(n)&&t.removeItem(n);this.records.length=0},_storageSize:function(){return this.localStorage().length},_itemName:function(t){return this.name+"-"+t}}),t.LocalStorage.sync=window.Store.sync=t.localSync=function(e,n,i){var r,o,s=a(n,"localStorage")||a(n.collection,"localStorage"),l=t.$?t.$.Deferred&&t.$.Deferred():t.Deferred&&t.Deferred();try{switch(e){case"read":r=void 0!=n.id?s.find(n):s.findAll();break;case"create":r=s.create(n);break;case"update":r=s.update(n);break;case"delete":r=s.destroy(n)}}catch(h){o=22===h.code&&0===s._storageSize()?"Private browsing is unsupported":h.message}return r?(i&&i.success&&("0.9.10"===t.VERSION?i.success(n,r,i):i.success(r)),l&&l.resolve(r)):(o=o?o:"Record Not Found",i&&i.error&&("0.9.10"===t.VERSION?i.error(n,o,i):i.error(o)),l&&l.reject(o)),i&&i.complete&&i.complete(r),l&&l.promise()},t.ajaxSync=t.sync,t.getSyncMethod=function(e,n){var i=n&&n.ajaxSync;return i||!a(e,"localStorage")&&!a(e.collection,"localStorage")?t.ajaxSync:t.localSync},t.sync=function(e,n,i){return t.getSyncMethod(n,i).apply(this,[e,n,i])},t.LocalStorage}),define("collections/profile/options",["backbone","models/profile/option","localstorage"],function(t,e,n){var i=t.Collection.extend({model:e,localStorage:new t.LocalStorage("profile")});return i}),define("models/server",["backbone"],function(t){return t.Model.extend({initialize:function(){},defaults:{code:null,name:null,host:null}})}),define("models/chat/message",["backbone"],function(t){return t.Model.extend({initialize:function(){},defaults:{id:null,link:null,type:null,user_id:null,moderator:null,color:null,message:null,time_send:null}})}),define("collections/chat/messages",["backbone","models/chat/message"],function(t,e){var n=t.Collection.extend({model:e,comparator:function(t){return parseInt(t.get("time_send"))}});return n}),define("services/chatsManager",["backbone","collections/chat/messages"],function(t,e){function n(){_.extend(this,t.Events),this.messages={}}return n.prototype.setListByTypes=function(t){for(var n in t)void 0===this.messages[n]&&(this.messages[n]=new e),this.messages[n].set(t[n])},n.prototype.getLastMessages=function(t,e){var n=this.getListByType("public").sort().last(t);_.each(n,function(t){e(t)})},n.prototype.getListByType=function(t){return void 0===this.messages[t]&&(this.messages[t]=new e),this.messages[t]},n}),define("models/profile",["backbone","collections/profile/options","models/server","services/chatsManager"],function(t,n,i,r){return t.Model.extend({defaultOptions:{openChat:"public"},initialize:function(){this.chatsManager=new r,this.options=new n},setFacebookResponse:function(t){this.fb=t},getFacebookResponse:function(){return this.fb},setLang:function(t,e){this.lang=t,this.trigger("changeLang",t,e)},getLang:function(){return this.lang},setServer:function(t){!t instanceof i&&e("Server type invalid",t),this.server=t},getServer:function(){return this.server},defaults:{id:!1},login:function(t){this.set(t)},logout:function(){delete this.access_token,delete this.signkey},getOption:function(t){var e=this.options.findWhere({name:t});if(!e){var n={name:t};void 0!==this.defaultOptions[t]&&(n.value=this.defaultOptions[t]),e=this.profile.options.create(n)}return e.save(),e.get("value")},setOption:function(t,e){var n=this.options.findWhere({name:"test"});return n?n.set("value",e):n=this.profile.options.create({name:t,value:e}),n.save(),this}})}),define("services/templates",[],function(){function t(t){this.list=t}return t.prototype.get=function(t){return this.list[t]},t}),define("services/auth",[],function(){function t(t){this.profile=t,this.token=null}return t.prototype.is=function(){return void 0!==this.token&&null!==this.token&&this.token!==!1},t.prototype.logout=function(){this.token=null,this.profile.set("id",!1)},t.prototype.login=function(t,e){this.token=t,this.profile.set(e)},t}),define("collections/servers",["backbone","models/server"],function(t,e){var n=t.Collection.extend({model:e});return n}),define("services/Listener",["backbone"],function(t){function e(){_.extend(this,t.Events),this.listeners={}}return e.prototype.init=function(t,e){var n=this;window.WebSocket=window.WebSocket||window.MozWebSocket;var i=t.split("//"),r="https:"==i[0]?"wss":"ws",o="wss"==r?8020:8010,i=i[1].split("/"),a=r+"://"+i[0]+":"+o;this.connection=new WebSocket(a),this.connection.onerror=function(t){},this.connection.onclose=function(i){1e3!=i.code&&setTimeout(function(){n.init(t,e)},5e3)},$(window).on("beforeunload",function(){void 0!==n.connection&&"function"==typeof n.connection.close&&n.connection.close()}),this.connection.onmessage=function(t){var e=JSON.parse(t.data);console.info("socket",e),n.trigger(e.channel,e.messages)},this.connection.onopen=function(t){"function"==typeof e&&e()}},e.prototype.create=function(t,e){this.on(t,"update",e)},e.prototype.reset=function(){this.connection.close();for(var t in this.listeners);},e}),define("app",["backbone","i18n","models/profile","services/templates","services/auth","collections/servers","services/Listener"],function(t,n,i,r,o,a,s){function l(e){_.extend(this,t.Events),this.profile=new i,this.windows={},this.profile.lang=e.langDefault,this.auth=new o(this.profile),this.serverList=new a,this.listener=new s;var n=this;this.profile.on("changeLang",function(t,e){n.setLang(t,e)}),this.config=e}return l.prototype.init=function(){try{this.initAnimation();var t=this;this.initDefaults(),this.initI18n(function(){t.initTemplates(function(){t.initProfile(function(){t.dispatch("index","index",{})})})})}catch(e){console.error(e.message)}},l.prototype.initAnimation=function(){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t)}}();var t,e,n,i,r,o=!1,t=30,a=1e3/t;i=Date.now(),e=i;var s=this;!function l(){o||(requestAnimFrame(l),n=Date.now(),r=n-i,r>a&&(s.trigger("frame",n),i=n-r%a))}()},l.prototype.route=function(t){this.router.navigate(t,{trigger:!0})},l.prototype.initDefaults=function(){var e=this;t.Model.prototype.toJSON=function(){var e=_.clone(this.attributes);for(var n in e)(e[n]instanceof t.Model||e[n]instanceof t.Collection)&&(e[n]=e[n].toJSON());return e},t.Model.prototype.sync=function(e,n,i){var r=n.localStorage||n.collection.localStorage;if(console.log("store",r),r){var o;switch(e){case"read":o=n.id?r.find(n):r.findAll();break;case"create":o=r.create(n);break;case"update":o=r.update(n);break;case"delete":o=r.destroy(n)}o?i.success(o):i.error("Record not found")}else{if("function"==typeof n.methodUrl){var a=n.methodUrl(e.toLowerCase());i=i||{},i.type="POST",i.error=function(t){console.log("response error",t)},i.url=a}t.sync(e,n,i)}},_.template.escapeHtml=function(t){return $("<div/>").html(t).text()},_.template.nl2br=function(t){return t.replace(/\n/g,"<br/>")},_.template.date=function(t,e){var n=new Date;n.setHours(0,0,0,0);var i=new Date(1e3*t),r=i.getHours();r=(10>r?"0":"")+r;var o=i.getMinutes();o=(10>o?"0":"")+o;var a=i.getUTCFullYear(),s=i.getUTCMonth()+1;s=(10>s?"0":"")+s;var l=i.getUTCDate();l=(10>l?"0":"")+l;var h=this;if("function"!=typeof e)if("min"==e)var e=function(t,e,n,i,r){return t+":"+e};else var e=function(t,e,r,o,a){return i.getTime()>=n.getTime()?h.t("time.today in")+" "+t+":"+e:i.getTime()>=n.getTime()-864e5?h.t("time.yesterday in")+" "+t+":"+e:t+":"+e+" "+r+"-"+o+"-"+a};return e(r,o,l,s,a)},$(window).resize(function(){e.trigger("resize",{})})},l.prototype.initListener=function(){this.listener.init(this.profile.getServer().get("host"))},l.prototype.window=function(t,e,n){var i=this;this.controllerName=void 0!==t?t:"index",this.actionName=void 0!==e?e:"index",$.proxy(require(["controllers/"+this.controllerName],function(t){var e=function(t){if("object"==typeof t){t.app=i;var e=i.controllerName+"/"+i.actionName;require(["views/"+i.controllerName+"/"+i.actionName],function(n){var r=new n(t);r.layout=i.layout,r.render(),$("#app").append(r.el),i.windows[e]=r})}},r=t[i.actionName+"Window"](i,n);if(r=void 0===r?{}:r,r!==!1){var o=function(t){e(t)},a=function(t){"function"==typeof t?t(function(t){a(t)}):o(t)};a(r)}}),this)},l.prototype.dispatch=function(t,e,n){var i=this;this.controllerName=void 0!==t?t:"index",this.actionName=void 0!==e?e:"index",$.proxy(require(["controllers/"+this.controllerName],function(t){var e=function(t){"object"==typeof t&&(t.app=i,require(["views/"+i.controllerName+"/"+i.actionName],function(e){void 0!==i.view&&i.view.remove(),i.view=new e(t),i.view.layout=i.layout,i.view.render(),$("#app").html(i.view.el)}))},r=t[i.actionName+"Action"](i,n);if(r=void 0===r?{}:r,r!==!1){var o=function(t){e(t)},a=function(t){"function"==typeof t?t(function(t){a(t)}):o(t)};a(r)}}),this)},l.prototype.play=function(t){var e=this,n=this.profile.getFacebookResponse();n.type="facebook",this.request("user.play",n,function(n){"success"==n.status?(e.profile.set({access_token:n.access_token,signkey:n.signkey}),t.success(),e.requestHome({},{success:function(){e.dispatch("city","index"),e.initListener()}})):t.error()},function(e){t.error()})},l.prototype.request=function(t,e,n,i,r){var o="undefined"!=typeof r&&r?"POST":"GET",a=this,s=new Date,l=this.profile.getServer()?this.profile.getServer().get("host"):window.location.origin+"/";this.profile.getServer()&&(e.token=this.profile.get("access_token"));var h=l+"api/"+t;$.ajax({type:o,dataType:"json",data:e,url:h}).done(function(t){"undefined"!=typeof t.time_request&&(a.timeDiff=s.getTime()-Math.ceil(1e3*parseFloat(t.time_request))),n(t)}).fail(function(t,e){a.window("index","error",t.responseJSON),"function"==typeof i&&i(t,e)})},l.prototype.requestHome=function(t,e){var n=this;this.request("user.home",t,function(t){"success"==t.status?(n.profile.chatsManager.setListByTypes(t.chatlists),e.success()):e.error()},function(t){e.error()},null,t)},l.prototype.requestChatAdd=function(t,e){this.request("chat.add",t,function(t){"success"==t.status?e.success():e.error(t.error)},function(t){e.error()},null,t)},l.prototype.upgradeServerList=function(t){var n=this;this.getServerListRequest(function(i){n.serverList.set(i.list),n.serverList.length||e("ServerList is empty"),t()})},l.prototype.getServerListRequest=function(t,e){this.request("index.getServerList",{},t,e)},l.prototype.initProfile=function(t){if(this.profile.options.fetch(),this.auth.is()){var e=this;this.profile.fetch({success:function(e,n){console.log("success",n),t()},error:function(n,i){e.auth.logout(),console.log("error",i),t()}})}else t()},l.prototype.initTemplates=function(e){var n=this;this.request("index.templates",{},function(i){n.templates=new r(i.list),t.View.prototype.links=function(t){return n.route($(t.currentTarget).attr("href")),!1},t.View.prototype.pagination=function(t,e,n,i,r){var o=$(t).data("page"),a=$(t).data("page_count");o=void 0!==o&&o?parseInt(o):1,a=void 0!==a&&a?parseInt(a):1;var s=this;i.upload=!1;var l=function(e,o,a){n.call(s,e,a),_.defer(function(){i.bind(t),1==a&&("function"==typeof r&&r(t),$(t).data("page_count",o),$(t).scroll(function(t){t.preventDefault();var e=$(t.target).height(),n=t.target.scrollTop,i=t.target.scrollHeight-1-e,r=n/i;r>=1&&o>=a+1&&(console.log("end"),a++,h(a))})),i.upload=!1})},h=function(n,r){i.upload||($(t).data("page",n),i.upload=!0,1==n&&void 0!==r?l(r,n):e.call(s,function(t,e){l(t,e,n)},n))};h(o)},t.View.prototype.getTemplate=function(t){var e=$('<script type="text/template">'+n.templates.get(t)+"</script>").html();return _.template(e)},e()})},l.prototype.initRouter=function(){if(void 0===this.config.routes)throw new Error("routes not set in config");this.router=new(Router(this))},l.prototype.initI18n=function(t){$.i18n.init({lng:"en",lng:this.config.langDefault,fallbackLng:"dev",fallbackNS:[],fallbackToDefaultNS:!1,fallbackOnNull:!0,fallbackOnEmpty:!1,load:"all",preload:[],supportedLngs:[],lowerCaseLng:!1,ns:"translation",resGetPath:"http://another.local/js/app/locales/__lng__/__ns__.json",resSetPath:"http://another.local/js/app/locales/__lng__/new.__ns__.json",saveMissing:!1,resStore:!1,returnObjectTrees:!1,interpolationPrefix:"__",interpolationSuffix:"__",postProcess:"",parseMissingKey:"",debug:!1,objectTreeKeyHandler:null,lngWhitelist:null},function(t){$(".layout").text("lang: "+$.t("index.Language"))})},l.prototype.setLang=function(t,e){$.i18n.setLng(t,function(t,n){e()})},l.prototype.requestLogout=function(t){$.get("/api/user.logout",function(){t()},"json")},l.prototype.requestCountryList=function(t){$.get("/api/location.getCountryList",function(){
t()},"json")},l}),function(t,e){function n(t){var e=t.length,n=ct.type(t);return ct.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===n||"function"!==n&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function i(t){var e=kt[t]={};return ct.each(t.match(dt)||[],function(t,n){e[n]=!0}),e}function r(t,n,i,r){if(ct.acceptData(t)){var o,a,s=ct.expando,l=t.nodeType,h=l?ct.cache:t,c=l?t[s]:t[s]&&s;if(c&&h[c]&&(r||h[c].data)||i!==e||"string"!=typeof n)return c||(c=l?t[s]=et.pop()||ct.guid++:s),h[c]||(h[c]=l?{}:{toJSON:ct.noop}),("object"==typeof n||"function"==typeof n)&&(r?h[c]=ct.extend(h[c],n):h[c].data=ct.extend(h[c].data,n)),a=h[c],r||(a.data||(a.data={}),a=a.data),i!==e&&(a[ct.camelCase(n)]=i),"string"==typeof n?(o=a[n],null==o&&(o=a[ct.camelCase(n)])):o=a,o}}function o(t,e,n){if(ct.acceptData(t)){var i,r,o=t.nodeType,a=o?ct.cache:t,l=o?t[ct.expando]:ct.expando;if(a[l]){if(e&&(i=n?a[l]:a[l].data)){ct.isArray(e)?e=e.concat(ct.map(e,ct.camelCase)):e in i?e=[e]:(e=ct.camelCase(e),e=e in i?[e]:e.split(" ")),r=e.length;for(;r--;)delete i[e[r]];if(n?!s(i):!ct.isEmptyObject(i))return}(n||(delete a[l].data,s(a[l])))&&(o?ct.cleanData([t],!0):ct.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(t,n,i){if(i===e&&1===t.nodeType){var r="data-"+n.replace(Ft,"-$1").toLowerCase();if(i=t.getAttribute(r),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Tt.test(i)?ct.parseJSON(i):i}catch(o){}ct.data(t,n,i)}else i=e}return i}function s(t){var e;for(e in t)if(("data"!==e||!ct.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(){return!0}function h(){return!1}function c(){try{return J.activeElement}catch(t){}}function u(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function d(t,e,n){if(ct.isFunction(e))return ct.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return ct.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(Ht.test(e))return ct.filter(e,t,n);e=ct.filter(e,t)}return ct.grep(t,function(t){return ct.inArray(t,e)>=0!==n})}function f(t){var e=qt.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}function p(t,e){return ct.nodeName(t,"table")&&ct.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function g(t){return t.type=(null!==ct.find.attr(t,"type"))+"/"+t.type,t}function m(t){var e=re.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function v(t,e){for(var n,i=0;null!=(n=t[i]);i++)ct._data(n,"globalEval",!e||ct._data(e[i],"globalEval"))}function y(t,e){if(1===e.nodeType&&ct.hasData(t)){var n,i,r,o=ct._data(t),a=ct._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(i=0,r=s[n].length;r>i;i++)ct.event.add(e,n,s[n][i])}a.data&&(a.data=ct.extend({},a.data))}}function b(t,e){var n,i,r;if(1===e.nodeType){if(n=e.nodeName.toLowerCase(),!ct.support.noCloneEvent&&e[ct.expando]){r=ct._data(e);for(i in r.events)ct.removeEvent(e,i,r.handle);e.removeAttribute(ct.expando)}"script"===n&&e.text!==t.text?(g(e).text=t.text,m(e)):"object"===n?(e.parentNode&&(e.outerHTML=t.outerHTML),ct.support.html5Clone&&t.innerHTML&&!ct.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===n&&ee.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}}function w(t,n){var i,r,o=0,a=typeof t.getElementsByTagName!==X?t.getElementsByTagName(n||"*"):typeof t.querySelectorAll!==X?t.querySelectorAll(n||"*"):e;if(!a)for(a=[],i=t.childNodes||t;null!=(r=i[o]);o++)!n||ct.nodeName(r,n)?a.push(r):ct.merge(a,w(r,n));return n===e||n&&ct.nodeName(t,n)?ct.merge([t],a):a}function x(t){ee.test(t.type)&&(t.defaultChecked=t.checked)}function S(t,e){if(e in t)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),i=e,r=Ce.length;r--;)if(e=Ce[r]+n,e in t)return e;return i}function _(t,e){return t=e||t,"none"===ct.css(t,"display")||!ct.contains(t.ownerDocument,t)}function C(t,e){for(var n,i,r,o=[],a=0,s=t.length;s>a;a++)i=t[a],i.style&&(o[a]=ct._data(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&_(i)&&(o[a]=ct._data(i,"olddisplay",E(i.nodeName)))):o[a]||(r=_(i),(n&&"none"!==n||!r)&&ct._data(i,"olddisplay",r?n:ct.css(i,"display"))));for(a=0;s>a;a++)i=t[a],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function k(t,e,n){var i=ve.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function T(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=ct.css(t,n+_e[o],!0,r)),i?("content"===n&&(a-=ct.css(t,"padding"+_e[o],!0,r)),"margin"!==n&&(a-=ct.css(t,"border"+_e[o]+"Width",!0,r))):(a+=ct.css(t,"padding"+_e[o],!0,r),"padding"!==n&&(a+=ct.css(t,"border"+_e[o]+"Width",!0,r)));return a}function F(t,e,n){var i=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=ce(t),a=ct.support.boxSizing&&"border-box"===ct.css(t,"boxSizing",!1,o);if(0>=r||null==r){if(r=ue(t,e,o),(0>r||null==r)&&(r=t.style[e]),ye.test(r))return r;i=a&&(ct.support.boxSizingReliable||r===t.style[e]),r=parseFloat(r)||0}return r+T(t,e,n||(a?"border":"content"),i,o)+"px"}function E(t){var e=J,n=we[t];return n||(n=A(t,e),"none"!==n&&n||(he=(he||ct("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(he[0].contentWindow||he[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),n=A(t,e),he.detach()),we[t]=n),n}function A(t,e){var n=ct(e.createElement(t)).appendTo(e.body),i=ct.css(n[0],"display");return n.remove(),i}function D(t,e,n,i){var r;if(ct.isArray(e))ct.each(e,function(e,r){n||Te.test(t)?i(t,r):D(t+"["+("object"==typeof r?e:"")+"]",r,n,i)});else if(n||"object"!==ct.type(e))i(t,e);else for(r in e)D(t+"["+r+"]",e[r],n,i)}function N(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(dt)||[];if(ct.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function M(t,e,n,i){function r(s){var l;return o[s]=!0,ct.each(t[s]||[],function(t,s){var h=s(e,n,i);return"string"!=typeof h||a||o[h]?a?!(l=h):void 0:(e.dataTypes.unshift(h),r(h),!1)}),l}var o={},a=t===We;return r(e.dataTypes[0])||!o["*"]&&r("*")}function L(t,n){var i,r,o=ct.ajaxSettings.flatOptions||{};for(r in n)n[r]!==e&&((o[r]?t:i||(i={}))[r]=n[r]);return i&&ct.extend(!0,t,i),t}function P(t,n,i){for(var r,o,a,s,l=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),o===e&&(o=t.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){h.unshift(s);break}if(h[0]in i)a=h[0];else{for(s in i){if(!h[0]||t.converters[s+" "+h[0]]){a=s;break}r||(r=s)}a=a||r}return a?(a!==h[0]&&h.unshift(a),i[a]):void 0}function I(t,e,n,i){var r,o,a,s,l,h={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)h[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(r in h)if(s=r.split(" "),s[1]===o&&(a=h[l+" "+s[0]]||h["* "+s[0]])){a===!0?a=h[r]:h[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}function $(){try{return new t.XMLHttpRequest}catch(e){}}function R(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function O(){return setTimeout(function(){Ke=e}),Ke=ct.now()}function z(t,e,n){for(var i,r=(on[e]||[]).concat(on["*"]),o=0,a=r.length;a>o;o++)if(i=r[o].call(n,e,t))return i}function B(t,e,n){var i,r,o=0,a=rn.length,s=ct.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=Ke||O(),n=Math.max(0,h.startTime+h.duration-e),i=n/h.duration||0,o=1-i,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return s.notifyWith(t,[h,o,n]),1>o&&l?n:(s.resolveWith(t,[h]),!1)},h=s.promise({elem:t,props:ct.extend({},e),opts:ct.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Ke||O(),duration:n.duration,tweens:[],createTween:function(e,n){var i=ct.Tween(t,h.opts,e,n,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(i),i},stop:function(e){var n=0,i=e?h.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)h.tweens[n].run(1);return e?s.resolveWith(t,[h,e]):s.rejectWith(t,[h,e]),this}}),c=h.props;for(j(c,h.opts.specialEasing);a>o;o++)if(i=rn[o].call(h,t,c,h.opts))return i;return ct.map(c,z,h),ct.isFunction(h.opts.start)&&h.opts.start.call(t,h),ct.fx.timer(ct.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function j(t,e){var n,i,r,o,a;for(n in t)if(i=ct.camelCase(n),r=e[i],o=t[n],ct.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),a=ct.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function H(t,e,n){var i,r,o,a,s,l,h=this,c={},u=t.style,d=t.nodeType&&_(t),f=ct._data(t,"fxshow");n.queue||(s=ct._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,ct.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===ct.css(t,"display")&&"none"===ct.css(t,"float")&&(ct.support.inlineBlockNeedsLayout&&"inline"!==E(t.nodeName)?u.zoom=1:u.display="inline-block")),n.overflow&&(u.overflow="hidden",ct.support.shrinkWrapBlocks||h.always(function(){u.overflow=n.overflow[0],u.overflowX=n.overflow[1],u.overflowY=n.overflow[2]}));for(i in e)if(r=e[i],tn.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(d?"hide":"show"))continue;c[i]=f&&f[i]||ct.style(t,i)}if(!ct.isEmptyObject(c)){f?"hidden"in f&&(d=f.hidden):f=ct._data(t,"fxshow",{}),o&&(f.hidden=!d),d?ct(t).show():h.done(function(){ct(t).hide()}),h.done(function(){var e;ct._removeData(t,"fxshow");for(e in c)ct.style(t,e,c[e])});for(i in c)a=z(d?f[i]:0,i,h),i in f||(f[i]=a.start,d&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function W(t,e,n,i,r){return new W.prototype.init(t,e,n,i,r)}function G(t,e){var n,i={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)n=_e[r],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function U(t){return ct.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var q,V,X=typeof e,Y=t.location,J=t.document,Q=J.documentElement,K=t.jQuery,Z=t.$,tt={},et=[],nt="1.10.2",it=et.concat,rt=et.push,ot=et.slice,at=et.indexOf,st=tt.toString,lt=tt.hasOwnProperty,ht=nt.trim,ct=function(t,e){return new ct.fn.init(t,e,V)},ut=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,dt=/\S+/g,ft=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,pt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,gt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,mt=/^[\],:{}\s]*$/,vt=/(?:^|:|,)(?:\s*\[)+/g,yt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,wt=/^-ms-/,xt=/-([\da-z])/gi,St=function(t,e){return e.toUpperCase()},_t=function(t){(J.addEventListener||"load"===t.type||"complete"===J.readyState)&&(Ct(),ct.ready())},Ct=function(){J.addEventListener?(J.removeEventListener("DOMContentLoaded",_t,!1),t.removeEventListener("load",_t,!1)):(J.detachEvent("onreadystatechange",_t),t.detachEvent("onload",_t))};ct.fn=ct.prototype={jquery:nt,constructor:ct,init:function(t,n,i){var r,o;if(!t)return this;if("string"==typeof t){if(r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:pt.exec(t),!r||!r[1]&&n)return!n||n.jquery?(n||i).find(t):this.constructor(n).find(t);if(r[1]){if(n=n instanceof ct?n[0]:n,ct.merge(this,ct.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:J,!0)),gt.test(r[1])&&ct.isPlainObject(n))for(r in n)ct.isFunction(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}if(o=J.getElementById(r[2]),o&&o.parentNode){if(o.id!==r[2])return i.find(t);this.length=1,this[0]=o}return this.context=J,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ct.isFunction(t)?i.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),ct.makeArray(t,this))},selector:"",length:0,toArray:function(){return ot.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=ct.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return ct.each(this,t,e)},ready:function(t){return ct.ready.promise().done(t),this},slice:function(){return this.pushStack(ot.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},map:function(t){return this.pushStack(ct.map(this,function(e,n){return t.call(e,n,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:rt,sort:[].sort,splice:[].splice},ct.fn.init.prototype=ct.fn,ct.extend=ct.fn.extend=function(){var t,n,i,r,o,a,s=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||ct.isFunction(s)||(s={}),h===l&&(s=this,--l);h>l;l++)if(null!=(o=arguments[l]))for(r in o)t=s[r],i=o[r],s!==i&&(c&&i&&(ct.isPlainObject(i)||(n=ct.isArray(i)))?(n?(n=!1,a=t&&ct.isArray(t)?t:[]):a=t&&ct.isPlainObject(t)?t:{},s[r]=ct.extend(c,a,i)):i!==e&&(s[r]=i));return s},ct.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===ct&&(t.$=Z),e&&t.jQuery===ct&&(t.jQuery=K),ct},isReady:!1,readyWait:1,holdReady:function(t){t?ct.readyWait++:ct.ready(!0)},ready:function(t){if(t===!0?!--ct.readyWait:!ct.isReady){if(!J.body)return setTimeout(ct.ready);ct.isReady=!0,t!==!0&&--ct.readyWait>0||(q.resolveWith(J,[ct]),ct.fn.trigger&&ct(J).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===ct.type(t)},isArray:Array.isArray||function(t){return"array"===ct.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?tt[st.call(t)]||"object":typeof t},isPlainObject:function(t){var n;if(!t||"object"!==ct.type(t)||t.nodeType||ct.isWindow(t))return!1;try{if(t.constructor&&!lt.call(t,"constructor")&&!lt.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ct.support.ownLast)for(n in t)return lt.call(t,n);for(n in t);return n===e||lt.call(t,n)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||J;var i=gt.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=ct.buildFragment([t],e,r),r&&ct(r).remove(),ct.merge([],i.childNodes))},parseJSON:function(e){return t.JSON&&t.JSON.parse?t.JSON.parse(e):null===e?e:"string"==typeof e&&(e=ct.trim(e),e&&mt.test(e.replace(yt,"@").replace(bt,"]").replace(vt,"")))?new Function("return "+e)():void ct.error("Invalid JSON: "+e)},parseXML:function(n){var i,r;if(!n||"string"!=typeof n)return null;try{t.DOMParser?(r=new DOMParser,i=r.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(o){i=e}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||ct.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(e){e&&ct.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(wt,"ms-").replace(xt,St)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var r,o=0,a=t.length,s=n(t);if(i){if(s)for(;a>o&&(r=e.apply(t[o],i),r!==!1);o++);else for(o in t)if(r=e.apply(t[o],i),r===!1)break}else if(s)for(;a>o&&(r=e.call(t[o],o,t[o]),r!==!1);o++);else for(o in t)if(r=e.call(t[o],o,t[o]),r===!1)break;return t},trim:ht&&!ht.call("\ufeff ")?function(t){return null==t?"":ht.call(t)}:function(t){return null==t?"":(t+"").replace(ft,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?ct.merge(i,"string"==typeof t?[t]:t):rt.call(i,t)),i},inArray:function(t,e,n){var i;if(e){if(at)return at.call(e,t,n);for(i=e.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,n){var i=n.length,r=t.length,o=0;if("number"==typeof i)for(;i>o;o++)t[r++]=n[o];else for(;n[o]!==e;)t[r++]=n[o++];return t.length=r,t},grep:function(t,e,n){var i,r=[],o=0,a=t.length;for(n=!!n;a>o;o++)i=!!e(t[o],o),n!==i&&r.push(t[o]);return r},map:function(t,e,i){var r,o=0,a=t.length,s=n(t),l=[];if(s)for(;a>o;o++)r=e(t[o],o,i),null!=r&&(l[l.length]=r);else for(o in t)r=e(t[o],o,i),null!=r&&(l[l.length]=r);return it.apply([],l)},guid:1,proxy:function(t,n){var i,r,o;return"string"==typeof n&&(o=t[n],n=t,t=o),ct.isFunction(t)?(i=ot.call(arguments,2),r=function(){return t.apply(n||this,i.concat(ot.call(arguments)))},r.guid=t.guid=t.guid||ct.guid++,r):e},access:function(t,n,i,r,o,a,s){var l=0,h=t.length,c=null==i;if("object"===ct.type(i)){o=!0;for(l in i)ct.access(t,n,l,i[l],!0,a,s)}else if(r!==e&&(o=!0,ct.isFunction(r)||(s=!0),c&&(s?(n.call(t,r),n=null):(c=n,n=function(t,e,n){return c.call(ct(t),n)})),n))for(;h>l;l++)n(t[l],i,s?r:r.call(t[l],l,n(t[l],i)));return o?t:c?n.call(t):h?n(t[0],i):a},now:function(){return(new Date).getTime()},swap:function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=a[o];return r}}),ct.ready.promise=function(e){if(!q)if(q=ct.Deferred(),"complete"===J.readyState)setTimeout(ct.ready);else if(J.addEventListener)J.addEventListener("DOMContentLoaded",_t,!1),t.addEventListener("load",_t,!1);else{J.attachEvent("onreadystatechange",_t),t.attachEvent("onload",_t);var n=!1;try{n=null==t.frameElement&&J.documentElement}catch(i){}n&&n.doScroll&&!function r(){if(!ct.isReady){try{n.doScroll("left")}catch(t){return setTimeout(r,50)}Ct(),ct.ready()}}()}return q.promise(e)},ct.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){tt["[object "+e+"]"]=e.toLowerCase()}),V=ct(J),function(t,e){function n(t,e,n,i){var r,o,a,s,l,h,c,u,p,g;if((e?e.ownerDocument||e:B)!==M&&N(e),e=e||M,n=n||[],!t||"string"!=typeof t)return n;if(1!==(s=e.nodeType)&&9!==s)return[];if(P&&!i){if(r=bt.exec(t))if(a=r[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&O(e,o)&&o.id===a)return n.push(o),n}else{if(r[2])return tt.apply(n,e.getElementsByTagName(t)),n;if((a=r[3])&&_.getElementsByClassName&&e.getElementsByClassName)return tt.apply(n,e.getElementsByClassName(a)),n}if(_.qsa&&(!I||!I.test(t))){if(u=c=z,p=e,g=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(h=d(t),(c=e.getAttribute("id"))?u=c.replace(St,"\\$&"):e.setAttribute("id",u),u="[id='"+u+"'] ",l=h.length;l--;)h[l]=u+f(h[l]);p=ft.test(t)&&e.parentNode||e,g=h.join(",")}if(g)try{return tt.apply(n,p.querySelectorAll(g)),n}catch(m){}finally{c||e.removeAttribute("id")}}}return x(t.replace(ht,"$1"),e,n,i)}function i(){function t(n,i){return e.push(n+=" ")>k.cacheLength&&delete t[e.shift()],t[n]=i}var e=[];return t}function r(t){return t[z]=!0,t}function o(t){var e=M.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(t,e){for(var n=t.split("|"),i=t.length;i--;)k.attrHandle[n[i]]=e}function s(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function l(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function h(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function c(t){return r(function(e){return e=+e,r(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function u(){}function d(t,e){var i,r,o,a,s,l,h,c=G[t+" "];if(c)return e?0:c.slice(0);for(s=t,l=[],h=k.preFilter;s;){(!i||(r=ut.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),i=!1,(r=dt.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(ht," ")}),s=s.slice(i.length));for(a in k.filter)!(r=vt[a].exec(s))||h[a]&&!(r=h[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return e?s.length:s?n.error(t):G(t,l).slice(0)}function f(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function p(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=H++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,l,h,c=j+" "+o;if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r)if(h=e[z]||(e[z]={}),(l=h[i])&&l[0]===c){if((s=l[1])===!0||s===C)return s===!0}else if(l=h[i]=[c],l[1]=t(e,n,a)||C,l[1]===!0)return!0}}function g(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function m(t,e,n,i,r){for(var o,a=[],s=0,l=t.length,h=null!=e;l>s;s++)(o=t[s])&&(!n||n(o,i,r))&&(a.push(o),h&&e.push(s));return a}function v(t,e,n,i,o,a){return i&&!i[z]&&(i=v(i)),o&&!o[z]&&(o=v(o,a)),r(function(r,a,s,l){var h,c,u,d=[],f=[],p=a.length,g=r||w(e||"*",s.nodeType?[s]:s,[]),v=!t||!r&&e?g:m(g,d,t,s,l),y=n?o||(r?t:p||i)?[]:a:v;if(n&&n(v,y,s,l),i)for(h=m(y,f),i(h,[],s,l),c=h.length;c--;)(u=h[c])&&(y[f[c]]=!(v[f[c]]=u));if(r){if(o||t){if(o){for(h=[],c=y.length;c--;)(u=y[c])&&h.push(v[c]=u);o(null,y=[],h,l)}for(c=y.length;c--;)(u=y[c])&&(h=o?nt.call(r,u):d[c])>-1&&(r[h]=!(a[h]=u))}}else y=m(y===a?y.splice(p,y.length):y),o?o(null,a,y,l):tt.apply(a,y)})}function y(t){for(var e,n,i,r=t.length,o=k.relative[t[0].type],a=o||k.relative[" "],s=o?1:0,l=p(function(t){return t===e},a,!0),h=p(function(t){return nt.call(e,t)>-1},a,!0),c=[function(t,n,i){return!o&&(i||n!==A)||((e=n).nodeType?l(t,n,i):h(t,n,i))}];r>s;s++)if(n=k.relative[t[s].type])c=[p(g(c),n)];else{if(n=k.filter[t[s].type].apply(null,t[s].matches),n[z]){for(i=++s;r>i&&!k.relative[t[i].type];i++);return v(s>1&&g(c),s>1&&f(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(ht,"$1"),n,i>s&&y(t.slice(s,i)),r>i&&y(t=t.slice(i)),r>i&&f(t))}c.push(n)}return g(c)}function b(t,e){var i=0,o=e.length>0,a=t.length>0,s=function(r,s,l,h,c){var u,d,f,p=[],g=0,v="0",y=r&&[],b=null!=c,w=A,x=r||a&&k.find.TAG("*",c&&s.parentNode||s),S=j+=null==w?1:Math.random()||.1;for(b&&(A=s!==M&&s,C=i);null!=(u=x[v]);v++){if(a&&u){for(d=0;f=t[d++];)if(f(u,s,l)){h.push(u);break}b&&(j=S,C=++i)}o&&((u=!f&&u)&&g--,r&&y.push(u))}if(g+=v,o&&v!==g){for(d=0;f=e[d++];)f(y,p,s,l);if(r){if(g>0)for(;v--;)y[v]||p[v]||(p[v]=K.call(h));p=m(p)}tt.apply(h,p),b&&!r&&p.length>0&&g+e.length>1&&n.uniqueSort(h)}return b&&(j=S,A=w),y};return o?r(s):s}function w(t,e,i){for(var r=0,o=e.length;o>r;r++)n(t,e[r],i);return i}function x(t,e,n,i){var r,o,a,s,l,h=d(t);if(!i&&1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&_.getById&&9===e.nodeType&&P&&k.relative[o[1].type]){if(e=(k.find.ID(a.matches[0].replace(_t,Ct),e)||[])[0],!e)return n;t=t.slice(o.shift().value.length)}for(r=vt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!k.relative[s=a.type]);)if((l=k.find[s])&&(i=l(a.matches[0].replace(_t,Ct),ft.test(o[0].type)&&e.parentNode||e))){if(o.splice(r,1),t=i.length&&f(o),!t)return tt.apply(n,i),n;break}}return E(t,h)(i,e,!P,n,ft.test(t)),n}var S,_,C,k,T,F,E,A,D,N,M,L,P,I,$,R,O,z="sizzle"+-new Date,B=t.document,j=0,H=0,W=i(),G=i(),U=i(),q=!1,V=function(t,e){return t===e?(q=!0,0):0},X=typeof e,Y=1<<31,J={}.hasOwnProperty,Q=[],K=Q.pop,Z=Q.push,tt=Q.push,et=Q.slice,nt=Q.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},it="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",rt="[\\x20\\t\\r\\n\\f]",ot="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",at=ot.replace("w","w#"),st="\\["+rt+"*("+ot+")"+rt+"*(?:([*^$|!~]?=)"+rt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+at+")|)|)"+rt+"*\\]",lt=":("+ot+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+st.replace(3,8)+")*)|.*)\\)|)",ht=new RegExp("^"+rt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+rt+"+$","g"),ut=new RegExp("^"+rt+"*,"+rt+"*"),dt=new RegExp("^"+rt+"*([>+~]|"+rt+")"+rt+"*"),ft=new RegExp(rt+"*[+~]"),pt=new RegExp("="+rt+"*([^\\]'\"]*)"+rt+"*\\]","g"),gt=new RegExp(lt),mt=new RegExp("^"+at+"$"),vt={ID:new RegExp("^#("+ot+")"),CLASS:new RegExp("^\\.("+ot+")"),TAG:new RegExp("^("+ot.replace("w","w*")+")"),ATTR:new RegExp("^"+st),PSEUDO:new RegExp("^"+lt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+rt+"*(even|odd|(([+-]|)(\\d*)n|)"+rt+"*(?:([+-]|)"+rt+"*(\\d+)|))"+rt+"*\\)|)","i"),bool:new RegExp("^(?:"+it+")$","i"),needsContext:new RegExp("^"+rt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+rt+"*((?:-\\d)?\\d*)"+rt+"*\\)|)(?=[^-]|$)","i")},yt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,wt=/^(?:input|select|textarea|button)$/i,xt=/^h\d$/i,St=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+rt+"?|("+rt+")|.)","ig"),Ct=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{tt.apply(Q=et.call(B.childNodes),B.childNodes),Q[B.childNodes.length].nodeType}catch(kt){tt={apply:Q.length?function(t,e){Z.apply(t,et.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}F=n.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},_=n.support={},N=n.setDocument=function(t){var e=t?t.ownerDocument||t:B,n=e.defaultView;return e!==M&&9===e.nodeType&&e.documentElement?(M=e,L=e.documentElement,P=!F(e),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){N()}),_.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),_.getElementsByTagName=o(function(t){return t.appendChild(e.createComment("")),!t.getElementsByTagName("*").length}),_.getElementsByClassName=o(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),_.getById=o(function(t){return L.appendChild(t).id=z,!e.getElementsByName||!e.getElementsByName(z).length}),_.getById?(k.find.ID=function(t,e){if(typeof e.getElementById!==X&&P){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},k.filter.ID=function(t){var e=t.replace(_t,Ct);return function(t){return t.getAttribute("id")===e}}):(delete k.find.ID,k.filter.ID=function(t){var e=t.replace(_t,Ct);return function(t){var n=typeof t.getAttributeNode!==X&&t.getAttributeNode("id");return n&&n.value===e}}),k.find.TAG=_.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==X?e.getElementsByTagName(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},k.find.CLASS=_.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==X&&P?e.getElementsByClassName(t):void 0},$=[],I=[],(_.qsa=yt.test(e.querySelectorAll))&&(o(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||I.push("\\["+rt+"*(?:value|"+it+")"),t.querySelectorAll(":checked").length||I.push(":checked")}),o(function(t){var n=e.createElement("input");n.setAttribute("type","hidden"),t.appendChild(n).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&I.push("[*^$]="+rt+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),I.push(",.*:")})),(_.matchesSelector=yt.test(R=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&o(function(t){_.disconnectedMatch=R.call(t,"div"),R.call(t,"[s!='']:x"),$.push("!=",lt)}),I=I.length&&new RegExp(I.join("|")),$=$.length&&new RegExp($.join("|")),O=yt.test(L.contains)||L.compareDocumentPosition?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},V=L.compareDocumentPosition?function(t,n){if(t===n)return q=!0,0;var i=n.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(n);return i?1&i||!_.sortDetached&&n.compareDocumentPosition(t)===i?t===e||O(B,t)?-1:n===e||O(B,n)?1:D?nt.call(D,t)-nt.call(D,n):0:4&i?-1:1:t.compareDocumentPosition?-1:1}:function(t,n){var i,r=0,o=t.parentNode,a=n.parentNode,l=[t],h=[n];if(t===n)return q=!0,0;if(!o||!a)return t===e?-1:n===e?1:o?-1:a?1:D?nt.call(D,t)-nt.call(D,n):0;if(o===a)return s(t,n);for(i=t;i=i.parentNode;)l.unshift(i);for(i=n;i=i.parentNode;)h.unshift(i);for(;l[r]===h[r];)r++;return r?s(l[r],h[r]):l[r]===B?-1:h[r]===B?1:0},e):M},n.matches=function(t,e){return n(t,null,null,e)},n.matchesSelector=function(t,e){if((t.ownerDocument||t)!==M&&N(t),e=e.replace(pt,"='$1']"),!(!_.matchesSelector||!P||$&&$.test(e)||I&&I.test(e)))try{var i=R.call(t,e);if(i||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(r){}return n(e,M,null,[t]).length>0},n.contains=function(t,e){return(t.ownerDocument||t)!==M&&N(t),O(t,e)},n.attr=function(t,n){(t.ownerDocument||t)!==M&&N(t);var i=k.attrHandle[n.toLowerCase()],r=i&&J.call(k.attrHandle,n.toLowerCase())?i(t,n,!P):e;return r===e?_.attributes||!P?t.getAttribute(n):(r=t.getAttributeNode(n))&&r.specified?r.value:null:r},n.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},n.uniqueSort=function(t){var e,n=[],i=0,r=0;if(q=!_.detectDuplicates,D=!_.sortStable&&t.slice(0),t.sort(V),q){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return t},T=n.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=T(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i];i++)n+=T(e);return n},k=n.selectors={cacheLength:50,createPseudo:r,match:vt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,Ct),t[3]=(t[4]||t[5]||"").replace(_t,Ct),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||n.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&n.error(t[0]),t},PSEUDO:function(t){var n,i=!t[5]&&t[2];return vt.CHILD.test(t[0])?null:(t[3]&&t[4]!==e?t[2]=t[4]:i&&gt.test(i)&&(n=d(i,!0))&&(n=i.indexOf(")",i.length-n)-i.length)&&(t[0]=t[0].slice(0,n),t[2]=i.slice(0,n)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,Ct).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+rt+")"+t+"("+rt+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==X&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(r){var o=n.attr(r,t);return null==o?"!="===e:e?(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o+" ").indexOf(i)>-1:"|="===e?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;
return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var h,c,u,d,f,p,g=o!==a?"nextSibling":"previousSibling",m=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!l&&!s;if(m){if(o){for(;g;){for(u=e;u=u[g];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(c=m[z]||(m[z]={}),h=c[t]||[],f=h[0]===j&&h[1],d=h[0]===j&&h[2],u=f&&m.childNodes[f];u=++f&&u&&u[g]||(d=f=0)||p.pop();)if(1===u.nodeType&&++d&&u===e){c[t]=[j,f,d];break}}else if(y&&(h=(e[z]||(e[z]={}))[t])&&h[0]===j)d=h[1];else for(;(u=++f&&u&&u[g]||(d=f=0)||p.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[z]||(u[z]={}))[t]=[j,d]),u!==e)););return d-=r,d===i||d%i===0&&d/i>=0}}},PSEUDO:function(t,e){var i,o=k.pseudos[t]||k.setFilters[t.toLowerCase()]||n.error("unsupported pseudo: "+t);return o[z]?o(e):o.length>1?(i=[t,t,"",e],k.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,n){for(var i,r=o(t,e),a=r.length;a--;)i=nt.call(t,r[a]),t[i]=!(n[i]=r[a])}):function(t){return o(t,0,i)}):o}},pseudos:{not:r(function(t){var e=[],n=[],i=E(t.replace(ht,"$1"));return i[z]?r(function(t,e,n,r){for(var o,a=i(t,null,r,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),!n.pop()}}),has:r(function(t){return function(e){return n(t,e).length>0}}),contains:r(function(t){return function(e){return(e.textContent||e.innerText||T(e)).indexOf(t)>-1}}),lang:r(function(t){return mt.test(t||"")||n.error("unsupported lang: "+t),t=t.replace(_t,Ct).toLowerCase(),function(e){var n;do if(n=P?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===L},focus:function(t){return t===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!k.pseudos.empty(t)},header:function(t){return xt.test(t.nodeName)},input:function(t){return wt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,n){return[0>n?n+e:n]}),even:c(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:c(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:c(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:c(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}},k.pseudos.nth=k.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[S]=l(S);for(S in{submit:!0,reset:!0})k.pseudos[S]=h(S);u.prototype=k.filters=k.pseudos,k.setFilters=new u,E=n.compile=function(t,e){var n,i=[],r=[],o=U[t+" "];if(!o){for(e||(e=d(t)),n=e.length;n--;)o=y(e[n]),o[z]?i.push(o):r.push(o);o=U(t,b(r,i))}return o},_.sortStable=z.split("").sort(V).join("")===z,_.detectDuplicates=q,N(),_.sortDetached=o(function(t){return 1&t.compareDocumentPosition(M.createElement("div"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||a("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),_.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||a("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||a(it,function(t,e,n){var i;return n?void 0:(i=t.getAttributeNode(e))&&i.specified?i.value:t[e]===!0?e.toLowerCase():null}),ct.find=n,ct.expr=n.selectors,ct.expr[":"]=ct.expr.pseudos,ct.unique=n.uniqueSort,ct.text=n.getText,ct.isXMLDoc=n.isXML,ct.contains=n.contains}(t);var kt={};ct.Callbacks=function(t){t="string"==typeof t?kt[t]||i(t):ct.extend({},t);var n,r,o,a,s,l,h=[],c=!t.once&&[],u=function(e){for(r=t.memory&&e,o=!0,s=l||0,l=0,a=h.length,n=!0;h&&a>s;s++)if(h[s].apply(e[0],e[1])===!1&&t.stopOnFalse){r=!1;break}n=!1,h&&(c?c.length&&u(c.shift()):r?h=[]:d.disable())},d={add:function(){if(h){var e=h.length;!function i(e){ct.each(e,function(e,n){var r=ct.type(n);"function"===r?t.unique&&d.has(n)||h.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),n?a=h.length:r&&(l=e,u(r))}return this},remove:function(){return h&&ct.each(arguments,function(t,e){for(var i;(i=ct.inArray(e,h,i))>-1;)h.splice(i,1),n&&(a>=i&&a--,s>=i&&s--)}),this},has:function(t){return t?ct.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],a=0,this},disable:function(){return h=c=r=e,this},disabled:function(){return!h},lock:function(){return c=e,r||d.disable(),this},locked:function(){return!c},fireWith:function(t,e){return!h||o&&!c||(e=e||[],e=[t,e.slice?e.slice():e],n?c.push(e):u(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},ct.extend({Deferred:function(t){var e=[["resolve","done",ct.Callbacks("once memory"),"resolved"],["reject","fail",ct.Callbacks("once memory"),"rejected"],["notify","progress",ct.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ct.Deferred(function(n){ct.each(e,function(e,o){var a=o[0],s=ct.isFunction(t[e])&&t[e];r[o[1]](function(){var t=s&&s.apply(this,arguments);t&&ct.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ct.extend(t,i):i}},r={};return i.pipe=i.then,ct.each(e,function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=ot.call(arguments),a=o.length,s=1!==a||t&&ct.isFunction(t.promise)?a:0,l=1===s?t:ct.Deferred(),h=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?ot.call(arguments):r,i===e?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&ct.isFunction(o[r].promise)?o[r].promise().done(h(r,i,o)).fail(l.reject).progress(h(r,n,e)):--s;return s||l.resolveWith(i,o),l.promise()}}),ct.support=function(e){var n,i,r,o,a,s,l,h,c,u=J.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=u.getElementsByTagName("*")||[],i=u.getElementsByTagName("a")[0],!i||!i.style||!n.length)return e;o=J.createElement("select"),s=o.appendChild(J.createElement("option")),r=u.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",e.getSetAttribute="t"!==u.className,e.leadingWhitespace=3===u.firstChild.nodeType,e.tbody=!u.getElementsByTagName("tbody").length,e.htmlSerialize=!!u.getElementsByTagName("link").length,e.style=/top/.test(i.getAttribute("style")),e.hrefNormalized="/a"===i.getAttribute("href"),e.opacity=/^0.5/.test(i.style.opacity),e.cssFloat=!!i.style.cssFloat,e.checkOn=!!r.value,e.optSelected=s.selected,e.enctype=!!J.createElement("form").enctype,e.html5Clone="<:nav></:nav>"!==J.createElement("nav").cloneNode(!0).outerHTML,e.inlineBlockNeedsLayout=!1,e.shrinkWrapBlocks=!1,e.pixelPosition=!1,e.deleteExpando=!0,e.noCloneEvent=!0,e.reliableMarginRight=!0,e.boxSizingReliable=!0,r.checked=!0,e.noCloneChecked=r.cloneNode(!0).checked,o.disabled=!0,e.optDisabled=!s.disabled;try{delete u.test}catch(d){e.deleteExpando=!1}r=J.createElement("input"),r.setAttribute("value",""),e.input=""===r.getAttribute("value"),r.value="t",r.setAttribute("type","radio"),e.radioValue="t"===r.value,r.setAttribute("checked","t"),r.setAttribute("name","t"),a=J.createDocumentFragment(),a.appendChild(r),e.appendChecked=r.checked,e.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){e.noCloneEvent=!1}),u.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+c,"t"),e[c+"Bubbles"]=l in t||u.attributes[l].expando===!1;u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===u.style.backgroundClip;for(c in ct(e))break;return e.ownLast="0"!==c,ct(function(){var n,i,r,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=J.getElementsByTagName("body")[0];a&&(n=J.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=u.getElementsByTagName("td"),r[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===r[0].offsetHeight,r[0].style.display="",r[1].style.display="none",e.reliableHiddenOffsets=h&&0===r[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ct.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===u.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(u,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(u,null)||{width:"4px"}).width,i=u.appendChild(J.createElement("div")),i.style.cssText=u.style.cssText=o,i.style.marginRight=i.style.width="0",u.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(i,null)||{}).marginRight)),typeof u.style.zoom!==X&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==u.offsetWidth,e.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=u=r=i=null)}),n=o=a=s=i=r=null,e}({});var Tt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ft=/([A-Z])/g;ct.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?ct.cache[t[ct.expando]]:t[ct.expando],!!t&&!s(t)},data:function(t,e,n){return r(t,e,n)},removeData:function(t,e){return o(t,e)},_data:function(t,e,n){return r(t,e,n,!0)},_removeData:function(t,e){return o(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&ct.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),ct.fn.extend({data:function(t,n){var i,r,o=null,s=0,l=this[0];if(t===e){if(this.length&&(o=ct.data(l),1===l.nodeType&&!ct._data(l,"parsedAttrs"))){for(i=l.attributes;s<i.length;s++)r=i[s].name,0===r.indexOf("data-")&&(r=ct.camelCase(r.slice(5)),a(l,r,o[r]));ct._data(l,"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){ct.data(this,t)}):arguments.length>1?this.each(function(){ct.data(this,t,n)}):l?a(l,t,ct.data(l,t)):null},removeData:function(t){return this.each(function(){ct.removeData(this,t)})}}),ct.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=ct._data(t,e),n&&(!i||ct.isArray(n)?i=ct._data(t,e,ct.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=ct.queue(t,e),i=n.length,r=n.shift(),o=ct._queueHooks(t,e),a=function(){ct.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return ct._data(t,n)||ct._data(t,n,{empty:ct.Callbacks("once memory").add(function(){ct._removeData(t,e+"queue"),ct._removeData(t,n)})})}}),ct.fn.extend({queue:function(t,n){var i=2;return"string"!=typeof t&&(n=t,t="fx",i--),arguments.length<i?ct.queue(this[0],t):n===e?this:this.each(function(){var e=ct.queue(this,t,n);ct._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ct.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ct.dequeue(this,t)})},delay:function(t,e){return t=ct.fx?ct.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){var i,r=1,o=ct.Deferred(),a=this,s=this.length,l=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof t&&(n=t,t=e),t=t||"fx";s--;)i=ct._data(a[s],t+"queueHooks"),i&&i.empty&&(r++,i.empty.add(l));return l(),o.promise(n)}});var Et,At,Dt=/[\t\r\n\f]/g,Nt=/\r/g,Mt=/^(?:input|select|textarea|button|object)$/i,Lt=/^(?:a|area)$/i,Pt=/^(?:checked|selected)$/i,It=ct.support.getSetAttribute,$t=ct.support.input;ct.fn.extend({attr:function(t,e){return ct.access(this,ct.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ct.removeAttr(this,t)})},prop:function(t,e){return ct.access(this,ct.prop,t,e,arguments.length>1)},removeProp:function(t){return t=ct.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(n){}})},addClass:function(t){var e,n,i,r,o,a=0,s=this.length,l="string"==typeof t&&t;if(ct.isFunction(t))return this.each(function(e){ct(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(dt)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Dt," "):" ")){for(o=0;r=e[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");n.className=ct.trim(i)}return this},removeClass:function(t){var e,n,i,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof t&&t;if(ct.isFunction(t))return this.each(function(e){ct(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(dt)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Dt," "):"")){for(o=0;r=e[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");n.className=t?ct.trim(i):""}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):ct.isFunction(t)?this.each(function(n){ct(this).toggleClass(t.call(this,n,this.className,e),e)}):this.each(function(){if("string"===n)for(var e,i=0,r=ct(this),o=t.match(dt)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(n===X||"boolean"===n)&&(this.className&&ct._data(this,"__className__",this.className),this.className=this.className||t===!1?"":ct._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Dt," ").indexOf(e)>=0)return!0;return!1},val:function(t){var n,i,r,o=this[0];{if(arguments.length)return r=ct.isFunction(t),this.each(function(n){var o;1===this.nodeType&&(o=r?t.call(this,n,ct(this).val()):t,null==o?o="":"number"==typeof o?o+="":ct.isArray(o)&&(o=ct.map(o,function(t){return null==t?"":t+""})),i=ct.valHooks[this.type]||ct.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==e||(this.value=o))});if(o)return i=ct.valHooks[o.type]||ct.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(n=i.get(o,"value"))!==e?n:(n=o.value,"string"==typeof n?n.replace(Nt,""):null==n?"":n)}}}),ct.extend({valHooks:{option:{get:function(t){var e=ct.find.attr(t,"value");return null!=e?e:t.text}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:i.length,l=0>r?s:o?r:0;s>l;l++)if(n=i[l],!(!n.selected&&l!==r||(ct.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ct.nodeName(n.parentNode,"optgroup"))){if(e=ct(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=ct.makeArray(e),a=r.length;a--;)i=r[a],(i.selected=ct.inArray(ct(i).val(),o)>=0)&&(n=!0);return n||(t.selectedIndex=-1),o}}},attr:function(t,n,i){var r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===X?ct.prop(t,n,i):(1===a&&ct.isXMLDoc(t)||(n=n.toLowerCase(),r=ct.attrHooks[n]||(ct.expr.match.bool.test(n)?At:Et)),i===e?r&&"get"in r&&null!==(o=r.get(t,n))?o:(o=ct.find.attr(t,n),null==o?e:o):null!==i?r&&"set"in r&&(o=r.set(t,i,n))!==e?o:(t.setAttribute(n,i+""),i):void ct.removeAttr(t,n))},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(dt);if(o&&1===t.nodeType)for(;n=o[r++];)i=ct.propFix[n]||n,ct.expr.match.bool.test(n)?$t&&It||!Pt.test(n)?t[i]=!1:t[ct.camelCase("default-"+n)]=t[i]=!1:ct.attr(t,n,""),t.removeAttribute(It?n:i)},attrHooks:{type:{set:function(t,e){if(!ct.support.radioValue&&"radio"===e&&ct.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,n,i){var r,o,a,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return a=1!==s||!ct.isXMLDoc(t),a&&(n=ct.propFix[n]||n,o=ct.propHooks[n]),i!==e?o&&"set"in o&&(r=o.set(t,i,n))!==e?r:t[n]=i:o&&"get"in o&&null!==(r=o.get(t,n))?r:t[n]},propHooks:{tabIndex:{get:function(t){var e=ct.find.attr(t,"tabindex");return e?parseInt(e,10):Mt.test(t.nodeName)||Lt.test(t.nodeName)&&t.href?0:-1}}}}),At={set:function(t,e,n){return e===!1?ct.removeAttr(t,n):$t&&It||!Pt.test(n)?t.setAttribute(!It&&ct.propFix[n]||n,n):t[ct.camelCase("default-"+n)]=t[n]=!0,n}},ct.each(ct.expr.match.bool.source.match(/\w+/g),function(t,n){var i=ct.expr.attrHandle[n]||ct.find.attr;ct.expr.attrHandle[n]=$t&&It||!Pt.test(n)?function(t,n,r){var o=ct.expr.attrHandle[n],a=r?e:(ct.expr.attrHandle[n]=e)!=i(t,n,r)?n.toLowerCase():null;return ct.expr.attrHandle[n]=o,a}:function(t,n,i){return i?e:t[ct.camelCase("default-"+n)]?n.toLowerCase():null}}),$t&&It||(ct.attrHooks.value={set:function(t,e,n){return ct.nodeName(t,"input")?void(t.defaultValue=e):Et&&Et.set(t,e,n)}}),It||(Et={set:function(t,n,i){var r=t.getAttributeNode(i);return r||t.setAttributeNode(r=t.ownerDocument.createAttribute(i)),r.value=n+="","value"===i||n===t.getAttribute(i)?n:e}},ct.expr.attrHandle.id=ct.expr.attrHandle.name=ct.expr.attrHandle.coords=function(t,n,i){var r;return i?e:(r=t.getAttributeNode(n))&&""!==r.value?r.value:null},ct.valHooks.button={get:function(t,n){var i=t.getAttributeNode(n);return i&&i.specified?i.value:e},set:Et.set},ct.attrHooks.contenteditable={set:function(t,e,n){Et.set(t,""===e?!1:e,n)}},ct.each(["width","height"],function(t,e){ct.attrHooks[e]={set:function(t,n){return""===n?(t.setAttribute(e,"auto"),n):void 0}}})),ct.support.hrefNormalized||ct.each(["href","src"],function(t,e){ct.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ct.support.style||(ct.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),ct.support.optSelected||(ct.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),ct.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ct.propFix[this.toLowerCase()]=this}),ct.support.enctype||(ct.propFix.enctype="encoding"),ct.each(["radio","checkbox"],function(){ct.valHooks[this]={set:function(t,e){return ct.isArray(e)?t.checked=ct.inArray(ct(t).val(),e)>=0:void 0}},ct.support.checkOn||(ct.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Rt=/^(?:input|select|textarea)$/i,Ot=/^key/,zt=/^(?:mouse|contextmenu)|click/,Bt=/^(?:focusinfocus|focusoutblur)$/,jt=/^([^.]*)(?:\.(.+)|)$/;ct.event={global:{},add:function(t,n,i,r,o){var a,s,l,h,c,u,d,f,p,g,m,v=ct._data(t);if(v){for(i.handler&&(h=i,i=h.handler,o=h.selector),i.guid||(i.guid=ct.guid++),(s=v.events)||(s=v.events={}),(u=v.handle)||(u=v.handle=function(t){return typeof ct===X||t&&ct.event.triggered===t.type?e:ct.event.dispatch.apply(u.elem,arguments)},u.elem=t),n=(n||"").match(dt)||[""],l=n.length;l--;)a=jt.exec(n[l])||[],p=m=a[1],g=(a[2]||"").split(".").sort(),p&&(c=ct.event.special[p]||{},p=(o?c.delegateType:c.bindType)||p,c=ct.event.special[p]||{},d=ct.extend({type:p,origType:m,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&ct.expr.match.needsContext.test(o),namespace:g.join(".")},h),(f=s[p])||(f=s[p]=[],f.delegateCount=0,c.setup&&c.setup.call(t,r,g,u)!==!1||(t.addEventListener?t.addEventListener(p,u,!1):t.attachEvent&&t.attachEvent("on"+p,u))),c.add&&(c.add.call(t,d),d.handler.guid||(d.handler.guid=i.guid)),o?f.splice(f.delegateCount++,0,d):f.push(d),ct.event.global[p]=!0);t=null}},remove:function(t,e,n,i,r){var o,a,s,l,h,c,u,d,f,p,g,m=ct.hasData(t)&&ct._data(t);if(m&&(c=m.events)){for(e=(e||"").match(dt)||[""],h=e.length;h--;)if(s=jt.exec(e[h])||[],f=g=s[1],p=(s[2]||"").split(".").sort(),f){for(u=ct.event.special[f]||{},f=(i?u.delegateType:u.bindType)||f,d=c[f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;)a=d[o],!r&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,u.remove&&u.remove.call(t,a));l&&!d.length&&(u.teardown&&u.teardown.call(t,p,m.handle)!==!1||ct.removeEvent(t,f,m.handle),delete c[f])}else for(f in c)ct.event.remove(t,f+e[h],n,i,!0);ct.isEmptyObject(c)&&(delete m.handle,ct._removeData(t,"events"))}},trigger:function(n,i,r,o){var a,s,l,h,c,u,d,f=[r||J],p=lt.call(n,"type")?n.type:n,g=lt.call(n,"namespace")?n.namespace.split("."):[];if(l=u=r=r||J,3!==r.nodeType&&8!==r.nodeType&&!Bt.test(p+ct.event.triggered)&&(p.indexOf(".")>=0&&(g=p.split("."),p=g.shift(),g.sort()),s=p.indexOf(":")<0&&"on"+p,n=n[ct.expando]?n:new ct.Event(p,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=e,n.target||(n.target=r),i=null==i?[n]:ct.makeArray(i,[n]),c=ct.event.special[p]||{},o||!c.trigger||c.trigger.apply(r,i)!==!1)){if(!o&&!c.noBubble&&!ct.isWindow(r)){for(h=c.delegateType||p,Bt.test(h+p)||(l=l.parentNode);l;l=l.parentNode)f.push(l),u=l;u===(r.ownerDocument||J)&&f.push(u.defaultView||u.parentWindow||t)}for(d=0;(l=f[d++])&&!n.isPropagationStopped();)n.type=d>1?h:c.bindType||p,a=(ct._data(l,"events")||{})[n.type]&&ct._data(l,"handle"),a&&a.apply(l,i),a=s&&l[s],a&&ct.acceptData(l)&&a.apply&&a.apply(l,i)===!1&&n.preventDefault();if(n.type=p,!o&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(f.pop(),i)===!1)&&ct.acceptData(r)&&s&&r[p]&&!ct.isWindow(r)){u=r[s],u&&(r[s]=null),ct.event.triggered=p;try{r[p]()}catch(m){}ct.event.triggered=e,u&&(r[s]=u)}return n.result}},dispatch:function(t){t=ct.event.fix(t);var n,i,r,o,a,s=[],l=ot.call(arguments),h=(ct._data(this,"events")||{})[t.type]||[],c=ct.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(s=ct.event.handlers.call(this,t,h),n=0;(o=s[n++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,i=((ct.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l),i!==e&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,n){var i,r,o,a,s=[],l=n.delegateCount,h=t.target;if(l&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==t.type)){for(o=[],a=0;l>a;a++)r=n[a],i=r.selector+" ",o[i]===e&&(o[i]=r.needsContext?ct(i,this).index(h)>=0:ct.find(i,this,null,[h]).length),o[i]&&o.push(r);o.length&&s.push({elem:h,handlers:o})}return l<n.length&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(t){if(t[ct.expando])return t;var e,n,i,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=zt.test(r)?this.mouseHooks:Ot.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new ct.Event(o),e=i.length;e--;)n=i[e],t[n]=o[n];return t.target||(t.target=o.srcElement||J),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,n){var i,r,o,a=n.button,s=n.fromElement;return null==t.pageX&&null!=n.clientX&&(r=t.target.ownerDocument||J,o=r.documentElement,i=r.body,t.pageX=n.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),t.pageY=n.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&s&&(t.relatedTarget=s===t.target?n.toElement:s),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==c()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ct.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return ct.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var r=ct.extend(new ct.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?ct.event.trigger(r,null,e):ct.event.dispatch.call(e,r),r.isDefaultPrevented()&&n.preventDefault()}},ct.removeEvent=J.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)}:function(t,e,n){var i="on"+e;t.detachEvent&&(typeof t[i]===X&&(t[i]=null),t.detachEvent(i,n))},ct.Event=function(t,e){return this instanceof ct.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:h):this.type=t,e&&ct.extend(this,e),this.timeStamp=t&&t.timeStamp||ct.now(),void(this[ct.expando]=!0)):new ct.Event(t,e)},ct.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ct.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){ct.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return(!r||r!==i&&!ct.contains(i,r))&&(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),ct.support.submitBubbles||(ct.event.special.submit={setup:function(){return ct.nodeName(this,"form")?!1:void ct.event.add(this,"click._submit keypress._submit",function(t){var n=t.target,i=ct.nodeName(n,"input")||ct.nodeName(n,"button")?n.form:e;i&&!ct._data(i,"submitBubbles")&&(ct.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),ct._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&ct.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return ct.nodeName(this,"form")?!1:void ct.event.remove(this,"._submit")}}),ct.support.changeBubbles||(ct.event.special.change={setup:function(){return Rt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ct.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),ct.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),ct.event.simulate("change",this,t,!0)})),!1):void ct.event.add(this,"beforeactivate._change",function(t){var e=t.target;Rt.test(e.nodeName)&&!ct._data(e,"changeBubbles")&&(ct.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||ct.event.simulate("change",this.parentNode,t,!0)}),ct._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ct.event.remove(this,"._change"),!Rt.test(this.nodeName)}}),ct.support.focusinBubbles||ct.each({focus:"focusin",blur:"focusout"},function(t,e){var n=0,i=function(t){ct.event.simulate(e,t.target,ct.event.fix(t),!0)};ct.event.special[e]={setup:function(){0===n++&&J.addEventListener(t,i,!0)},teardown:function(){0===--n&&J.removeEventListener(t,i,!0)}}}),ct.fn.extend({on:function(t,n,i,r,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=e);for(a in t)this.on(a,n,i,t[a],o);return this}if(null==i&&null==r?(r=n,i=n=e):null==r&&("string"==typeof n?(r=i,i=e):(r=i,i=n,n=e)),r===!1)r=h;else if(!r)return this;return 1===o&&(s=r,r=function(t){return ct().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=ct.guid++)),this.each(function(){ct.event.add(this,t,r,i,n)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,n,i){var r,o;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,ct(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(o in t)this.off(o,n,t[o]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=e),i===!1&&(i=h),this.each(function(){ct.event.remove(this,t,i,n)})},trigger:function(t,e){return this.each(function(){ct.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?ct.event.trigger(t,e,n,!0):void 0}});var Ht=/^.[^:#\[\.,]*$/,Wt=/^(?:parents|prev(?:Until|All))/,Gt=ct.expr.match.needsContext,Ut={children:!0,contents:!0,next:!0,prev:!0};ct.fn.extend({find:function(t){var e,n=[],i=this,r=i.length;if("string"!=typeof t)return this.pushStack(ct(t).filter(function(){for(e=0;r>e;e++)if(ct.contains(i[e],this))return!0}));for(e=0;r>e;e++)ct.find(t,i[e],n);return n=this.pushStack(r>1?ct.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},has:function(t){var e,n=ct(t,this),i=n.length;return this.filter(function(){for(e=0;i>e;e++)if(ct.contains(this,n[e]))return!0})},not:function(t){return this.pushStack(d(this,t||[],!0))},filter:function(t){return this.pushStack(d(this,t||[],!1))},is:function(t){return!!d(this,"string"==typeof t&&Gt.test(t)?ct(t):t||[],!1).length},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=Gt.test(t)||"string"!=typeof t?ct(t,e||this.context):0;r>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ct.find.matchesSelector(n,t))){n=o.push(n);break}return this.pushStack(o.length>1?ct.unique(o):o)},index:function(t){return t?"string"==typeof t?ct.inArray(this[0],ct(t)):ct.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var n="string"==typeof t?ct(t,e):ct.makeArray(t&&t.nodeType?[t]:t),i=ct.merge(this.get(),n);return this.pushStack(ct.unique(i))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ct.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null;
},parents:function(t){return ct.dir(t,"parentNode")},parentsUntil:function(t,e,n){return ct.dir(t,"parentNode",n)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return ct.dir(t,"nextSibling")},prevAll:function(t){return ct.dir(t,"previousSibling")},nextUntil:function(t,e,n){return ct.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return ct.dir(t,"previousSibling",n)},siblings:function(t){return ct.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return ct.sibling(t.firstChild)},contents:function(t){return ct.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:ct.merge([],t.childNodes)}},function(t,e){ct.fn[t]=function(n,i){var r=ct.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=ct.filter(i,r)),this.length>1&&(Ut[t]||(r=ct.unique(r)),Wt.test(t)&&(r=r.reverse())),this.pushStack(r)}}),ct.extend({filter:function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?ct.find.matchesSelector(i,t)?[i]:[]:ct.find.matches(t,ct.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,n,i){for(var r=[],o=t[n];o&&9!==o.nodeType&&(i===e||1!==o.nodeType||!ct(o).is(i));)1===o.nodeType&&r.push(o),o=o[n];return r},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}});var qt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Vt=/ jQuery\d+="(?:null|\d+)"/g,Xt=new RegExp("<(?:"+qt+")[\\s/>]","i"),Yt=/^\s+/,Jt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Qt=/<([\w:]+)/,Kt=/<tbody/i,Zt=/<|&#?\w+;/,te=/<(?:script|style|link)/i,ee=/^(?:checkbox|radio)$/i,ne=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^$|\/(?:java|ecma)script/i,re=/^true\/(.*)/,oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ae={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ct.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},se=f(J),le=se.appendChild(J.createElement("div"));ae.optgroup=ae.option,ae.tbody=ae.tfoot=ae.colgroup=ae.caption=ae.thead,ae.th=ae.td,ct.fn.extend({text:function(t){return ct.access(this,function(t){return t===e?ct.text(this):this.empty().append((this[0]&&this[0].ownerDocument||J).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,i=t?ct.filter(t,this):this,r=0;null!=(n=i[r]);r++)e||1!==n.nodeType||ct.cleanData(w(n)),n.parentNode&&(e&&ct.contains(n.ownerDocument,n)&&v(w(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&ct.cleanData(w(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&ct.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return ct.clone(this,t,e)})},html:function(t){return ct.access(this,function(t){var n=this[0]||{},i=0,r=this.length;if(t===e)return 1===n.nodeType?n.innerHTML.replace(Vt,""):e;if(!("string"!=typeof t||te.test(t)||!ct.support.htmlSerialize&&Xt.test(t)||!ct.support.leadingWhitespace&&Yt.test(t)||ae[(Qt.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Jt,"<$1></$2>");try{for(;r>i;i++)n=this[i]||{},1===n.nodeType&&(ct.cleanData(w(n,!1)),n.innerHTML=t);n=0}catch(o){}}n&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=ct.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(n){var i=t[e++],r=t[e++];r&&(i&&i.parentNode!==r&&(i=this.nextSibling),ct(this).remove(),r.insertBefore(n,i))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,n){t=it.apply([],t);var i,r,o,a,s,l,h=0,c=this.length,u=this,d=c-1,f=t[0],p=ct.isFunction(f);if(p||!(1>=c||"string"!=typeof f||ct.support.checkClone)&&ne.test(f))return this.each(function(i){var r=u.eq(i);p&&(t[0]=f.call(this,i,r.html())),r.domManip(t,e,n)});if(c&&(l=ct.buildFragment(t,this[0].ownerDocument,!1,!n&&this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(a=ct.map(w(l,"script"),g),o=a.length;c>h;h++)r=l,h!==d&&(r=ct.clone(r,!0,!0),o&&ct.merge(a,w(r,"script"))),e.call(this[h],r,h);if(o)for(s=a[a.length-1].ownerDocument,ct.map(a,m),h=0;o>h;h++)r=a[h],ie.test(r.type||"")&&!ct._data(r,"globalEval")&&ct.contains(s,r)&&(r.src?ct._evalUrl(r.src):ct.globalEval((r.text||r.textContent||r.innerHTML||"").replace(oe,"")));l=i=null}return this}}),ct.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ct.fn[t]=function(t){for(var n,i=0,r=[],o=ct(t),a=o.length-1;a>=i;i++)n=i===a?this:this.clone(!0),ct(o[i])[e](n),rt.apply(r,n.get());return this.pushStack(r)}}),ct.extend({clone:function(t,e,n){var i,r,o,a,s,l=ct.contains(t.ownerDocument,t);if(ct.support.html5Clone||ct.isXMLDoc(t)||!Xt.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(le.innerHTML=t.outerHTML,le.removeChild(o=le.firstChild)),!(ct.support.noCloneEvent&&ct.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ct.isXMLDoc(t)))for(i=w(o),s=w(t),a=0;null!=(r=s[a]);++a)i[a]&&b(r,i[a]);if(e)if(n)for(s=s||w(t),i=i||w(o),a=0;null!=(r=s[a]);a++)y(r,i[a]);else y(t,o);return i=w(o,"script"),i.length>0&&v(i,!l&&w(t,"script")),i=s=r=null,o},buildFragment:function(t,e,n,i){for(var r,o,a,s,l,h,c,u=t.length,d=f(e),p=[],g=0;u>g;g++)if(o=t[g],o||0===o)if("object"===ct.type(o))ct.merge(p,o.nodeType?[o]:o);else if(Zt.test(o)){for(s=s||d.appendChild(e.createElement("div")),l=(Qt.exec(o)||["",""])[1].toLowerCase(),c=ae[l]||ae._default,s.innerHTML=c[1]+o.replace(Jt,"<$1></$2>")+c[2],r=c[0];r--;)s=s.lastChild;if(!ct.support.leadingWhitespace&&Yt.test(o)&&p.push(e.createTextNode(Yt.exec(o)[0])),!ct.support.tbody)for(o="table"!==l||Kt.test(o)?"<table>"!==c[1]||Kt.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)ct.nodeName(h=o.childNodes[r],"tbody")&&!h.childNodes.length&&o.removeChild(h);for(ct.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=d.lastChild}else p.push(e.createTextNode(o));for(s&&d.removeChild(s),ct.support.appendChecked||ct.grep(w(p,"input"),x),g=0;o=p[g++];)if((!i||-1===ct.inArray(o,i))&&(a=ct.contains(o.ownerDocument,o),s=w(d.appendChild(o),"script"),a&&v(s),n))for(r=0;o=s[r++];)ie.test(o.type||"")&&n.push(o);return s=null,d},cleanData:function(t,e){for(var n,i,r,o,a=0,s=ct.expando,l=ct.cache,h=ct.support.deleteExpando,c=ct.event.special;null!=(n=t[a]);a++)if((e||ct.acceptData(n))&&(r=n[s],o=r&&l[r])){if(o.events)for(i in o.events)c[i]?ct.event.remove(n,i):ct.removeEvent(n,i,o.handle);l[r]&&(delete l[r],h?delete n[s]:typeof n.removeAttribute!==X?n.removeAttribute(s):n[s]=null,et.push(r))}},_evalUrl:function(t){return ct.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ct.fn.extend({wrapAll:function(t){if(ct.isFunction(t))return this.each(function(e){ct(this).wrapAll(t.call(this,e))});if(this[0]){var e=ct(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return ct.isFunction(t)?this.each(function(e){ct(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ct(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=ct.isFunction(t);return this.each(function(n){ct(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){ct.nodeName(this,"body")||ct(this).replaceWith(this.childNodes)}).end()}});var he,ce,ue,de=/alpha\([^)]*\)/i,fe=/opacity\s*=\s*([^)]*)/,pe=/^(top|right|bottom|left)$/,ge=/^(none|table(?!-c[ea]).+)/,me=/^margin/,ve=new RegExp("^("+ut+")(.*)$","i"),ye=new RegExp("^("+ut+")(?!px)[a-z%]+$","i"),be=new RegExp("^([+-])=("+ut+")","i"),we={BODY:"block"},xe={position:"absolute",visibility:"hidden",display:"block"},Se={letterSpacing:0,fontWeight:400},_e=["Top","Right","Bottom","Left"],Ce=["Webkit","O","Moz","ms"];ct.fn.extend({css:function(t,n){return ct.access(this,function(t,n,i){var r,o,a={},s=0;if(ct.isArray(n)){for(o=ce(t),r=n.length;r>s;s++)a[n[s]]=ct.css(t,n[s],!1,o);return a}return i!==e?ct.style(t,n,i):ct.css(t,n)},t,n,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){_(this)?ct(this).show():ct(this).hide()})}}),ct.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=ue(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ct.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,n,i,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s,l=ct.camelCase(n),h=t.style;if(n=ct.cssProps[l]||(ct.cssProps[l]=S(h,l)),s=ct.cssHooks[n]||ct.cssHooks[l],i===e)return s&&"get"in s&&(o=s.get(t,!1,r))!==e?o:h[n];if(a=typeof i,"string"===a&&(o=be.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(ct.css(t,n)),a="number"),!(null==i||"number"===a&&isNaN(i)||("number"!==a||ct.cssNumber[l]||(i+="px"),ct.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(h[n]="inherit"),s&&"set"in s&&(i=s.set(t,i,r))===e)))try{h[n]=i}catch(c){}}},css:function(t,n,i,r){var o,a,s,l=ct.camelCase(n);return n=ct.cssProps[l]||(ct.cssProps[l]=S(t.style,l)),s=ct.cssHooks[n]||ct.cssHooks[l],s&&"get"in s&&(a=s.get(t,!0,i)),a===e&&(a=ue(t,n,r)),"normal"===a&&n in Se&&(a=Se[n]),""===i||i?(o=parseFloat(a),i===!0||ct.isNumeric(o)?o||0:a):a}}),t.getComputedStyle?(ce=function(e){return t.getComputedStyle(e,null)},ue=function(t,n,i){var r,o,a,s=i||ce(t),l=s?s.getPropertyValue(n)||s[n]:e,h=t.style;return s&&(""!==l||ct.contains(t.ownerDocument,t)||(l=ct.style(t,n)),ye.test(l)&&me.test(n)&&(r=h.width,o=h.minWidth,a=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=s.width,h.width=r,h.minWidth=o,h.maxWidth=a)),l}):J.documentElement.currentStyle&&(ce=function(t){return t.currentStyle},ue=function(t,n,i){var r,o,a,s=i||ce(t),l=s?s[n]:e,h=t.style;return null==l&&h&&h[n]&&(l=h[n]),ye.test(l)&&!pe.test(n)&&(r=h.left,o=t.runtimeStyle,a=o&&o.left,a&&(o.left=t.currentStyle.left),h.left="fontSize"===n?"1em":l,l=h.pixelLeft+"px",h.left=r,a&&(o.left=a)),""===l?"auto":l}),ct.each(["height","width"],function(t,e){ct.cssHooks[e]={get:function(t,n,i){return n?0===t.offsetWidth&&ge.test(ct.css(t,"display"))?ct.swap(t,xe,function(){return F(t,e,i)}):F(t,e,i):void 0},set:function(t,n,i){var r=i&&ce(t);return k(t,n,i?T(t,e,i,ct.support.boxSizing&&"border-box"===ct.css(t,"boxSizing",!1,r),r):0)}}}),ct.support.opacity||(ct.cssHooks.opacity={get:function(t,e){return fe.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var n=t.style,i=t.currentStyle,r=ct.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(e>=1||""===e)&&""===ct.trim(o.replace(de,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===e||i&&!i.filter)||(n.filter=de.test(o)?o.replace(de,r):o+" "+r)}}),ct(function(){ct.support.reliableMarginRight||(ct.cssHooks.marginRight={get:function(t,e){return e?ct.swap(t,{display:"inline-block"},ue,[t,"marginRight"]):void 0}}),!ct.support.pixelPosition&&ct.fn.position&&ct.each(["top","left"],function(t,e){ct.cssHooks[e]={get:function(t,n){return n?(n=ue(t,e),ye.test(n)?ct(t).position()[e]+"px":n):void 0}}})}),ct.expr&&ct.expr.filters&&(ct.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ct.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||ct.css(t,"display"))},ct.expr.filters.visible=function(t){return!ct.expr.filters.hidden(t)}),ct.each({margin:"",padding:"",border:"Width"},function(t,e){ct.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[t+_e[i]+e]=o[i]||o[i-2]||o[0];return r}},me.test(t)||(ct.cssHooks[t+e].set=k)});var ke=/%20/g,Te=/\[\]$/,Fe=/\r?\n/g,Ee=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;ct.fn.extend({serialize:function(){return ct.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ct.prop(this,"elements");return t?ct.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ct(this).is(":disabled")&&Ae.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!ee.test(t))}).map(function(t,e){var n=ct(this).val();return null==n?null:ct.isArray(n)?ct.map(n,function(t){return{name:e.name,value:t.replace(Fe,"\r\n")}}):{name:e.name,value:n.replace(Fe,"\r\n")}}).get()}}),ct.param=function(t,n){var i,r=[],o=function(t,e){e=ct.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(n===e&&(n=ct.ajaxSettings&&ct.ajaxSettings.traditional),ct.isArray(t)||t.jquery&&!ct.isPlainObject(t))ct.each(t,function(){o(this.name,this.value)});else for(i in t)D(i,t[i],n,o);return r.join("&").replace(ke,"+")},ct.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ct.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),ct.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var De,Ne,Me=ct.now(),Le=/\?/,Pe=/#.*$/,Ie=/([?&])_=[^&]*/,$e=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Re=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oe=/^(?:GET|HEAD)$/,ze=/^\/\//,Be=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,je=ct.fn.load,He={},We={},Ge="*/".concat("*");try{Ne=Y.href}catch(Ue){Ne=J.createElement("a"),Ne.href="",Ne=Ne.href}De=Be.exec(Ne.toLowerCase())||[],ct.fn.load=function(t,n,i){if("string"!=typeof t&&je)return je.apply(this,arguments);var r,o,a,s=this,l=t.indexOf(" ");return l>=0&&(r=t.slice(l,t.length),t=t.slice(0,l)),ct.isFunction(n)?(i=n,n=e):n&&"object"==typeof n&&(a="POST"),s.length>0&&ct.ajax({url:t,type:a,dataType:"html",data:n}).done(function(t){o=arguments,s.html(r?ct("<div>").append(ct.parseHTML(t)).find(r):t)}).complete(i&&function(t,e){s.each(i,o||[t.responseText,e,t])}),this},ct.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ct.fn[e]=function(t){return this.on(e,t)}}),ct.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ne,type:"GET",isLocal:Re.test(De[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ge,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ct.parseJSON,"text xml":ct.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?L(L(t,ct.ajaxSettings),e):L(ct.ajaxSettings,t)},ajaxPrefilter:N(He),ajaxTransport:N(We),ajax:function(t,n){function i(t,n,i,r){var o,u,y,b,x,_=n;2!==w&&(w=2,l&&clearTimeout(l),c=e,s=r||"",S.readyState=t>0?4:0,o=t>=200&&300>t||304===t,i&&(b=P(d,S,i)),b=I(d,b,S,o),o?(d.ifModified&&(x=S.getResponseHeader("Last-Modified"),x&&(ct.lastModified[a]=x),x=S.getResponseHeader("etag"),x&&(ct.etag[a]=x)),204===t||"HEAD"===d.type?_="nocontent":304===t?_="notmodified":(_=b.state,u=b.data,y=b.error,o=!y)):(y=_,(t||!_)&&(_="error",0>t&&(t=0))),S.status=t,S.statusText=(n||_)+"",o?g.resolveWith(f,[u,_,S]):g.rejectWith(f,[S,_,y]),S.statusCode(v),v=e,h&&p.trigger(o?"ajaxSuccess":"ajaxError",[S,d,o?u:y]),m.fireWith(f,[S,_]),h&&(p.trigger("ajaxComplete",[S,d]),--ct.active||ct.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=e),n=n||{};var r,o,a,s,l,h,c,u,d=ct.ajaxSetup({},n),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?ct(f):ct.event,g=ct.Deferred(),m=ct.Callbacks("once memory"),v=d.statusCode||{},y={},b={},w=0,x="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!u)for(u={};e=$e.exec(s);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=b[n]=b[n]||t,y[t]=e),this},overrideMimeType:function(t){return w||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else S.always(t[S.status]);return this},abort:function(t){var e=t||x;return c&&c.abort(e),i(0,e),this}};if(g.promise(S).complete=m.add,S.success=S.done,S.error=S.fail,d.url=((t||d.url||Ne)+"").replace(Pe,"").replace(ze,De[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=ct.trim(d.dataType||"*").toLowerCase().match(dt)||[""],null==d.crossDomain&&(r=Be.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]===De[1]&&r[2]===De[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(De[3]||("http:"===De[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ct.param(d.data,d.traditional)),M(He,d,n,S),2===w)return S;h=d.global,h&&0===ct.active++&&ct.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Oe.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(Le.test(a)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ie.test(a)?a.replace(Ie,"$1_="+Me++):a+(Le.test(a)?"&":"?")+"_="+Me++)),d.ifModified&&(ct.lastModified[a]&&S.setRequestHeader("If-Modified-Since",ct.lastModified[a]),ct.etag[a]&&S.setRequestHeader("If-None-Match",ct.etag[a])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",d.contentType),S.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ge+"; q=0.01":""):d.accepts["*"]);for(o in d.headers)S.setRequestHeader(o,d.headers[o]);if(d.beforeSend&&(d.beforeSend.call(f,S,d)===!1||2===w))return S.abort();x="abort";for(o in{success:1,error:1,complete:1})S[o](d[o]);if(c=M(We,d,n,S)){S.readyState=1,h&&p.trigger("ajaxSend",[S,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){S.abort("timeout")},d.timeout));try{w=1,c.send(y,i)}catch(_){if(!(2>w))throw _;i(-1,_)}}else i(-1,"No Transport");return S},getJSON:function(t,e,n){return ct.get(t,e,n,"json")},getScript:function(t,n){return ct.get(t,e,n,"script")}}),ct.each(["get","post"],function(t,n){ct[n]=function(t,i,r,o){return ct.isFunction(i)&&(o=o||r,r=i,i=e),ct.ajax({url:t,type:n,dataType:o,data:i,success:r})}}),ct.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return ct.globalEval(t),t}}}),ct.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),ct.ajaxTransport("script",function(t){if(t.crossDomain){var n,i=J.head||ct("head")[0]||J.documentElement;return{send:function(e,r){n=J.createElement("script"),n.async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(t,e){(e||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,e||r(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(e,!0)}}}});var qe=[],Ve=/(=)\?(?=&|$)|\?\?/;ct.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=qe.pop()||ct.expando+"_"+Me++;return this[t]=!0,t}}),ct.ajaxPrefilter("json jsonp",function(n,i,r){var o,a,s,l=n.jsonp!==!1&&(Ve.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ve.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=ct.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Ve,"$1"+o):n.jsonp!==!1&&(n.url+=(Le.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||ct.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=t[o],t[o]=function(){s=arguments},r.always(function(){t[o]=a,n[o]&&(n.jsonpCallback=i.jsonpCallback,qe.push(o)),s&&ct.isFunction(a)&&a(s[0]),s=a=e}),"script"):void 0});var Xe,Ye,Je=0,Qe=t.ActiveXObject&&function(){var t;for(t in Xe)Xe[t](e,!0)};ct.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&$()||R()}:$,Ye=ct.ajaxSettings.xhr(),ct.support.cors=!!Ye&&"withCredentials"in Ye,Ye=ct.support.ajax=!!Ye,Ye&&ct.ajaxTransport(function(n){if(!n.crossDomain||ct.support.cors){var i;return{send:function(r,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(s in r)l.setRequestHeader(s,r[s])}catch(h){}l.send(n.hasContent&&n.data||null),i=function(t,r){var s,h,c,u;try{if(i&&(r||4===l.readyState))if(i=e,a&&(l.onreadystatechange=ct.noop,Qe&&delete Xe[a]),r)4!==l.readyState&&l.abort();else{u={},s=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{c=l.statusText}catch(d){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=u.text?200:404}}catch(f){r||o(-1,f)}u&&o(s,c,u,h)},n.async?4===l.readyState?setTimeout(i):(a=++Je,Qe&&(Xe||(Xe={},ct(t).unload(Qe)),Xe[a]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(e,!0)}}}});var Ke,Ze,tn=/^(?:toggle|show|hide)$/,en=new RegExp("^(?:([+-])=|)("+ut+")([a-z%]*)$","i"),nn=/queueHooks$/,rn=[H],on={"*":[function(t,e){var n=this.createTween(t,e),i=n.cur(),r=en.exec(e),o=r&&r[3]||(ct.cssNumber[t]?"":"px"),a=(ct.cssNumber[t]||"px"!==o&&+i)&&en.exec(ct.css(n.elem,t)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+i||1;do s=s||".5",a/=s,ct.style(n.elem,t,a+o);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};ct.Animation=ct.extend(B,{tweener:function(t,e){ct.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,r=t.length;r>i;i++)n=t[i],on[n]=on[n]||[],on[n].unshift(e)},prefilter:function(t,e){e?rn.unshift(t):rn.push(t)}}),ct.Tween=W,W.prototype={constructor:W,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(ct.cssNumber[n]?"":"px")},cur:function(){var t=W.propHooks[this.prop];return t&&t.get?t.get(this):W.propHooks._default.get(this)},run:function(t){var e,n=W.propHooks[this.prop];return this.options.duration?this.pos=e=ct.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):W.propHooks._default.set(this),this}},W.prototype.init.prototype=W.prototype,W.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=ct.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){ct.fx.step[t.prop]?ct.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[ct.cssProps[t.prop]]||ct.cssHooks[t.prop])?ct.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},W.propHooks.scrollTop=W.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ct.each(["toggle","show","hide"],function(t,e){var n=ct.fn[e];ct.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(G(e,!0),t,i,r)}}),ct.fn.extend({fadeTo:function(t,e,n,i){return this.filter(_).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=ct.isEmptyObject(t),o=ct.speed(e,n,i),a=function(){var e=B(this,ct.extend({},t),o);(r||ct._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,n,i){var r=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=n,n=t,t=e),n&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",o=ct.timers,a=ct._data(this);if(n)a[n]&&a[n].stop&&r(a[n]);else for(n in a)a[n]&&a[n].stop&&nn.test(n)&&r(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(i),e=!1,o.splice(n,1));(e||!i)&&ct.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=ct._data(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=ct.timers,a=i?i.length:0;for(n.finish=!0,ct.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),ct.each({slideDown:G("show"),slideUp:G("hide"),slideToggle:G("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ct.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),ct.speed=function(t,e,n){var i=t&&"object"==typeof t?ct.extend({},t):{complete:n||!n&&e||ct.isFunction(t)&&t,duration:t,easing:n&&e||e&&!ct.isFunction(e)&&e};return i.duration=ct.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ct.fx.speeds?ct.fx.speeds[i.duration]:ct.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ct.isFunction(i.old)&&i.old.call(this),i.queue&&ct.dequeue(this,i.queue)},i},ct.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},ct.timers=[],ct.fx=W.prototype.init,ct.fx.tick=function(){var t,n=ct.timers,i=0;for(Ke=ct.now();i<n.length;i++)t=n[i],t()||n[i]!==t||n.splice(i--,1);n.length||ct.fx.stop(),Ke=e},ct.fx.timer=function(t){t()&&ct.timers.push(t)&&ct.fx.start()},ct.fx.interval=13,ct.fx.start=function(){Ze||(Ze=setInterval(ct.fx.tick,ct.fx.interval))},ct.fx.stop=function(){clearInterval(Ze),Ze=null},ct.fx.speeds={slow:600,fast:200,_default:400},ct.fx.step={},ct.expr&&ct.expr.filters&&(ct.expr.filters.animated=function(t){return ct.grep(ct.timers,function(e){return t===e.elem}).length}),ct.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){ct.offset.setOffset(this,t,e)});var n,i,r={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return n=a.documentElement,ct.contains(n,o)?(typeof o.getBoundingClientRect!==X&&(r=o.getBoundingClientRect()),i=U(a),{top:r.top+(i.pageYOffset||n.scrollTop)-(n.clientTop||0),left:r.left+(i.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):r},ct.offset={setOffset:function(t,e,n){var i=ct.css(t,"position");"static"===i&&(t.style.position="relative");var r,o,a=ct(t),s=a.offset(),l=ct.css(t,"top"),h=ct.css(t,"left"),c=("absolute"===i||"fixed"===i)&&ct.inArray("auto",[l,h])>-1,u={},d={};c?(d=a.position(),r=d.top,o=d.left):(r=parseFloat(l)||0,o=parseFloat(h)||0),ct.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(u.top=e.top-s.top+r),null!=e.left&&(u.left=e.left-s.left+o),"using"in e?e.using.call(t,u):a.css(u)}},ct.fn.extend({position:function(){if(this[0]){var t,e,n={top:0,left:0},i=this[0];return"fixed"===ct.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ct.nodeName(t[0],"html")||(n=t.offset()),n.top+=ct.css(t[0],"borderTopWidth",!0),n.left+=ct.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-ct.css(i,"marginTop",!0),left:e.left-n.left-ct.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Q;t&&!ct.nodeName(t,"html")&&"static"===ct.css(t,"position");)t=t.offsetParent;return t||Q})}}),ct.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var i=/Y/.test(n);ct.fn[t]=function(r){return ct.access(this,function(t,r,o){var a=U(t);return o===e?a?n in a?a[n]:a.document.documentElement[r]:t[r]:void(a?a.scrollTo(i?ct(a).scrollLeft():o,i?o:ct(a).scrollTop()):t[r]=o)},t,r,arguments.length,null)}}),ct.each({Height:"height",Width:"width"},function(t,n){ct.each({padding:"inner"+t,content:n,"":"outer"+t},function(i,r){ct.fn[r]=function(r,o){var a=arguments.length&&(i||"boolean"!=typeof r),s=i||(r===!0||o===!0?"margin":"border");return ct.access(this,function(n,i,r){var o;return ct.isWindow(n)?n.document.documentElement["client"+t]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+t],o["scroll"+t],n.body["offset"+t],o["offset"+t],o["client"+t])):r===e?ct.css(n,i,s):ct.style(n,i,r,s)},n,a?r:e,a,null)}})}),ct.fn.size=function(){return this.length},ct.fn.andSelf=ct.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ct:(t.jQuery=t.$=ct,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ct}))}(window),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var r=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(r,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),r=n.data("bs.alert");r||n.data("bs.alert",r=new i(this)),"string"==typeof e&&r[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.5",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){a.detach().trigger("closed.bs.alert").remove()}var r=t(this),o=r.attr("data-target");o||(o=r.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,""));var a=t(o);e&&e.preventDefault(),a.length||(a=r.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var r=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=r,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.button"),o="object"==typeof e&&e;r||i.data("bs.button",r=new n(this,o)),"toggle"==e?r.toggle():e&&r.setState(e);
})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.5",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var n="disabled",i=this.$element,r=i.is("input")?"val":"html",o=i.data();e+="Text",null==o.resetText&&i.data("resetText",i[r]()),setTimeout(t.proxy(function(){i[r](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=e,t.fn.button.Constructor=n,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=t(n.target);i.hasClass("btn")||(i=i.closest(".btn")),e.call(i,"toggle"),t(n.target).is('input[type="radio"]')||t(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.carousel"),o=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),a="string"==typeof e?e:o.slide;r||i.data("bs.carousel",r=new n(this,o)),"number"==typeof e?r.to(e):a?r[a]():o.interval&&r.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e),i="prev"==t&&0===n||"next"==t&&n==this.$items.length-1;if(i&&!this.options.wrap)return e;var r="prev"==t?-1:1,o=(n+r)%this.$items.length;return this.$items.eq(o)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(e,i){var r=this.$element.find(".item.active"),o=i||this.getItemForDirection(e,r),a=this.interval,s="next"==e?"left":"right",l=this;if(o.hasClass("active"))return this.sliding=!1;var h=o[0],c=t.Event("slide.bs.carousel",{relatedTarget:h,direction:s});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=t(this.$indicators.children()[this.getItemIndex(o)]);u&&u.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:h,direction:s});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,r.addClass(s),o.addClass(s),r.one("bsTransitionEnd",function(){o.removeClass([e,s].join(" ")).addClass("active"),r.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(d)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(r.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(d)),a&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var r=function(n){var i,r=t(this),o=t(r.attr("data-target")||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var a=t.extend({},o.data(),r.data()),s=r.attr("data-slide-to");s&&(a.interval=!1),e.call(o,a),s&&o.data("bs.carousel").to(s),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery),+function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),r=n.data("bs.collapse"),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!r&&o.toggle&&/show|hide/.test(e)&&(o.toggle=!1),r||n.data("bs.collapse",r=new i(this,o)),"string"==typeof e&&r[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.5",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(e=r.data("bs.collapse"),e&&e.transitioning))){var o=t.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){r&&r.length&&(n.call(r,"hide"),e||r.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return s.call(this);var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[a](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(i.TRANSITION_DURATION):r.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var r=t(i);this.addAriaAndCollapsedClass(e(r),r)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var r=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=r,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var r=t(this);r.attr("data-target")||i.preventDefault();var o=e(r),a=o.data("bs.collapse"),s=a?"toggle":r.data();n.call(o,s)})}(jQuery),+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(r).remove(),t(o).each(function(){var i=t(this),r=e(i),o={relatedTarget:this};r.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(r[0],n.target)||(r.trigger(n=t.Event("hide.bs.dropdown",o)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),r.removeClass("open").trigger("hidden.bs.dropdown",o))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof e&&i[e].call(n)})}var r=".dropdown-backdrop",o='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.5",a.prototype.toggle=function(i){var r=t(this);if(!r.is(".disabled, :disabled")){var o=e(r),a=o.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var s={relatedTarget:this};if(o.trigger(i=t.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var r=e(i),a=r.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&r.find(o).trigger("focus"),i.trigger("click");var s=" li:not(.disabled):visible a",l=r.find(".dropdown-menu"+s);if(l.length){var h=l.index(n.target);38==n.which&&h>0&&h--,40==n.which&&h<l.length-1&&h++,~h||(h=0),l.eq(h).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,a.prototype.toggle).on("keydown.bs.dropdown.data-api",o,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,i){return this.each(function(){var r=t(this),o=r.data("bs.modal"),a=t.extend({},n.DEFAULTS,r.data(),"object"==typeof e&&e);o||r.data("bs.modal",o=new n(this,a)),"string"==typeof e?o[e](i):a.show&&o.show(i)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var i=this,r=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),r&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});r?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(o)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var i=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&r;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),r=i.attr("href"),o=t(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),a=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},o.data(),i.data());i.is("a")&&n.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(o,a,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tooltip"),o="object"==typeof e&&e;(r||!/destroy|hide/.test(e))&&(r||i.data("bs.tooltip",r=new n(this,o)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var r=this,o=this.tip(),a=this.getUID(this.type);this.setContent(),o.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,h=l.test(s);h&&(s=s.replace(l,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),u=o[0].offsetWidth,d=o[0].offsetHeight;if(h){var f=s,p=this.getPosition(this.$viewport);s="bottom"==s&&c.bottom+d>p.bottom?"top":"top"==s&&c.top-d<p.top?"bottom":"right"==s&&c.right+u>p.width?"left":"left"==s&&c.left-u<p.left?"right":s,o.removeClass(f).addClass(s)}var g=this.getCalculatedOffset(s,c,u,d);this.applyPlacement(g,s);var m=function(){var t=r.hoverState;r.$element.trigger("shown.bs."+r.type),r.hoverState=null,"out"==t&&r.leave(r)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",m).emulateTransitionEnd(n.TRANSITION_DURATION):m()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top+=a,e.left+=s,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var l=i[0].offsetWidth,h=i[0].offsetHeight;"top"==n&&h!=o&&(e.top=e.top+o-h);var c=this.getViewportAdjustedDelta(n,e,l,h);c.left?e.left+=c.left:e.top+=c.top;var u=/top|bottom/.test(n),d=u?2*c.left-r+l:2*c.top-o+h,f=u?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(d,i[0][f],u)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=r.hoverState&&o.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),e&&e()}var r=this,o=t(this.$tip),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=t.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=i?{top:0,left:0}:e.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},s=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},r,a,s,o)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-o-a.scroll,l=e.top+o-a.scroll+i;s<a.top?r.top=a.top-s:l>a.top+a.height&&(r.top=a.top+a.height-l)}else{var h=e.left-o,c=e.left+o+n;h<a.left?r.left=a.left-h:c>a.right&&(r.left=a.left+a.width-c)}return r},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.popover"),o="object"==typeof e&&e;(r||!/destroy|hide/.test(e))&&(r||i.data("bs.popover",r=new n(this,o)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.5",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";function e(n,i){this.$body=t(document.body),this.$scrollElement=t(t(n).is(document.body)?window:n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),r=i.data("bs.scrollspy"),o="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new e(this,o)),"string"==typeof n&&r[n]()})}e.VERSION="3.3.5",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),r=e.data("target")||e.attr("href"),o=/^#./.test(r)&&t(r);return o&&o.length&&o.is(":visible")&&[[o[n]().top+i,r]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),r=this.offsets,o=this.targets,a=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return a!=(t=o[o.length-1])&&this.activate(t);if(a&&e<r[0])return this.activeTarget=null,this.clear();for(t=r.length;t--;)a!=o[t]&&e>=r[t]&&(void 0===r[t+1]||e<r[t+1])&&this.activate(o[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new n(this)),"string"==typeof e&&r[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var r=n.find(".active:last a"),o=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(o),e.trigger(a),!a.isDefaultPrevented()&&!o.isDefaultPrevented()){var s=t(i);this.activate(e.closest("li"),n),this.activate(s,s.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},n.prototype.activate=function(e,i,r){function o(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}var a=i.find("> .active"),s=r&&t.support.transition&&(a.length&&a.hasClass("fade")||!!i.find("> .fade").length);a.length&&s?a.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o(),a.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var r=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r);
}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.affix"),o="object"==typeof e&&e;r||i.data("bs.affix",r=new n(this,o)),"string"==typeof e&&r[e]()})}var n=function(e,i){this.options=t.extend({},n.DEFAULTS,i),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.5",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(t,e,n,i){var r=this.$target.scrollTop(),o=this.$element.offset(),a=this.$target.height();if(null!=n&&"top"==this.affixed)return n>r?"top":!1;if("bottom"==this.affixed)return null!=n?r+this.unpin<=o.top?!1:"bottom":t-i>=r+a?!1:"bottom";var s=null==this.affixed,l=s?r:o.top,h=s?a:e;return null!=n&&n>=r?"top":null!=i&&l+h>=t-i?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),i=this.options.offset,r=i.top,o=i.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof i&&(o=r=i),"function"==typeof r&&(r=i.top(this.$element)),"function"==typeof o&&(o=i.bottom(this.$element));var s=this.getState(a,e,r,o);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var l="affix"+(s?"-"+s:""),h=t.Event(l+".bs.affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:a-e-o})}};var i=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),i=n.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),e.call(n,i)})})}(jQuery),define("bootstrap",function(){}),define("config",[],function(){return{animation_enable:!0,testusers:[],title:"Another space",img_path:"img/",img_version:"2",galaxies:[{id:1,depend:!1,status:!0,opened:!0},{id:2,depend:[{id:1,angle:140}],status:!0},{id:3,depend:[{id:1,angle:70}],status:!0},{id:4,depend:[{id:3,angle:145},{id:2,angle:45}]},{id:5,depend:[{id:34,angle:100}]},{id:6,depend:[{id:4,angle:40}]},{id:7,depend:[{id:8,angle:85}],status:!0},{id:8,depend:[{id:4,angle:120},{id:5,angle:70}]},{id:9,depend:[{id:8,angle:140}]},{id:10,depend:[{id:6,angle:330},{id:3,angle:0},{id:11,angle:170}]},{id:11,depend:!1},{id:12,depend:[{id:11,angle:90}]},{id:13,depend:[{id:11,angle:35},{id:17,angle:130}]},{id:14,depend:[{id:12,angle:15},{id:13,angle:70},{id:15,angle:170}]},{id:15,depend:[{id:16,angle:110}]},{id:16,depend:[{id:17,angle:10}]},{id:17,depend:[{id:18,angle:60}]},{id:18,depend:[{id:19,angle:110},{id:20,angle:30}]},{id:19,depend:[{id:22,angle:30}]},{id:20,depend:[{id:22,angle:120}]},{id:21,depend:[{id:24,angle:70}]},{id:22,depend:[{id:21,angle:150},{id:25,angle:60}]},{id:23,depend:[{id:11,angle:170},{id:6,angle:10}]},{id:24,depend:!1},{id:25,depend:[{id:24,angle:150},{id:26,angle:60}]},{id:26,depend:[{id:28,angle:0}]},{id:27,depend:[{id:26,angle:120}]},{id:28,depend:[{id:29,angle:50}]},{id:29,depend:!1},{id:30,depend:[{id:28,angle:170},{id:35,angle:10}]},{id:31,depend:[{id:32,angle:0},{id:28,angle:110}]},{id:32,depend:[{id:35,angle:80}]},{id:33,depend:[{id:32,angle:120}]},{id:34,depend:[{id:2,angle:190},{id:33,angle:120},{id:44,angle:0}]},{id:35,depend:[{id:36,angle:50}]},{id:36,depend:!1},{id:37,depend:[{id:35,angle:120}]},{id:38,depend:[{id:36,angle:110},{id:39,angle:50}]},{id:39,depend:!1},{id:40,depend:[{id:38,angle:170}]},{id:41,depend:[{id:40,angle:50}]},{id:42,depend:[{id:41,angle:170}]},{id:43,depend:[{id:41,angle:95},{id:45,angle:10}]},{id:44,depend:[{id:43,angle:80}]},{id:45,depend:[{id:42,angle:90},{id:47,angle:10}]},{id:46,depend:[{id:45,angle:100},{id:47,angle:50},{id:44,angle:180}]},{id:47,depend:!1},{id:48,depend:[{id:46,angle:140}]},{id:49,depend:[{id:46,angle:110},{id:48,angle:35},{id:50,angle:320}]},{id:50,depend:[{id:48,angle:100}]},{id:51,depend:[{id:1,angle:320}]},{id:52,depend:[{id:1,angle:260}]},{id:53,depend:[{id:10,angle:320}]},{id:54,depend:[{id:6,angle:70}]},{id:54,depend:[{id:47,angle:230}]},{id:55,depend:[{id:49,angle:350}]}],raids:[{icon:"/img/test.png",code:"first",level:0,need:!1},{icon:"/img/test.png",code:"second",level:5,need:["first"]},{icon:"/img/test.png",code:"second2",level:5,need:["first"]},{icon:"/img/test.png",code:"second3",level:5,need:["first"]},{icon:"/img/test.png",code:"second4",level:5,need:["first"]},{icon:"/img/test.png",code:"second5",level:10,need:["second2"]},{icon:"/img/test.png",code:"second7",level:10,need:["second4"]},{icon:"/img/test.png",code:"second8",level:15,need:["second"]},{icon:"/img/test.png",code:"second9",level:15,need:["second3","second5"]},{icon:"/img/test.png",code:"second10",level:15,need:["second7"]},{icon:"/img/test.png",code:"second11",level:20,need:["second10","second9","second8"]},{icon:"/img/test.png",code:"second12",level:25,need:["second11"]},{icon:"/img/test.png",code:"second13",level:25,need:["second11"]},{icon:"/img/test.png",code:"second13",level:30,need:["second13"]},{icon:"/img/test.png",code:"second14",level:35,need:["second13"]},{icon:"/img/test.png",code:"second15",level:35,need:["second13"]}],sagas:[{icon:"/img/test.png",code:"first",level:0,need:!1},{icon:"/img/test.png",code:"second",level:5,need:["first"]},{icon:"/img/test.png",code:"second2",level:10,need:["first"]},{icon:"/img/test.png",code:"second3",level:15,need:["second2"]},{icon:"/img/test.png",code:"second4",level:15,need:["second2"]},{icon:"/img/test.png",code:"second5",level:20,need:["second4"]},{icon:"/img/test.png",code:"second6",level:20,need:["second4"]},{icon:"/img/test.png",code:"second7",level:20,need:["second4"]},{icon:"/img/test.png",code:"second8",level:25,need:["second6"]},{icon:"/img/test.png",code:"second9",level:25,need:["second3"]},{icon:"/img/test.png",code:"second10",level:30,need:["second7"]},{icon:"/img/test.png",code:"second11",level:30,need:["second8"]},{icon:"/img/test.png",code:"second12",level:35,need:["second11"]},{icon:"/img/test.png",code:"second13",level:40,need:["second12"]},{icon:"/img/test.png",code:"second14",level:50,need:["second13"]},{icon:"/img/test.png",code:"second15",level:60,need:["second14"]},{icon:"/img/test.png",code:"second16",level:70,need:["second15"]},{icon:"/img/test.png",code:"second17",level:80,need:["second16"]},{icon:"/img/test.png",code:"second18",level:80,need:["second16"]},{icon:"/img/test.png",code:"second19",level:90,need:["second17"]},{icon:"/img/test.png",code:"second20",level:90,need:["second18"]},{icon:"/img/test.png",code:"second21",level:100,need:["second20","second19"]}],facebook:{url:appOptions.app_url,init:{appId:appOptions.app_id,version:"v2.2",xfbml:!0},permission:["public_profile","user_friends","publish_actions"]},vkontakte:{init:{apiId:"undefined"!=typeof VK_ID?VK_ID:""},price_rate:10,test_mode:!1},promo:{status:!0,test:!1},auth_type:appOptions.auth,api_version:"1.0",timeout:3600,langDefault:"en",langs:["en","ru","fr","es","it","de"],routers:{"default":{regexp:"^/([^/?]*)(?:/([^/?]*))?",constraints:{controller:1,action:2},"default":{controller:"index",action:"index"}}},quests:{},images:[]}}),require.config({urlArgs:"v="+appOptions.ver,paths:{jquery:"../lib/jquery-1.10.2",hammer:"../lib/hammer",backbone:"../lib/backbone-min",bootstrap:"../lib/bootstrap.min",underscore:"../lib/underscore-min","jquery.cookie":"../lib/jquery.cookie","jquery.emoticons":"../lib/jquery.emoticons","jquery.hammer":"../lib/jquery.hammer",facebook:"https://connect.facebook.net/en_US/all",mailru:"//connect.mail.ru/js/loader",vkontakte:"//vk.com/js/api/xd_connection",odnoklassniki:"//api.odnoklassniki.ru/js/fapi5","jquery.mb":"../lib/jquery.mb.audio","backbone-validation":"../lib/backbone-validation-min",localstorage:"../lib/backbone.localStorage",i18n:"../lib/i18next.min",konva:"../lib/konva.min",html2canvas:"../lib/html2canvas"},shim:{jquery:{exports:"$"},facebook:{exports:"FB"},"jquery.emoticons":{deps:["jquery"],exports:"jQuery.fn.emoticons"},"jquery.mb":{deps:["jquery"]},"jquery.hammer":{deps:["jquery"]},underscore:{deps:["jquery"],exports:"_"},backbone:{deps:["jquery","underscore"],exports:"Backbone"},i18n:{deps:["jquery"]},localstorage:{deps:["backbone"]},bootstrap:{deps:["jquery"]}}}),console||(console={log:function(){},debug:function(){}}),require(["app","jquery","bootstrap","config"],function(t,e,n,i){function r(t){t=t.split("+").join(" ");for(var e,n={},i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);)n[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return n}function o(e){console.log("response",e);try{var n=function(){var n=new t(i);n.profile.setFacebookResponse(e.authResponse),n.init()};void 0!==a.request_ids?FB.api(a.request_ids,function(t){void 0!==t.from&&(e.authResponse.user_from_id=t.from.id),n()}):n()}catch(r){console.error(r)}}var a=r(document.location.search);if(void 0!==a.auth_user_id){var s=new t(i);return s.setTestResponse({user_id:a.auth_user_id}),void s.init()}if(console.log("run",i.auth_type),"default"==i.auth_type){var s=new t(i);s.init()}"fb"==i.auth_type&&require(["fb"],function(){FB.getLoginStatus(function(t){console.log("authresponse",t),"connected"===t.status?FB.api("/me/permissions",function(e){var n=!0;for(var r in i.facebook.permission){var a=!1,s=i.facebook.permission[r];for(var l in e.data)e.data[l].permission==s&&"granted"==e.data[l].status&&(a=!0);a||(n=!1)}n?o(t):FB.login(function(t){o(t)},{scope:i.facebook.permission})}):FB.login(function(t){o(t)},{scope:i.facebook.permission})},function(){console.log("fb error")})},function(t){e("#startlog").text("Facebook disconected")})}),define("main",function(){}),define("config/emotion",[],function(){return{smile:{title:"Smile",codes:[":)",":=)",":-)"]},"sad-smile":{title:"Sad Smile",codes:[":(",":=(",":-("]},"big-smile":{title:"Big Smile",codes:[":D",":=D",":-D",":d",":=d",":-d"]},cool:{title:"Cool",codes:["8)","8=)","8-)","B)","B=)","B-)","(cool)"]},wink:{title:"Wink",codes:[":o",":=o",":-o",":O",":=O",":-O"]},crying:{title:"Crying",codes:[";(",";-(",";=("]},sweating:{title:"Sweating",codes:["(sweat)","(:|"]},speechless:{title:"Speechless",codes:[":|",":=|",":-|"]},kiss:{title:"Kiss",codes:[":*",":=*",":-*"]},"tongue-out":{title:"Tongue Out",codes:[":P",":=P",":-P",":p",":=p",":-p"]},blush:{title:"Blush",codes:["(blush)",":$",":-$",":=$",':">']},wondering:{title:"Wondering",codes:[":^)"]},sleepy:{title:"Sleepy",codes:["|-)","I-)","I=)","(snooze)"]},dull:{title:"Dull",codes:["|(","|-(","|=("]},"in-love":{title:"In love",codes:["(inlove)"]},"evil-grin":{title:"Evil grin",codes:["]:)",">:)","(grin)"]},talking:{title:"Talking",codes:["(talk)"]},yawn:{title:"Yawn",codes:["(yawn)","|-()"]},puke:{title:"Puke",codes:["(puke)",":&",":-&",":=&"]},"doh!":{title:"Doh!",codes:["(doh)"]},angry:{title:"Angry",codes:[":@",":-@",":=@","x(","x-(","x=(","X(","X-(","X=("]},"it-wasnt-me":{title:"It wasn't me",codes:["(wasntme)"]},party:{title:"Party!!!",codes:["(party)"]},worried:{title:"Worried",codes:[":S",":-S",":=S",":s",":-s",":=s"]},mmm:{title:"Mmm...",codes:["(mm)"]},nerd:{title:"Nerd",codes:["8-|","B-|","8|","B|","8=|","B=|","(nerd)"]},"lips-sealed":{title:"Lips Sealed",codes:[":x",":-x",":X",":-X",":#",":-#",":=x",":=X",":=#"]},hi:{title:"Hi",codes:["(hi)"]},call:{title:"Call",codes:["(call)"]},devil:{title:"Devil",codes:["(devil)"]},angel:{title:"Angel",codes:["(angel)"]},envy:{title:"Envy",codes:["(envy)"]},wait:{title:"Wait",codes:["(wait)"]},bear:{title:"Bear",codes:["(bear)","(hug)"]},"make-up":{title:"Make-up",codes:["(makeup)","(kate)"]},"covered-laugh":{title:"Covered Laugh",codes:["(giggle)","(chuckle)"]},"clapping-hands":{title:"Clapping Hands",codes:["(clap)"]},thinking:{title:"Thinking",codes:["(think)",":?",":-?",":=?"]},bow:{title:"Bow",codes:["(bow)"]},rofl:{title:"Rolling on the floor laughing",codes:["(rofl)"]},whew:{title:"Whew",codes:["(whew)"]},happy:{title:"Happy",codes:["(happy)"]},smirking:{title:"Smirking",codes:["(smirk)"]},nodding:{title:"Nodding",codes:["(nod)"]},shaking:{title:"Shaking",codes:["(shake)"]},punch:{title:"Punch",codes:["(punch)"]},emo:{title:"Emo",codes:["(emo)"]},yes:{title:"Yes",codes:["(y)","(Y)","(ok)"]},no:{title:"No",codes:["(n)","(N)"]},handshake:{title:"Shaking Hands",codes:["(handshake)"]},skype:{title:"Skype",codes:["(skype)","(ss)"]},heart:{title:"Heart",codes:["(h)","<3","(H)","(l)","(L)"]},"broken-heart":{title:"Broken heart",codes:["(u)","(U)"]},mail:{title:"Mail",codes:["(e)","(m)"]},flower:{title:"Flower",codes:["(f)","(F)"]},rain:{title:"Rain",codes:["(rain)","(london)","(st)"]},sun:{title:"Sun",codes:["(sun)"]},time:{title:"Time",codes:["(o)","(O)","(time)"]},music:{title:"Music",codes:["(music)"]},movie:{title:"Movie",codes:["(~)","(film)","(movie)"]},phone:{title:"Phone",codes:["(mp)","(ph)"]},coffee:{title:"Coffee",codes:["(coffee)"]},pizza:{title:"Pizza",codes:["(pizza)","(pi)"]},cash:{title:"Cash",codes:["(cash)","(mo)","($)"]},muscle:{title:"Muscle",codes:["(muscle)","(flex)"]},cake:{title:"Cake",codes:["(^)","(cake)"]},beer:{title:"Beer",codes:["(beer)"]},drink:{title:"Drink",codes:["(d)","(D)"]},dance:{title:"Dance",codes:["(dance)","\\o/","\\:D/","\\:d/"]},ninja:{title:"Ninja",codes:["(ninja)"]},star:{title:"Star",codes:["(*)"]},mooning:{title:"Mooning",codes:["(mooning)"]},finger:{title:"Finger",codes:["(finger)"]},bandit:{title:"Bandit",codes:["(bandit)"]},drunk:{title:"Drunk",codes:["(drunk)"]},smoking:{title:"Smoking",codes:["(smoking)","(smoke)","(ci)"]},toivo:{title:"Toivo",codes:["(toivo)"]},rock:{title:"Rock",codes:["(rock)"]},headbang:{title:"Headbang",codes:["(headbang)","(banghead)"]},bug:{title:"Bug",codes:["(bug)"]},fubar:{title:"Fubar",codes:["(fubar)"]},poolparty:{title:"Poolparty",codes:["(poolparty)"]},swearing:{title:"Swearing",codes:["(swear)"]},tmi:{title:"TMI",codes:["(tmi)"]},heidy:{title:"Heidy",codes:["(heidy)"]},myspace:{title:"MySpace",codes:["(MySpace)"]},malthe:{title:"Malthe",codes:["(malthe)"]},tauri:{title:"Tauri",codes:["(tauri)"]},priidu:{title:"Priidu",codes:["(priidu)"]}}}),define("controllers/city",[],function(){return{indexAction:function(t){return{addMessage:function(e,n,i){t.requestChatAdd({message:e,type:n},i)},openWindow:function(e){t.window("city",e)}}},settingsWindow:function(t){return{}},helpWindow:function(t){return{}},sagaWindow:function(t){return{}},tournamentsWindow:function(t){return{}},checkedWindow:function(t){return{}},friendsWindow:function(t){return{}},searchWindow:function(t){return{}},chartWindow:function(t){return{}},eventsWindow:function(t){return{}},guildWindow:function(t){return{}},inventoryWindow:function(t){return{}},giftsWindow:function(t){return{}},questsWindow:function(t){return{}},notificationsWindow:function(t){return{}},mailWindow:function(t){return{}},newsWindow:function(t){return{}},profileWindow:function(t){return{}},buildWindow:function(t){return{}},changeServerWindow:function(t){return{}},showPlanetsWindow:function(t){return{}},showStantionsWindow:function(t){return{}},salesWindow:function(t){return{}},vipWindow:function(t){return{}},shopWindow:function(t){return{}},creditsWindow:function(t){return{}},unitsWindow:function(t){return{}},shipsWindow:function(t){return{}},galaxyMapWindow:function(t){return{}},systemMapWindow:function(t){return{}},planetMapWindow:function(t){return{}},commandCenterWindow:function(t){return{}},reviewWindow:function(t){return{}}}}),define("controllers/galaxy",[],function(){return{indexAction:function(t){return{openWindow:function(e,n){t.window("city",e,n)},infoWindow:function(e){t.window("galaxy","info",{galaxy:e})}}},infoWindow:function(t,e){return e}}}),define("controllers/index",[],function(){return{indexAction:function(t){var e={serverSelect:!1,profile:t.profile,langs:t.config.langs,serverList:t.serverList,init:function(e){t.upgradeServerList(function(){t.profile.setServer(t.serverList.at(0)),e()})},play:function(e){t.play(e)},openWindow:function(e){t.window("city",e)}};return e},errorWindow:function(t,e){return{error:e}}}}),define("controllers/planet",[],function(){return{indexAction:function(t){return{openWindow:function(e){t.window("city",e)}}}}}),define("controllers/raid",[],function(){return{indexAction:function(t){return{openWindow:function(e,n){t.window("city",e,n)},infoWindow:function(e){t.window("raid","info",{raid:e})}}},infoWindow:function(t,e){return e}}}),define("controllers/saga",[],function(){return{indexAction:function(t){return{openWindow:function(e){t.window("city",e)},infoWindow:function(e){t.window("saga","info",{saga:e})}}},infoWindow:function(t,e){return e}}}),define("controllers/system",[],function(){return{indexAction:function(t){return{openWindow:function(e){t.window("city",e)}}}}}),define("fb",["config","facebook"],function(t){console.log("fb init",t.facebook.init),FB.init(t.facebook.init)}),define("services/acl",["models/profile"],function(t){function e(){this.roles={guest:{},member:{child:"guest"},admin:{child:"member"}},this.rules={"default":{allow:["guest"],child:["home"]},home:{allow:["member"]}}}return e.prototype.setRole=function(t){this.role=t},e.prototype.getRole=function(t){if(void 0===this.role)throw ErrorException("role not set");return this.role},e.prototype.isAllow=function(t){for(var e in this.rules)this.isRule(t,e);this.profile=profile},e.prototype.isRule=function(t,e){var n=this.rules[t],i=this.getRole();for(var r in this.re)for(var o in n.allow)if(n.allow[o]==i)return!0},e}),Backbone.Validation=function(t){"use strict";var e={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(t,n){return l[e.labelFormatter](t,n)},format:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})}},i=function(e,n,r){return n=n||{},r=r||"",t.each(e,function(t,o){e.hasOwnProperty(o)&&(t&&"object"==typeof t&&t.constructor===Object&&i(t,n,r+o+"."),n[r+o]=t)}),n},r=function(){var r=function(e,n){return n=n||t.keys(t.result(e,"validation")||{}),t.reduce(n,function(t,e){return t[e]=void 0,t},{})},a=function(e,n){var i=e.attributes;return t.isFunction(i)?i=i(n):t.isString(i)&&t.isFunction(h[i])&&(i=h[i](n)),t.isArray(i)?i:void 0},s=function(e,n){var i=e.validation?t.result(e,"validation")[n]||{}:{};return(t.isFunction(i)||t.isString(i))&&(i={fn:i}),t.isArray(i)||(i=[i]),t.reduce(i,function(e,n){return t.each(t.without(t.keys(n),"msg"),function(t){e.push({fn:c[t],val:n[t],msg:n.msg})}),e},[])},l=function(e,i,r,o){return t.reduce(s(e,i),function(a,s){var l=t.extend({},n,c),h=s.fn.call(l,r,i,s.val,e,o);return h===!1||a===!1?!1:h&&!a?t.result(s,"msg")||h:a},"")},u=function(e,n,i){var r,o={},a=!0,s=t.clone(n);return t.each(i,function(t,n){r=l(e,n,t,s),r&&(o[n]=r,a=!1)}),{invalidAttrs:o,isValid:a}},d=function(e,n){return{preValidate:function(e,n){var i,r=this,o={};return t.isObject(e)?(t.each(e,function(t,e){i=r.preValidate(e,t),i&&(o[e]=i)}),t.isEmpty(o)?void 0:o):l(this,e,n,t.extend({},this.attributes))},isValid:function(r){var o,s,h,c;return r=r||a(n,e),t.isString(r)?s=[r]:t.isArray(r)&&(s=r),s&&(o=i(this.attributes),t.each(this.associatedViews,function(e){t.each(s,function(i){h=l(this,i,o[i],t.extend({},this.attributes)),h?(n.invalid(e,i,h,n.selector),c=c||{},c[i]=h):n.valid(e,i,n.selector)},this)},this)),r===!0&&(c=this.validate()),c&&this.trigger("invalid",this,c,{validationError:c}),s?!c:this.validation?this._isValid:!0},validate:function(o,s){var l=this,h=!o,c=t.extend({},n,s),d=r(l,a(n,e)),f=t.extend({},d,l.attributes,o),p=i(f),g=o?i(o):p,m=u(l,f,t.pick(p,t.keys(d)));return l._isValid=m.isValid,t.each(l.associatedViews,function(e){t.each(d,function(t,n){var i=m.invalidAttrs.hasOwnProperty(n),r=g.hasOwnProperty(n);i||c.valid(e,n,c.selector),i&&(r||h)&&c.invalid(e,n,m.invalidAttrs[n],c.selector)})}),t.defer(function(){l.trigger("validated",l._isValid,l,m.invalidAttrs),l.trigger("validated:"+(l._isValid?"valid":"invalid"),l,m.invalidAttrs)}),!c.forceUpdate&&t.intersection(t.keys(m.invalidAttrs),t.keys(g)).length>0?m.invalidAttrs:void 0}}},f=function(e,n,i){n.associatedViews?n.associatedViews.push(e):n.associatedViews=[e],t.extend(n,d(e,i))},p=function(e,n){n&&e.associatedViews.length>1?e.associatedViews=t.without(e.associatedViews,n):(delete e.validate,delete e.preValidate,delete e.isValid,delete e.associatedViews)},g=function(t){f(this.view,t,this.options)},m=function(t){p(t)};return{version:"0.11.3",configure:function(n){t.extend(e,n)},bind:function(n,i){i=t.extend({},e,o,i);var r=i.model||n.model,a=i.collection||n.collection;if("undefined"==typeof r&&"undefined"==typeof a)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?f(n,r,i):a&&(a.each(function(t){f(n,t,i)}),a.bind("add",g,{view:n,options:i}),a.bind("remove",m))},unbind:function(e,n){n=t.extend({},n);var i=n.model||e.model,r=n.collection||e.collection;i?p(i,e):r&&(r.each(function(t){p(t,e)}),r.unbind("add",g),r.unbind("remove",m))},mixin:d(null,e)}}(),o=r.callbacks={valid:function(t,e,n){t.$("["+n+'~="'+e+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(t,e,n,i){t.$("["+i+'~="'+e+'"]').addClass("invalid").attr("data-error",n)}},a=r.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},s=r.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},l=r.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace(/_/g," ")},label:function(t,e){return e.labels&&e.labels[t]||l.sentenceCase(t,e)}},h=r.attributeLoaders={inputNames:function(t){var e=[];return t&&t.$("form [name]").each(function(){/^(?:input|select|textarea)$/i.test(this.nodeName)&&this.name&&"submit"!==this.type&&-1===e.indexOf(this.name)&&e.push(this.name)}),e}},c=r.validators=function(){var e=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,n=/\s+$/;return null===t?"":t.toString().replace(e,"").replace(n,"")},n=function(e){return t.isNumber(e)||t.isString(e)&&e.match(a.number)},i=function(n){return!(t.isNull(n)||t.isUndefined(n)||t.isString(n)&&""===e(n)||t.isArray(n)&&t.isEmpty(n))};return{fn:function(e,n,i,r,o){return t.isString(i)&&(i=r[i]),i.call(r,e,n,o)},required:function(e,n,r,o,a){var l=t.isFunction(r)?r.call(o,e,n,a):r;return l||i(e)?l&&!i(e)?this.format(s.required,this.formatLabel(n,o)):void 0:!1},acceptance:function(e,n,i,r){return"true"===e||t.isBoolean(e)&&e!==!1?void 0:this.format(s.acceptance,this.formatLabel(n,r))},min:function(t,e,i,r){return!n(t)||i>t?this.format(s.min,this.formatLabel(e,r),i):void 0},max:function(t,e,i,r){return!n(t)||t>i?this.format(s.max,this.formatLabel(e,r),i):void 0},range:function(t,e,i,r){return!n(t)||t<i[0]||t>i[1]?this.format(s.range,this.formatLabel(e,r),i[0],i[1]):void 0},length:function(e,n,i,r){return t.isString(e)&&e.length===i?void 0:this.format(s.length,this.formatLabel(n,r),i)},minLength:function(e,n,i,r){return!t.isString(e)||e.length<i?this.format(s.minLength,this.formatLabel(n,r),i):void 0},maxLength:function(e,n,i,r){return!t.isString(e)||e.length>i?this.format(s.maxLength,this.formatLabel(n,r),i):void 0},rangeLength:function(e,n,i,r){return!t.isString(e)||e.length<i[0]||e.length>i[1]?this.format(s.rangeLength,this.formatLabel(n,r),i[0],i[1]):void 0},oneOf:function(e,n,i,r){return t.include(i,e)?void 0:this.format(s.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(t,e,n,i,r){return t!==r[n]?this.format(s.equalTo,this.formatLabel(e,i),this.formatLabel(n,i)):void 0},pattern:function(t,e,n,r){return i(t)&&t.toString().match(a[n]||n)?void 0:this.format(s[n]||s.inlinePattern,this.formatLabel(e,r),n)}}}();return t.each(c,function(e,i){c[i]=t.bind(c[i],t.extend({},n,c))}),r}(_),define("backbone-validation",function(){}),define("views/city/chart",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-chart",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-chart")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/checked",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-checked",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-checked")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/commandCenter",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-commandCenter",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-commandCenter")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/credits",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-credits",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-credits")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/friends",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-friends",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-friends")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/gifts",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-gifts",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-gifts")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/guild",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-guild",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-guild")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),function(t,e,n,i,r,o){function a(t,e,n,i,r){return g(t,t,n,i,e,t.defaultView.pageXOffset,t.defaultView.pageYOffset).then(function(o){P("Document cloned");var a=Vt+r,l="["+a+"='"+r+"']";t.querySelector(l).removeAttribute(a);var h=o.contentWindow,c=h.document.querySelector(l),u="function"==typeof e.onclone?Promise.resolve(e.onclone(h.document)):Promise.resolve(!0);return u.then(function(){
return s(c,o,e,n,i)})})}function s(t,n,i,r,o){var a=n.contentWindow,s=new Rt(a.document),d=new M(i,s),f=H(t),p="view"===i.type?r:c(a.document),g="view"===i.type?o:u(a.document),m=new i.renderer(p,g,d,i,e),v=new G(t,m,s,d,i);return v.ready.then(function(){P("Finished rendering");var e;return e="view"===i.type?h(m.canvas,{width:m.canvas.width,height:m.canvas.height,top:0,left:0,x:0,y:0}):t===a.document.body||t===a.document.documentElement||null!=i.canvas?m.canvas:h(m.canvas,{width:null!=i.width?i.width:f.width,height:null!=i.height?i.height:f.height,top:f.top,left:f.left,x:a.pageXOffset,y:a.pageYOffset}),l(n,i),e})}function l(t,e){e.removeContainer&&(t.parentNode.removeChild(t),P("Cleaned up container"))}function h(t,n){var i=e.createElement("canvas"),r=Math.min(t.width-1,Math.max(0,n.left)),o=Math.min(t.width,Math.max(1,n.left+n.width)),a=Math.min(t.height-1,Math.max(0,n.top)),s=Math.min(t.height,Math.max(1,n.top+n.height));return i.width=n.width,i.height=n.height,P("Cropping canvas at:","left:",n.left,"top:",n.top,"width:",o-r,"height:",s-a),P("Resulting crop with width",n.width,"and height",n.height," with x",r,"and y",a),i.getContext("2d").drawImage(t,r,a,o-r,s-a,n.x,n.y,o-r,s-a),i}function c(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function u(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function d(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}function f(){return e.documentMode&&e.documentMode<=9}function p(t,n){for(var i=3===t.nodeType?e.createTextNode(t.nodeValue):t.cloneNode(!1),r=t.firstChild;r;)(n===!0||1!==r.nodeType||"SCRIPT"!==r.nodeName)&&i.appendChild(p(r,n)),r=r.nextSibling;return i}function g(t,e,n,i,r,o,a){w(t);var s=f()?p(t.documentElement,r.javascriptEnabled):t.documentElement.cloneNode(!0),l=e.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=n,l.height=i,l.scrolling="no",e.body.appendChild(l),new Promise(function(e){var n=l.contentWindow.document;m(t.documentElement,s,"textarea"),m(t.documentElement,s,"select"),l.contentWindow.onload=l.onload=function(){var i=setInterval(function(){n.body.childNodes.length>0&&(x(t,n),clearInterval(i),"view"===r.type&&l.contentWindow.scrollTo(o,a),e(l))},50)},n.open(),n.write("<!DOCTYPE html><html></html>"),v(t,o,a),n.replaceChild(r.javascriptEnabled===!0?n.adoptNode(s):S(n.adoptNode(s)),n.documentElement),n.close()})}function m(t,e,n){for(var i=t.getElementsByTagName(n),r=e.getElementsByTagName(n),o=i.length,a=0;o>a;a++)r[a].value=i[a].value}function v(t,e,n){!t.defaultView||e===t.defaultView.pageXOffset&&n===t.defaultView.pageYOffset||t.defaultView.scrollTo(e,n)}function y(e,n,i,r,o,a){return new Et(e,n,t.document).then(b(e)).then(function(t){return g(t,i,r,o,a,0,0)})}function b(t){return function(n){var i,r=new DOMParser;try{i=r.parseFromString(n,"text/html")}catch(o){P("DOMParser not supported, falling back to createHTMLDocument"),i=e.implementation.createHTMLDocument("");try{i.open(),i.write(n),i.close()}catch(a){P("createHTMLDocument write not supported, falling back to document.body.innerHTML"),i.body.innerHTML=n}}var s=i.querySelector("base");if(!s||!s.href.host){var l=i.createElement("base");l.href=t,i.head.insertBefore(l,i.head.firstChild)}return i}}function w(t){[].slice.call(t.querySelectorAll("canvas"),0).forEach(function(t){t.setAttribute(Xt,"canvas-"+Yt++)})}function x(t,e){[].slice.call(t.querySelectorAll("["+Xt+"]"),0).forEach(function(t){try{var n=e.querySelector("["+Xt+'="'+t.getAttribute(Xt)+'"]');n&&(n.width=t.width,n.height=t.height,n.getContext("2d").putImageData(t.getContext("2d").getImageData(0,0,t.width,t.height),0,0))}catch(i){P("Unable to copy canvas content from",t,i)}t.removeAttribute(Xt)})}function S(t){return[].slice.call(t.childNodes,0).filter(_).forEach(function(e){"SCRIPT"===e.tagName?t.removeChild(e):S(e)}),t}function _(t){return t.nodeType===Node.ELEMENT_NODE}function C(t){var n=e.createElement("a");return n.href=t,n.href=n.href,n}function k(t){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}function T(t){if(this.src=t,P("DummyImageContainer for",t),!this.promise||!this.image){P("Initiating DummyImageContainer"),T.prototype.image=new Image;var e=this.image;T.prototype.promise=new Promise(function(t,n){e.onload=t,e.onerror=n,e.src=d(),e.complete===!0&&t(e)})}}function F(t,n){var i,r,o=e.createElement("div"),a=e.createElement("img"),s=e.createElement("span"),l="Hidden Text";o.style.visibility="hidden",o.style.fontFamily=t,o.style.fontSize=n,o.style.margin=0,o.style.padding=0,e.body.appendChild(o),a.src=d(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=n,s.style.margin=0,s.style.padding=0,s.appendChild(e.createTextNode(l)),o.appendChild(s),o.appendChild(a),i=a.offsetTop-s.offsetTop+1,o.removeChild(s),o.appendChild(e.createTextNode(l)),o.style.lineHeight="normal",a.style.verticalAlign="super",r=a.offsetTop-o.offsetTop+1,e.body.removeChild(o),this.baseline=i,this.lineWidth=1,this.middle=r}function E(){this.data={}}function A(t,e,n){this.image=null,this.src=t;var i=this,r=H(t);this.promise=(e?new Promise(function(e){"about:blank"===t.contentWindow.document.URL||null==t.contentWindow.document.documentElement?t.contentWindow.onload=t.onload=function(){e(t)}:e(t)}):this.proxyLoad(n.proxy,r,n)).then(function(t){return html2canvas(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return i.image=t})}function D(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}function N(t,e){this.src=t,this.image=new Image;var n=this;this.tainted=null,this.promise=new Promise(function(i,r){n.image.onload=i,n.image.onerror=r,e&&(n.image.crossOrigin="anonymous"),n.image.src=t,n.image.complete===!0&&i(n.image)})}function M(e,n){this.link=null,this.options=e,this.support=n,this.origin=this.getOrigin(t.location.href)}function L(t){D.apply(this,arguments),this.type=this.TYPES.LINEAR;var e=null===t.args[0].match(this.stepRegExp);e?t.args[0].split(" ").reverse().forEach(function(t){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var e=this.y0,n=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=n,this.y1=e}},this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(this.stepRegExp);return{color:new k(e[1]),stop:"%"===e[3]?e[2]/100:null}},this),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(t,e){null===t.stop&&this.colorStops.slice(e).some(function(n,i){return null!==n.stop?(t.stop=(n.stop-this.colorStops[e-1].stop)/(i+1)+this.colorStops[e-1].stop,!0):!1},this)},this)}function P(){t.html2canvas.logging&&t.console&&t.console.log&&Function.prototype.bind.call(t.console.log,t.console).apply(t.console,[Date.now()-t.html2canvas.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))}function I(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function $(t){var e=t.options[t.selectedIndex||0];return e?e.text||"":""}function R(t){return t&&"matrix"===t[1]?t[2].split(",").map(function(t){return parseFloat(t.trim())}):void 0}function O(t){return-1!==t.toString().indexOf("%")}function z(t){var e,n,i,r,o,a,s,l=" \r\n	",h=[],c=0,u=0,d=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===e.substr(0,1)&&(r=e.indexOf("-",1)+1)>0&&(i=e.substr(0,r),e=e.substr(r)),h.push({prefix:i,method:e.toLowerCase(),value:o,args:s,image:null})),s=[],e=i=n=o=""};return s=[],e=i=n=o="",t.split("").forEach(function(t){if(!(0===c&&l.indexOf(t)>-1)){switch(t){case'"':a?a===t&&(a=null):a=t;break;case"(":if(a)break;if(0===c)return c=1,void(o+=t);u++;break;case")":if(a)break;if(1===c){if(0===u)return c=0,o+=t,void d();u--}break;case",":if(a)break;if(0===c)return void d();if(1===c&&0===u&&!e.match(/^url$/i))return s.push(n),n="",void(o+=t)}o+=t,0===c?e+=t:n+=t}}),d(),h}function B(t){return t.replace("px","")}function j(t){return parseFloat(t)}function H(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}}function W(t){var e=t.offsetParent?W(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}}function G(t,e,n,i,r){P("Starting NodeParser"),this.renderer=e,this.options=r,this.range=null,this.support=n,this.renderQueue=[],this.stack=new $t(!0,1,t.ownerDocument,null);var o=new I(t,null);if(r.background&&e.rectangle(0,0,e.width,e.height,new k(r.background)),t===t.ownerDocument.documentElement){var a=new I(o.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,a.color("backgroundColor"))}o.visibile=o.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=_t([o].concat(this.getChildren(o)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new E,P("Fetched nodes, total:",this.nodes.length),P("Calculate overflow clips"),this.calculateOverflowClips(),P("Start fetching images"),this.images=i.fetch(this.nodes.filter(pt)),this.ready=this.images.ready.then(bt(function(){return P("Images loaded, starting parsing"),P("Creating stacking contexts"),this.createStackingContexts(),P("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),P("Render queue created with "+this.renderQueue.length+" items"),new Promise(bt(function(t){r.async?"function"==typeof r.async?r.async.call(this,this.renderQueue,t):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())},this))},this))}function U(t){return t.parent&&t.parent.clip.length}function q(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function V(){}function X(t,e,n,i){return t.map(function(r,o){if(r.width>0){var a=e.left,s=e.top,l=e.width,h=e.height-t[2].width;switch(o){case 0:h=t[0].width,r.args=K({c1:[a,s],c2:[a+l,s],c3:[a+l-t[1].width,s+h],c4:[a+t[3].width,s+h]},i[0],i[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=e.left+e.width-t[1].width,l=t[1].width,r.args=K({c1:[a+l,s],c2:[a+l,s+h+t[2].width],c3:[a,s+h],c4:[a,s+t[0].width]},i[1],i[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+e.height-t[2].width,h=t[2].width,r.args=K({c1:[a+l,s+h],c2:[a,s+h],c3:[a+t[3].width,s],c4:[a+l-t[3].width,s]},i[2],i[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:l=t[3].width,r.args=K({c1:[a,s+h+t[2].width],c2:[a,s],c3:[a+l,s+t[0].width],c4:[a+l,s+h]},i[3],i[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return r})}function Y(t,e,n,i){var r=4*((Math.sqrt(2)-1)/3),o=n*r,a=i*r,s=t+n,l=e+i;return{topLeft:Q({x:t,y:l},{x:t,y:l-a},{x:s-o,y:e},{x:s,y:e}),topRight:Q({x:t,y:e},{x:t+o,y:e},{x:s,y:l-a},{x:s,y:l}),bottomRight:Q({x:s,y:e},{x:s,y:e+a},{x:t+o,y:l},{x:t,y:l}),bottomLeft:Q({x:s,y:l},{x:s-o,y:l},{x:t,y:e+a},{x:t,y:e})}}function J(t,e,n){var i=t.left,r=t.top,o=t.width,a=t.height,s=e[0][0],l=e[0][1],h=e[1][0],c=e[1][1],u=e[2][0],d=e[2][1],f=e[3][0],p=e[3][1],g=o-h,m=a-d,v=o-u,y=a-p;return{topLeftOuter:Y(i,r,s,l).topLeft.subdivide(.5),topLeftInner:Y(i+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,l-n[0].width)).topLeft.subdivide(.5),topRightOuter:Y(i+g,r,h,c).topRight.subdivide(.5),topRightInner:Y(i+Math.min(g,o+n[3].width),r+n[0].width,g>o+n[3].width?0:h-n[3].width,c-n[0].width).topRight.subdivide(.5),bottomRightOuter:Y(i+v,r+m,u,d).bottomRight.subdivide(.5),bottomRightInner:Y(i+Math.min(v,o-n[3].width),r+Math.min(m,a+n[0].width),Math.max(0,u-n[1].width),d-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:Y(i,r+y,f,p).bottomLeft.subdivide(.5),bottomLeftInner:Y(i+n[3].width,r+y,Math.max(0,f-n[3].width),p-n[2].width).bottomLeft.subdivide(.5)}}function Q(t,e,n,i){var r=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:i,subdivide:function(o){var a=r(t,e,o),s=r(e,n,o),l=r(n,i,o),h=r(a,s,o),c=r(s,l,o),u=r(h,c,o);return[Q(t,a,h,u),Q(u,c,l,i)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function K(t,e,n,i,r,o,a){var s=[];return e[0]>0||e[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function Z(t,e,n,i,r,o,a){e[0]>0||e[1]>0?(t.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(t),i[1].curveTo(t)):t.push(["line",o,a]),(n[0]>0||n[1]>0)&&t.push(["line",r[0].start.x,r[0].start.y])}function tt(t){return t.cssInt("zIndex")<0}function et(t){return t.cssInt("zIndex")>0}function nt(t){return 0===t.cssInt("zIndex")}function it(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function rt(t){return t instanceof $t}function ot(t){return t.node.data.trim().length>0}function at(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}function st(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){var n=t.css("border"+e+"Radius"),i=n.split(" ");return i.length<=1&&(i[1]=i[0]),i.map(wt)})}function lt(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function ht(t){var e=t.css("position"),n=-1!==["absolute","relative","fixed"].indexOf(e)?t.css("zIndex"):"auto";return"auto"!==n}function ct(t){return"static"!==t.css("position")}function ut(t){return"none"!==t.css("float")}function dt(t){return-1!==["inline-block","inline-table"].indexOf(t.css("display"))}function ft(t){var e=this;return function(){return!t.apply(e,arguments)}}function pt(t){return t.node.nodeType===Node.ELEMENT_NODE}function gt(t){return t.isPseudoElement===!0}function mt(t){return t.node.nodeType===Node.TEXT_NODE}function vt(t){return function(e,n){return e.cssInt("zIndex")+t.indexOf(e)/t.length-(n.cssInt("zIndex")+t.indexOf(n)/t.length)}}function yt(t){return t.getOpacity()<1}function bt(t,e){return function(){return t.apply(e,arguments)}}function wt(t){return parseInt(t,10)}function xt(t){return t.width}function St(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function _t(t){return[].concat.apply([],t)}function Ct(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}function kt(e){for(var n,i=[],r=0,o=!1;e.length;)Tt(e[r])===o?(n=e.splice(0,r),n.length&&i.push(t.html2canvas.punycode.ucs2.encode(n)),o=!o,r=0):r++,r>=e.length&&(n=e.splice(0,r),n.length&&i.push(t.html2canvas.punycode.ucs2.encode(n)));return i}function Tt(t){return-1!==[32,13,10,9,45].indexOf(t)}function Ft(t){return/[^\u0000-\u00ff]/.test(t)}function Et(t,e,n){if(!e)return Promise.reject("No proxy configured");var i=Nt(re),r=Mt(e,t,i);return re?Gt(r):Dt(n,r,i).then(function(t){return zt(t.content)})}function At(t,e,n){var i=Nt(oe),r=Mt(e,t,i);return oe?Promise.resolve(r):Dt(n,r,i).then(function(t){return"data:"+t.type+";base64,"+t.content})}function Dt(e,n,i){return new Promise(function(r,o){var a=e.createElement("script"),s=function(){delete t.html2canvas.proxy[i],e.body.removeChild(a)};t.html2canvas.proxy[i]=function(t){s(),r(t)},a.src=n,a.onerror=function(t){s(),o(t)},e.body.appendChild(a)})}function Nt(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++ie+"_"+Math.round(1e5*Math.random())}function Mt(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}function Lt(t,n){var i=(e.createElement("script"),e.createElement("a"));i.href=t,t=i.href,this.src=t,this.image=new Image;var r=this;this.promise=new Promise(function(i,o){r.image.crossOrigin="Anonymous",r.image.onload=i,r.image.onerror=o,new At(t,n,e).then(function(t){r.image.src=t})["catch"](o)})}function Pt(t,e,n){I.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}function It(t,e,n,i,r){this.width=t,this.height=e,this.images=n,this.options=i,this.document=r}function $t(t,e,n,i){I.call(this,n,i),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}function Rt(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}function Ot(t){this.src=t,this.image=null;var e=this;this.promise=this.hasFabric().then(function(){return e.isInline(t)?Promise.resolve(e.inlineFormatting(t)):Gt(t)}).then(function(t){return new Promise(function(n){html2canvas.fabric.loadSVGFromString(t,e.createCanvas.call(e,n))})})}function zt(t){var e,n,i,r,o,a,s,l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=t.length,u="";for(e=0;c>e;e+=4)n=h.indexOf(t[e]),i=h.indexOf(t[e+1]),r=h.indexOf(t[e+2]),o=h.indexOf(t[e+3]),a=n<<2|i>>4,s=(15&i)<<4|r>>2,l=(3&r)<<6|o,u+=64===r?String.fromCharCode(a):64===o||-1===o?String.fromCharCode(a,s):String.fromCharCode(a,s,l);return u}function Bt(t,e){this.src=t,this.image=null;var n=this;this.promise=e?new Promise(function(e,i){n.image=new Image,n.image.onload=e,n.image.onerror=i,n.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(t),n.image.complete===!0&&e(n.image)}):this.hasFabric().then(function(){return new Promise(function(e){html2canvas.fabric.parseSVGDocument(t,n.createCanvas.call(n,e))})})}function jt(t,e){I.call(this,t,e)}function Ht(t,e,n){return t.length>0?e+n.toUpperCase():void 0}function Wt(t){D.apply(this,arguments),this.type="linear"===t.args[0]?this.TYPES.LINEAR:this.TYPES.RADIAL}function Gt(t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){200===i.status?e(i.responseText):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}function Ut(t,e){It.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},P("Initialized CanvasRenderer with size",t,"x",e)}function qt(t){return t.length>0}if(function(){function n(t,e){N[E]=t,N[E+1]=e,E+=2,2===E&&T()}function o(t){return"function"==typeof t}function a(){return function(){process.nextTick(c)}}function s(){var t=0,n=new D(c),i=e.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function l(){var t=new MessageChannel;return t.port1.onmessage=c,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(c,1)}}function c(){for(var t=0;E>t;t+=2)N[t](N[t+1]),N[t]=void 0,N[t+1]=void 0;E=0}function u(){}function d(t,e,n,i){try{t.call(e,n,i)}catch(r){return r}}function f(t,e,i){n(function(t){var n=!1,r=d(i,e,function(i){n||(n=!0,e!==i?g(t,i):v(t,i))},function(e){n||(n=!0,y(t,e))});!n&&r&&(n=!0,y(t,r))},t)}function p(t,e){1===e.a?v(t,e.b):2===t.a?y(t,e.b):b(e,void 0,function(e){g(t,e)},function(e){y(t,e)})}function g(t,e){if(t===e)y(t,new TypeError("You cannot resolve a promise with itself"));else if("function"==typeof e||"object"==typeof e&&null!==e)if(e.constructor===t.constructor)p(t,e);else{var n;try{n=e.then}catch(i){M.error=i,n=M}n===M?y(t,M.error):void 0===n?v(t,e):o(n)?f(t,e,n):v(t,e)}else v(t,e)}function m(t){t.f&&t.f(t.b),w(t)}function v(t,e){void 0===t.a&&(t.b=e,t.a=1,0!==t.e.length&&n(w,t))}function y(t,e){void 0===t.a&&(t.a=2,t.b=e,n(m,t))}function b(t,e,i,r){var o=t.e,a=o.length;t.f=null,o[a]=e,o[a+1]=i,o[a+2]=r,0===a&&t.a&&n(w,t)}function w(t){var e=t.e,n=t.a;if(0!==e.length){for(var i,r,o=t.b,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?S(n,i,r,o):r(o);t.e.length=0}}function x(){this.error=null}function S(t,e,n,i){var r,a,s,l,h=o(n);if(h){try{r=n(i)}catch(c){L.error=c,r=L}if(r===L?(l=!0,a=r.error,r=null):s=!0,e===r)return void y(e,new TypeError("A promises callback cannot return that same promise."))}else r=i,s=!0;void 0===e.a&&(h&&s?g(e,r):l?y(e,a):1===t?v(e,r):2===t&&y(e,r))}function _(t,e){try{e(function(e){g(t,e)},function(e){y(t,e)})}catch(n){y(t,n)}}function C(t,e,n,i){this.n=t,this.c=new t(u,i),this.i=n,this.o(e)?(this.m=e,this.d=this.length=e.length,this.l(),0===this.length?v(this.c,this.b):(this.length=this.length||0,this.k(),0===this.d&&v(this.c,this.b))):y(this.c,this.p())}function k(t){if(P++,this.b=this.a=void 0,this.e=[],u!==t){if(!o(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof k))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");_(this,t)}}var T,F=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},E=0,A="undefined"!=typeof t?t:{},D=A.MutationObserver||A.WebKitMutationObserver,A="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,N=Array(1e3);T="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?a():D?s():A?l():h();var M=new x,L=new x;C.prototype.o=function(t){return F(t)},C.prototype.p=function(){return Error("Array Methods must be provided an Array")},C.prototype.l=function(){this.b=Array(this.length)},C.prototype.k=function(){for(var t=this.length,e=this.c,n=this.m,i=0;void 0===e.a&&t>i;i++)this.j(n[i],i)},C.prototype.j=function(t,e){var n=this.n;"object"==typeof t&&null!==t?t.constructor===n&&void 0!==t.a?(t.f=null,this.g(t.a,e,t.b)):this.q(n.resolve(t),e):(this.d--,this.b[e]=this.h(t))},C.prototype.g=function(t,e,n){var i=this.c;void 0===i.a&&(this.d--,this.i&&2===t?y(i,n):this.b[e]=this.h(n)),0===this.d&&v(i,this.b)},C.prototype.h=function(t){return t},C.prototype.q=function(t,e){var n=this;b(t,void 0,function(t){n.g(1,e,t)},function(t){n.g(2,e,t)})};var P=0;k.all=function(t,e){return new C(this,t,!0,e).c},k.race=function(t,e){function n(t){g(r,t)}function i(t){y(r,t)}var r=new this(u,e);if(!F(t))return y(r,new TypeError("You must pass an array to race.")),r;for(var o=t.length,a=0;void 0===r.a&&o>a;a++)b(this.resolve(t[a]),void 0,n,i);return r},k.resolve=function(t,e){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(u,e);return g(n,t),n},k.reject=function(t,e){var n=new this(u,e);return y(n,t),n},k.prototype={constructor:k,then:function(t,e){var i=this.a;if(1===i&&!t||2===i&&!e)return this;var r=new this.constructor(u),o=this.b;if(i){var a=arguments[i-1];n(function(){S(i,r,a,o)})}else b(this,r,t,e);return r},"catch":function(t){return this.then(null,t)}};var I={Promise:k,polyfill:function(){var e;e="undefined"!=typeof i?i:"undefined"!=typeof t&&t.document?t:self,"Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),o(t)}()||(e.Promise=k)}};"function"==typeof r&&r.amd?r("html2canvas",[],function(){return I}):"undefined"!=typeof module&&module.exports?module.exports=I:"undefined"!=typeof this&&(this.ES6Promise=I)}.call(t),t&&t.ES6Promise.polyfill(),"undefined"==typeof e||"function"!=typeof Object.create||"function"!=typeof e.createElement("canvas").getContext)return void((t||module.exports).html2canvas=function(){return Promise.reject("No canvas support")});!function(t){function e(t){throw RangeError(L[t])}function o(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function a(t,e){var n=t.split("@"),i="";n.length>1&&(i=n[0]+"@",t=n[1]);var r=t.split(M),a=o(r,e).join(".");return i+a}function s(t){for(var e,n,i=[],r=0,o=t.length;o>r;)e=t.charCodeAt(r++),e>=55296&&56319>=e&&o>r?(n=t.charCodeAt(r++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--)):i.push(e);return i}function l(t){return o(t,function(t){var e="";return t>65535&&(t-=65536,e+=$(t>>>10&1023|55296),t=56320|1023&t),e+=$(t)}).join("")}function h(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:S}function c(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function u(t,e,n){var i=0;for(t=n?I(t/T):t>>1,t+=I(t/e);t>P*C>>1;i+=S)t=I(t/P);return I(i+(P+1)*t/(t+k))}function d(t){var n,i,r,o,a,s,c,d,f,p,g=[],m=t.length,v=0,y=E,b=F;for(i=t.lastIndexOf(A),0>i&&(i=0),r=0;i>r;++r)t.charCodeAt(r)>=128&&e("not-basic"),g.push(t.charCodeAt(r));for(o=i>0?i+1:0;m>o;){for(a=v,s=1,c=S;o>=m&&e("invalid-input"),d=h(t.charCodeAt(o++)),(d>=S||d>I((x-v)/s))&&e("overflow"),v+=d*s,f=b>=c?_:c>=b+C?C:c-b,!(f>d);c+=S)p=S-f,s>I(x/p)&&e("overflow"),s*=p;n=g.length+1,b=u(v-a,n,0==a),I(v/n)>x-y&&e("overflow"),y+=I(v/n),v%=n,g.splice(v++,0,y)}return l(g)}function f(t){var n,i,r,o,a,l,h,d,f,p,g,m,v,y,b,w=[];for(t=s(t),m=t.length,n=E,i=0,a=F,l=0;m>l;++l)g=t[l],128>g&&w.push($(g));for(r=o=w.length,o&&w.push(A);m>r;){for(h=x,l=0;m>l;++l)g=t[l],g>=n&&h>g&&(h=g);for(v=r+1,h-n>I((x-i)/v)&&e("overflow"),i+=(h-n)*v,n=h,l=0;m>l;++l)if(g=t[l],n>g&&++i>x&&e("overflow"),g==n){for(d=i,f=S;p=a>=f?_:f>=a+C?C:f-a,!(p>d);f+=S)b=d-p,y=S-p,w.push($(c(p+b%y,0))),d=I(b/y);w.push($(c(d,0))),a=u(i,v,r==o),i=0,++r}++i,++n}return w.join("")}function p(t){return a(t,function(t){return D.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return a(t,function(t){return N.test(t)?"xn--"+f(t):t})}var m="object"==typeof n&&n&&!n.nodeType&&n,v="object"==typeof module&&module&&!module.nodeType&&module,y="object"==typeof i&&i;(y.global===y||y.window===y||y.self===y)&&(t=y);var b,w,x=2147483647,S=36,_=1,C=26,k=38,T=700,F=72,E=128,A="-",D=/^xn--/,N=/[^\x20-\x7E]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=S-_,I=Math.floor,$=String.fromCharCode;if(b={version:"1.3.1",ucs2:{decode:s,encode:l},decode:d,encode:f,toASCII:g,toUnicode:p},"function"==typeof r&&"object"==typeof r.amd&&r.amd)r("punycode",[],function(){return b});else if(m&&v)if(module.exports==m)v.exports=b;else for(w in b)b.hasOwnProperty(w)&&(m[w]=b[w]);else t.punycode=b}(this);var Vt="data-html2canvas-node",Xt="data-html2canvas-canvas-clone",Yt=0,Jt=0;t.html2canvas=function(n,i){var r=Jt++;if(i=i||{},i.logging&&(t.html2canvas.logging=!0,t.html2canvas.start=Date.now()),i.async="undefined"==typeof i.async?!0:i.async,i.allowTaint="undefined"==typeof i.allowTaint?!1:i.allowTaint,i.removeContainer="undefined"==typeof i.removeContainer?!0:i.removeContainer,i.javascriptEnabled="undefined"==typeof i.javascriptEnabled?!1:i.javascriptEnabled,i.imageTimeout="undefined"==typeof i.imageTimeout?1e4:i.imageTimeout,i.renderer="function"==typeof i.renderer?i.renderer:Ut,i.strict=!!i.strict,"string"==typeof n){if("string"!=typeof i.proxy)return Promise.reject("Proxy must be used when rendering url");var l=null!=i.width?i.width:t.innerWidth,h=null!=i.height?i.height:t.innerHeight;return y(C(n),i.proxy,e,l,h,i).then(function(t){return s(t.contentWindow.document.documentElement,t,i,l,h)})}var c=(n===o?[e.documentElement]:n.length?n:[n])[0];return c.setAttribute(Vt+r,r),a(c.ownerDocument,i,c.ownerDocument.defaultView.innerWidth,c.ownerDocument.defaultView.innerHeight,r).then(function(t){return"function"==typeof i.onrendered&&(P("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),i.onrendered(t)),t})},t.html2canvas.punycode=this.punycode,t.html2canvas.proxy={},k.prototype.darken=function(t){var e=1-t;return new k([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},k.prototype.isTransparent=function(){return 0===this.a},k.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},k.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),t.length>3&&(this.a=t[3])),Array.isArray(t)};var Qt=/^#([a-f0-9]{3})$/i;k.prototype.hex3=function(t){var e=null;return null!==(e=t.match(Qt))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var Kt=/^#([a-f0-9]{6})$/i;k.prototype.hex6=function(t){var e=null;return null!==(e=t.match(Kt))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var Zt=/^rgb\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3})\)$/;k.prototype.rgb=function(t){var e=null;return null!==(e=t.match(Zt))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var te=/^rgba\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3}) *, *(\d+\.?\d*)\)$/;k.prototype.rgba=function(t){var e=null;return null!==(e=t.match(te))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},k.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},k.prototype.namedColor=function(t){var e=ee[t.toLowerCase()];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t.toLowerCase())return this.r=this.g=this.b=this.a=0,!0;return!!e},k.prototype.isColor=!0;var ee={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],
gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};E.prototype.getMetrics=function(t,e){return this.data[t+"-"+e]===o&&(this.data[t+"-"+e]=new F(t,e)),this.data[t+"-"+e]},A.prototype.proxyLoad=function(t,e,n){var i=this.src;return y(i.src,t,i.ownerDocument,e.width,e.height,n)},D.prototype.TYPES={LINEAR:1,RADIAL:2},M.prototype.findImages=function(t){var e=[];return t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this),e},M.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},M.prototype.addImage=function(t,e){return function(n){n.args.forEach(function(i){this.imageExists(t,i)||(t.splice(0,0,e.call(this,n)),P("Added image #"+t.length,"string"==typeof i?i.substring(0,100):i))},this)}},M.prototype.hasImageBackground=function(t){return"none"!==t.method},M.prototype.loadImage=function(t){if("url"===t.method){var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new N(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(e)||this.options.allowTaint===!0||this.isSVG(e)?new N(e,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new N(e,!0):this.options.proxy?new Lt(e,this.options.proxy):new T(e):new Ot(e)}return"linear-gradient"===t.method?new L(t):"gradient"===t.method?new Wt(t):"svg"===t.method?new Bt(t.args[0],this.support.svg):"IFRAME"===t.method?new A(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new T(t)},M.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||Ot.prototype.isInline(t)},M.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})},M.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},M.prototype.getOrigin=function(t){var n=this.link||(this.link=e.createElement("a"));return n.href=t,n.href=n.href,n.protocol+n.hostname+n.port},M.prototype.getPromise=function(t){return this.timeout(t,this.options.imageTimeout)["catch"](function(){var e=new T(t.src);return e.promise.then(function(e){t.image=e})})},M.prototype.get=function(t){var e=null;return this.images.some(function(n){return(e=n).src===t})?e:null},M.prototype.fetch=function(t){return this.images=t.reduce(bt(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach(function(t,e){t.promise.then(function(){P("Succesfully loaded image #"+(e+1),t)},function(n){P("Failed loading image #"+(e+1),t,n)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),P("Finished searching images"),this},M.prototype.timeout=function(t,e){var n,i=Promise.race([t.promise,new Promise(function(i,r){n=setTimeout(function(){P("Timed out loading image",t),r(t)},e)})]).then(function(t){return clearTimeout(n),t});return i["catch"](function(){clearTimeout(n)}),i},L.prototype=Object.create(D.prototype),L.prototype.stepRegExp=/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/,I.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},I.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},I.prototype.assignStack=function(t){this.stack=t,t.children.push(this)},I.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},I.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},I.prototype.prefixedCss=function(t){var e=["webkit","moz","ms","o"],n=this.css(t);return n===o&&e.some(function(e){return n=this.css(e+t.substr(0,1).toUpperCase()+t.substr(1)),n!==o},this),n===o?null:n},I.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},I.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},I.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new k(this.css(t)))},I.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},I.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},I.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},I.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=z(this.css("backgroundImage")))},I.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");return n=n[e||0]||n[0]||"auto",n=n.trim().split(" "),1===n.length&&(n=[n[0],n[0]]),n},I.prototype.parseBackgroundSize=function(t,e,n){var i,r,o=this.cssList("backgroundSize",n);if(O(o[0]))i=t.width*parseFloat(o[0])/100;else{if(/contain|cover/.test(o[0])){var a=t.width/t.height,s=e.width/e.height;return s>a^"contain"===o[0]?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}i=parseInt(o[0],10)}return r="auto"===o[0]&&"auto"===o[1]?e.height:"auto"===o[1]?i/e.width*e.height:O(o[1])?t.height*parseFloat(o[1])/100:parseInt(o[1],10),"auto"===o[0]&&(i=r/e.height*e.width),{width:i,height:r}},I.prototype.parseBackgroundPosition=function(t,e,n,i){var r,o,a=this.cssList("backgroundPosition",n);return r=O(a[0])?(t.width-(i||e).width)*(parseFloat(a[0])/100):parseInt(a[0],10),o="auto"===a[1]?r/e.width*e.height:O(a[1])?(t.height-(i||e).height)*parseFloat(a[1])/100:parseInt(a[1],10),"auto"===a[0]&&(r=o/e.height*e.width),{left:r,top:o}},I.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},I.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),i=0;n&&i<n.length;i++){var r=n[i].match(this.TEXT_SHADOW_VALUES);e.push({color:new k(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return e},I.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(B).map(j);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},I.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?R(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e?e:[1,0,0,1,0,0]}return this.transformMatrix},I.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?W(this.node):H(this.node))},I.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},I.prototype.getValue=function(){var t=this.node.value||"";return"SELECT"===this.node.tagName?t=$(this.node):"password"===this.node.type&&(t=Array(t.length+1).join("•")),0===t.length?this.node.placeholder||"":t},I.prototype.MATRIX_PROPERTY=/(matrix)\((.+)\)/,I.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,I.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,I.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,G.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(pt(t)){gt(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],n=t.parseClip();n&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=U(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,gt(t)&&t.cleanDOM()}else mt(t)&&(t.clip=U(t)?t.parent.clip:[]);gt(t)||(t.bounds=null)},this)},G.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(bt(function(){this.asyncRenderer(t,e)},this),0)},G.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},G.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},G.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},G.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before"),i=this.getPseudoElement(t,":after");n&&e.push(n),i&&e.push(i)}return _t(e)},G.prototype.getPseudoElement=function(t,n){var i=t.computedStyle(n);if(!i||!i.content||"none"===i.content||"-moz-alt-content"===i.content||"none"===i.display)return null;for(var r=Ct(i.content),o="url"===r.substr(0,3),a=e.createElement(o?"img":"html2canvaspseudoelement"),s=new Pt(a,t,n),l=i.length-1;l>=0;l--){var h=q(i.item(l));a.style[h]=i[h]}if(a.className=Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,o)return a.src=z(r)[0].args[0],[s];var c=e.createTextNode(r);return a.appendChild(c),[s,new jt(c,s)]},G.prototype.getChildren=function(t){return _t([].filter.call(t.node.childNodes,lt).map(function(e){var n=[e.nodeType===Node.TEXT_NODE?new jt(e,t):new I(e,t)].filter(St);return e.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==e.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n},this))},G.prototype.newStackingContext=function(t,e){var n=new $t(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n);var i=e?n.getParentStack(this):n.parent.stack;i.contexts.push(n),t.stack=n},G.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){pt(t)&&(this.isRootElement(t)||yt(t)||ht(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):pt(t)&&(ct(t)&&nt(t)||dt(t)||ut(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)},this)},G.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},G.prototype.isRootElement=function(t){return null===t.parent},G.prototype.sortStackingContexts=function(t){t.contexts.sort(vt(t.contexts.slice(0))),t.contexts.forEach(this.sortStackingContexts,this)},G.prototype.parseTextBounds=function(t){return function(e,n,i){if("none"!==t.parent.css("textDecoration").substr(0,4)||0!==e.trim().length){if(this.support.rangeBounds&&!t.parent.hasTransform()){var r=i.slice(0,n).join("").length;return this.getRangeBounds(t.node,r,e.length)}if(t.node&&"string"==typeof t.node.data){var o=t.node.splitText(e.length),a=this.getWrapperBounds(t.node,t.parent.hasTransform());return t.node=o,a}}else(!this.support.rangeBounds||t.parent.hasTransform())&&(t.node=t.node.splitText(e.length));return{}}},G.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),i=t.parentNode,r=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),i.replaceChild(n,t);var o=e?W(n):H(n);return i.replaceChild(r,n),o},G.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());return i.setStart(t,e),i.setEnd(t,e+n),i.getBoundingClientRect()},G.prototype.parse=function(t){var e=t.contexts.filter(tt),n=t.children.filter(pt),i=n.filter(ft(ut)),r=i.filter(ft(ct)).filter(ft(it)),o=n.filter(ft(ct)).filter(ut),a=i.filter(ft(ct)).filter(it),s=t.contexts.concat(i.filter(ct)).filter(nt),l=t.children.filter(mt).filter(ot),h=t.contexts.filter(et);e.concat(r).concat(o).concat(a).concat(s).concat(l).concat(h).forEach(function(t){this.renderQueue.push(t),rt(t)&&(this.parse(t),this.renderQueue.push(new V))},this)},G.prototype.paint=function(t){try{t instanceof V?this.renderer.ctx.restore():mt(t)?(gt(t.parent)&&t.parent.appendToDOM(),this.paintText(t),gt(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(e){if(P(e),this.options.strict)throw e}},G.prototype.paintNode=function(t){rt(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},G.prototype.paintElement=function(t){var e=t.parseBounds();this.renderer.clip(t.backgroundClip,function(){this.renderer.renderBackground(t,e,t.borders.borders.map(xt))},this),this.renderer.clip(t.clip,function(){this.renderer.renderBorders(t.borders.borders)},this),this.renderer.clip(t.backgroundClip,function(){switch(t.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(t.node);n?this.renderer.renderImage(t,e,t.borders,n):P("Error loading <"+t.node.nodeName+">",t.node);break;case"IMG":var i=this.images.get(t.node.src);i?this.renderer.renderImage(t,e,t.borders,i):P("Error loading <img>",t.node.src);break;case"CANVAS":this.renderer.renderImage(t,e,t.borders,{image:t.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(t)}},this)},G.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),i={width:n-1,height:n-1,top:e.top,left:e.left},r=[3,3],o=[r,r,r,r],a=[1,1,1,1].map(function(t){return{color:new k("#A5A5A5"),width:t}}),s=J(i,o,a);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new k("#DEDEDE")),this.renderer.renderBorders(X(a,i,s,o)),t.node.checked&&(this.renderer.font(new k("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("✔",i.left+n/6,i.top+n-1))},this)},G.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new k("#DEDEDE"),1,new k("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new k("#424242"))},this)},G.prototype.paintFormValue=function(t){var e=t.getValue();if(e.length>0){var n=t.node.ownerDocument,i=n.createElement("html2canvaswrapper"),r=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];r.forEach(function(e){try{i.style[e]=t.css(e)}catch(n){P("html2canvas: Parse: Exception caught in renderFormValue: "+n.message)}});var o=t.parseBounds();i.style.position="fixed",i.style.left=o.left+"px",i.style.top=o.top+"px",i.textContent=e,n.body.appendChild(i),this.paintText(new jt(i.firstChild,t)),n.body.removeChild(i)}},G.prototype.paintText=function(e){e.applyTextTransform();var n=t.html2canvas.punycode.ucs2.decode(e.node.data),i=this.options.letterRendering&&!at(e)||Ft(e.node.data)?n.map(function(e){return t.html2canvas.punycode.ucs2.encode([e])}):kt(n),r=e.parent.fontWeight(),o=e.parent.css("fontSize"),a=e.parent.css("fontFamily"),s=e.parent.parseTextShadows();this.renderer.font(e.parent.color("color"),e.parent.css("fontStyle"),e.parent.css("fontVariant"),r,o,a),s.length?this.renderer.fontShadow(s[0].color,s[0].offsetX,s[0].offsetY,s[0].blur):this.renderer.clearShadow(),this.renderer.clip(e.parent.clip,function(){i.map(this.parseTextBounds(e),this).forEach(function(t,n){t&&(this.renderer.text(i[n],t.left,t.bottom),this.renderTextDecoration(e.parent,t,this.fontMetrics.getMetrics(a,o)))},this)},this)},G.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var ne={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};G.prototype.parseBorders=function(t){var e=t.parseBounds(),n=st(t),i=["Top","Right","Bottom","Left"].map(function(e,n){var i=t.css("border"+e+"Style"),r=t.color("border"+e+"Color");"inset"===i&&r.isBlack()&&(r=new k([255,255,255,r.a]));var o=ne[i]?ne[i][n]:null;return{width:t.cssInt("border"+e+"Width"),color:o?r[o[0]](o[1]):r,args:null}}),r=J(e,n,i);return{clip:this.parseBackgroundClip(t,r,i,n,e),borders:X(i,e,r,n)}},G.prototype.parseBackgroundClip=function(t,e,n,i,r){var o=t.css("backgroundClip"),a=[];switch(o){case"content-box":case"padding-box":Z(a,i[0],i[1],e.topLeftInner,e.topRightInner,r.left+n[3].width,r.top+n[0].width),Z(a,i[1],i[2],e.topRightInner,e.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),Z(a,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),Z(a,i[3],i[0],e.bottomLeftInner,e.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:Z(a,i[0],i[1],e.topLeftOuter,e.topRightOuter,r.left,r.top),Z(a,i[1],i[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top),Z(a,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height),Z(a,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height)}return a};var ie=0,re="withCredentials"in new XMLHttpRequest,oe="crossOrigin"in new Image;Pt.prototype.cloneTo=function(t){Pt.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},Pt.prototype=Object.create(I.prototype),Pt.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},Pt.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},Pt.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",Pt.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",It.prototype.renderImage=function(t,e,n,i){var r=t.cssInt("paddingLeft"),o=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),l=n.borders,h=e.width-(l[1].width+l[3].width+r+a),c=e.height-(l[0].width+l[2].width+o+s);this.drawImage(i,0,0,i.image.width||h,i.image.height||c,e.left+r+l[3].width,e.top+o+l[0].width,h,c)},It.prototype.renderBackground=function(t,e,n){e.height>0&&e.width>0&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},It.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");n.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,n)},It.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},It.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},It.prototype.renderBackgroundImage=function(t,e,n){var i=t.parseBackgroundImages();i.reverse().forEach(function(i,r,o){switch(i.method){case"url":var a=this.images.get(i.args[0]);a?this.renderBackgroundRepeating(t,e,a,o.length-(r+1),n):P("Error loading background-image",i.args[0]);break;case"linear-gradient":case"gradient":var s=this.images.get(i.value);s?this.renderBackgroundGradient(s,e,n):P("Error loading background-image",i.args[0]);break;case"none":break;default:P("Unknown background-image type",i.args[0])}},this)},It.prototype.renderBackgroundRepeating=function(t,e,n,i,r){var o=t.parseBackgroundSize(e,n.image,i),a=t.parseBackgroundPosition(e,n.image,i,o),s=t.parseBackgroundRepeat(i);switch(s){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+r[3],e.top+a.top+r[0],99999,o.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+r[0],o.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+a.top+r[0],o.width,o.height,r);break;default:this.renderBackgroundRepeat(n,a,o,{top:e.top,left:e.left},r[3],r[0])}},$t.prototype=Object.create(I.prototype),$t.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},Rt.prototype.testRangeBounds=function(t){var e,n,i,r,o=!1;return t.createRange&&(e=t.createRange(),e.getBoundingClientRect&&(n=t.createElement("boundtest"),n.style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),i=e.getBoundingClientRect(),r=i.height,123===r&&(o=!0),t.body.removeChild(n))),o},Rt.prototype.testCORS=function(){return"undefined"!=typeof(new Image).crossOrigin},Rt.prototype.testSVG=function(){var t=new Image,n=e.createElement("canvas"),i=n.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(t,0,0),n.toDataURL()}catch(r){return!1}return!0},Ot.prototype.hasFabric=function(){return html2canvas.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},Ot.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},Ot.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},Ot.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},Ot.prototype.createCanvas=function(t){var e=this;return function(n,i){var r=new html2canvas.fabric.StaticCanvas("c");e.image=r.lowerCanvasEl,r.setWidth(i.width).setHeight(i.height).add(html2canvas.fabric.util.groupSVGElements(n,i)).renderAll(),t(r.lowerCanvasEl)}},Ot.prototype.decode64=function(e){return"function"==typeof t.atob?t.atob(e):zt(e)},Bt.prototype=Object.create(Ot.prototype),jt.prototype=Object.create(I.prototype),jt.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},jt.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,Ht);case"uppercase":return e.toUpperCase();default:return e}},Wt.prototype=Object.create(D.prototype),Ut.prototype=Object.create(It.prototype),Ut.prototype.setFillStyle=function(t){return this.ctx.fillStyle="object"==typeof t&&t.isColor?t.toString():t,this.ctx},Ut.prototype.rectangle=function(t,e,n,i,r){this.setFillStyle(r).fillRect(t,e,n,i)},Ut.prototype.circle=function(t,e,n,i){this.setFillStyle(i),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},Ut.prototype.circleStroke=function(t,e,n,i,r,o){this.circle(t,e,n,i),this.ctx.strokeStyle=o.toString(),this.ctx.stroke()},Ut.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},Ut.prototype.taints=function(t){if(null===t.tainted){this.taintCtx.drawImage(t.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),t.tainted=!1}catch(n){this.taintCtx=e.createElement("canvas").getContext("2d"),t.tainted=!0}}return t.tainted},Ut.prototype.drawImage=function(t,e,n,i,r,o,a,s,l){(!this.taints(t)||this.options.allowTaint)&&this.ctx.drawImage(t.image,e,n,i,r,o,a,s,l)},Ut.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(qt).forEach(function(t){this.shape(t).clip()},this),e.call(n),this.ctx.restore()},Ut.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach(function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))},this),this.ctx.closePath(),this.ctx},Ut.prototype.font=function(t,e,n,i,r,o){this.setFillStyle(t).font=[e,n,i,r,o].join(" ").split(",")[0]},Ut.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)},Ut.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},Ut.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},Ut.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},Ut.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},Ut.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},Ut.prototype.backgroundRepeatShape=function(t,e,n,i,r,o,a,s,l){var h=[["line",Math.round(r),Math.round(o)],["line",Math.round(r+a),Math.round(o)],["line",Math.round(r+a),Math.round(s+o)],["line",Math.round(r),Math.round(s+o)]];this.clip([h],function(){this.renderBackgroundRepeat(t,e,n,i,l[3],l[0])},this)},Ut.prototype.renderBackgroundRepeat=function(t,e,n,i,r,o){var a=Math.round(i.left+e.left+r),s=Math.round(i.top+e.top+o);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},Ut.prototype.renderBackgroundGradient=function(t,e){if(t instanceof L){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())}),this.rectangle(e.left,e.top,e.width,e.height,n)}},Ut.prototype.resizeImage=function(t,n){var i=t.image;if(i.width===n.width&&i.height===n.height)return i;var r,o=e.createElement("canvas");return o.width=n.width,o.height=n.height,r=o.getContext("2d"),r.drawImage(i,0,0,i.width,i.height,0,0,n.width,n.height),o}}.call({},"undefined"!=typeof window?window:void 0,"undefined"!=typeof document?document:void 0),define("views/city/help",["backbone","html2canvas"],function(t,e){var n=t.View.extend({id:"modal-help",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-help")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize(),t.screenshotCanvas,html2canvas($("body")[0],{onrendered:function(e){t.screenshotCanvas=e}}).then(function(e){t.$el.find(".modal").modal("show")})}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this.$el.find(".modal").on("shown.bs.modal",function(){t.createScreenshot()}),this},resize:function(){},createScreenshot:function(){var t=this,e=t.$el.find("#screenshotCanvas"),n=t.screenshotCanvas.width/t.screenshotCanvas.height,i=$(e).parent().width();e.attr({width:t.screenshotCanvas.width,height:t.screenshotCanvas.height}).css({width:i,height:i/n});var r=e[0].getContext("2d");r.drawImage(t.screenshotCanvas,0,0)},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/helpers/chats",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({className:"content-inner",events:{"keyup #chats-max .input-block .inputElement":function(t){13!=t.which||t.ctrlKey?(46==t.which||8==t.which||t.ctrlKey&&13==t.which)&&this.inputMulty():this.submit()},"keydown #chats-max .input-block .inputElement":function(t){this.$el.find("#chats-max .input-block").popover("hide"),(46==t.which||8==t.which)&&this.inputMulty()},"click #chats-max .input-block .send-message":"submit","click #chats-mini":"showChat","click #chats-max .bn-close":"hideChat"},initialize:function(t){this.params=t,this.template=this.getTemplate("window-chats");var e=this;this.listenTo(this.params.app.listener,"chat_public",function(t){for(var n in t){var i="public";$(e.element+" .tab-"+i).hasClass("active")||(e.noreadCount[i]++,$(e.element+" .chat-tab-"+i+" .count").text("+"+e.noreadCount[i]))}}),this.listenTo(this.params.app.listener,"chat_alliance",function(t){for(var n in t){var i="alliance";t[n].type==i&&($(e.element+" .tab-"+i).hasClass("active")||(e.noreadCount[i]++,$(e.element+" .chat-tab-"+i+" .count").text("+"+e.noreadCount[i])))}})},inputMulty:function(){var t=this.$el.find("#chats-max .input-block .inputElement"),e=$(t).val(),n=e.split("\n");n.length>1?this.$el.find("#chats-max .input-block").addClass("input-block-multy"):this.$el.find("#chats-max .input-block").removeClass("input-block-multy")},submit:function(){var t=this.$el.find("#chats-max .input-block .inputElement"),e=this.$el.find("#chats-max .input-block .send-message"),n=t.val(),i=this;if(""==n)this.inputError("error.Input is empty");else{var r=this.$el.find("#chats-max .chat-list.active").attr("data-type");e.addClass("send-message-progress"),this.params.addMessage(n,r,{success:function(){t.focus()},error:function(t){i.inputError(t)},done:function(){e.removeClass("send-message-progress")}}),t.val("")}},inputError:function(t){var e="";if(t){if("object"==typeof t)for(var n in t)for(var i in t[n])e+="<div>"+$.t("error."+i)+"</div>"}else e=$.t("error.Server error");this.$el.find("#chats-max .input-block").popover({
placement:"top",html:!0,trigger:"manual",title:$.t("main.Error"),content:e}).popover("show")},render:function(){this.$el.html(this.template({t:$.t,chatsManager:this.params.app.profile.chatsManager}));var t=this;return this.$el.find("#chats-max .chat-list").hide(),this.$el.find("#chats-max .chat-list-public").addClass("active").show(),this.$el.find("#chats-max .room-name-public").addClass("active").show(),_.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this},renderMessage:function(t,e){var n=this,i=$.emoticons.replace($("<div>"+t.message+"</div>").text().replace(/([^>])\n/g,"$1<br/>")),r=n.$el.find("#chats-max")+" .chat-list";if($(r).size()){var o=!1;void 0!==t.system&&(o=!0,i=translate("system.ban_"+t.ban_period,{1:'<a href="'+t.ban_link+'" class="username" target="_blank">'+t.ban_username+"</a>"}),"ban"==t.system);var a=$("<div>"+t.username+"</div>").text(),s=this.convertDate(t.time_send),l='<span class="username">'+a+"</span>";"string"==typeof t.link&&(l='<a href="'+t.link+'" target="_blank" class="username">'+a+"</a>"),$(r).append('<div data-user_id="'+t.user_id+'" class="item'+(void 0!==t.moderator&&t.moderator?" moderator":"")+(o?" system":"")+'"><span class="date">'+s+"</span>"+l+'<span class="message">'+i+"</span></div>");var h=this.element+" .tab-"+e;$(h).scrollTop($(h)[0].scrollHeight)}},resize:function(){this.resizeChat()},resizeChat:function(){var t=this.$el.find("#chats-mini .chat-list .scroll");$(t).scrollTop($(t)[0].scrollHeight)},showChat:function(){var t=this;t.$el.find("#chats-max").show(),t.$el.find("#chats-mini").hide();var e=this.$el.find("#chats-max .messages-block .scroll");$(e).scrollTop($(e)[0].scrollHeight)},hideChat:function(){var t=this;t.$el.find("#chats-max").hide(),t.$el.find("#chats-mini").show()}});return n}),define("views/helpers/menu",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({className:"inner",events:{"click #settingsBtn":function(){this.params.openWindow("settings")},"click #sagaBtn":function(){this.params.app.dispatch("saga","index")},"click #tournamentsBtn":function(){this.params.openWindow("tournaments")},"click #checkedBtn":function(){this.params.openWindow("checked")},"click #friendsBtn":function(){this.params.openWindow("friends")},"click #shopBtn":function(){this.params.openWindow("shop")},"click #chartBtn":function(){this.params.openWindow("chart")},"click #newsBtn":function(){this.params.openWindow("news")},"click #guildBtn":function(){this.params.openWindow("guild")},"click #inventoryBtn":function(){this.params.openWindow("inventory")},"click #giftsBtn":function(){this.params.openWindow("gifts")},"click #questsBtn":function(){this.params.openWindow("quests")},"click #notificationsBtn":function(){this.params.openWindow("notifications")},"click #mailBtn":function(){this.params.openWindow("mail")},"click #profileBtn":function(){this.params.openWindow("profile")},"click #editMapBtn":function(){},"click #changeServerBtn":function(){},"click #raidBtn":function(){this.params.app.dispatch("raid","index")},"click #shipsBtn":function(){this.params.openWindow("ships")},"click #galaxyMapBtn":function(){this.params.app.dispatch("galaxy","index")},"click #systemMapBtn":function(){this.params.app.dispatch("system","index")},"click #planetMapBtn":function(){this.params.app.dispatch("planet","index")},"click #commandCenterBtn":function(){this.params.openWindow("commandCenter")},"click #backBtn":function(){this.params.app.dispatch("city","index")}},initialize:function(t){this.params=t,this.template=this.getTemplate("helper-menu")},render:function(){this.$el.html(this.template({t:$.t,controllerName:this.params.controllerName,chatsManager:this.params.app.profile.chatsManager}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this},resize:function(){},fullscreenToggle:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen()},audioToggle:function(){}});return n}),define("views/helpers/controll",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"systemBtns",className:"system-buttons",events:{"click #logoutBtn":function(){this.params.app.profile.logout(),this.params.app.dispatch("index","index")},"click #fullscreenBtn":"fullscreenToggle","click #audioBtn":"audioToggle","click #helpBtn":function(){this.params.openWindow("help")}},initialize:function(t){this.params=t,this.template=this.getTemplate("helper-controll")},render:function(){this.$el.html(this.template({controllerName:this.params.controllerName,t:$.t}));return _.defer(function(){$('[data-toggle="tooltip"]').tooltip()}),this},fullscreenToggle:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen()},audioToggle:function(){}});return n}),define("views/helpers/topInfo",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({className:"inner",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("helper-topInfo")},render:function(){return this.$el.html(this.template({controllerName:this.params.controllerName,t:$.t})),_.defer(function(){$('[data-toggle="tooltip"]').tooltip()}),this}});return n});var n={};!function(t){"use strict";var e=Math.PI/180;n={version:"0.10.0",stages:[],idCounter:0,ids:{},names:{},shapes:{},listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,showWarnings:!0,Filters:{},isDragging:function(){var t=n.DD;return t?t.isDragging:!1},isDragReady:function(){var t=n.DD;return t?!!t.node:!1},_addId:function(t,e){void 0!==e&&(this.ids[e]=t)},_removeId:function(t){void 0!==t&&delete this.ids[t]},_addName:function(t,e){e&&(this.names[e]||(this.names[e]=[]),this.names[e].push(t))},_removeName:function(t,e){if(t){var n=this.names[t];if(n){for(var i=0;i<n.length;i++){var r=n[i];r._id===e&&n.splice(i,1)}0===n.length&&delete this.names[t]}}},getAngle:function(t){return this.angleDeg?t*e:t},_parseUA:function(t){var e=t.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],i=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),r=!!t.match(/IEMobile/i);return{browser:n[1]||"",version:n[2]||"0",mobile:i,ieMobile:r}},UA:void 0},n.UA=n._parseUA(t.navigator&&t.navigator.userAgent||"")}(this),function(t,e){"use strict";if("object"==typeof exports){var i=e();if(global.window&&global.window.document)n.document=global.window.document,n.window=global.window;else{var r=require("canvas"),o=require("jsdom").jsdom;n.document=o("<!DOCTYPE html><html><head></head><body></body></html>"),n.window=n.document.parentWindow,n.window.Image=r.Image,n._nodeCanvas=r}return n.root=t,void(module.exports=i)}"function"==typeof define&&define.amd&&define("konva",e),n.document=document,n.window=window,n.root=t}(this,function(){"use strict";return n}),function(){"use strict";n.Collection=function(){var t=[].slice.call(arguments),e=t.length,n=0;for(this.length=e;e>n;n++)this[n]=t[n];return this},n.Collection.prototype=[],n.Collection.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},n.Collection.prototype.toArray=function(){var t,e=[],n=this.length;for(t=0;n>t;t++)e.push(this[t]);return e},n.Collection.toCollection=function(t){var e,i=new n.Collection,r=t.length;for(e=0;r>e;e++)i.push(t[e]);return i},n.Collection._mapMethod=function(t){n.Collection.prototype[t]=function(){var e,n=this.length,i=[].slice.call(arguments);for(e=0;n>e;e++)this[e][t].apply(this[e],i);return this}},n.Collection.mapMethods=function(t){var e=t.prototype;for(var i in e)n.Collection._mapMethod(i)},n.Transform=function(t){this.m=t&&t.slice()||[1,0,0,1,0,0]},n.Transform.prototype={copy:function(){return new n.Transform(this.m)},point:function(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}},translate:function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},scale:function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.m[0]*e+this.m[2]*n,r=this.m[1]*e+this.m[3]*n,o=this.m[0]*-n+this.m[2]*e,a=this.m[1]*-n+this.m[3]*e;return this.m[0]=i,this.m[1]=r,this.m[2]=o,this.m[3]=a,this},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},skew:function(t,e){var n=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,o=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=o,this},multiply:function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=o,this.m[5]=a,this},invert:function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,i=-this.m[2]*t,r=this.m[0]*t,o=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=r,this.m[4]=o,this.m[5]=a,this},getMatrix:function(){return this.m},setAbsolutePosition:function(t,e){var n=this.m[0],i=this.m[1],r=this.m[2],o=this.m[3],a=this.m[4],s=this.m[5],l=(n*(e-s)-i*(t-a))/(n*o-i*r),h=(t-a-r*l)/n;return this.translate(h,l)}};var t="2d",e="[object Array]",i="[object Number]",r="[object String]",o=Math.PI/180,a=180/Math.PI,s="#",l="",h="0",c="Konva warning: ",u="Konva error: ",d="rgb(",f={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},p=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;n.Util={_isElement:function(t){return!(!t||1!=t.nodeType)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isObject:function(t){return!!t&&t.constructor===Object},_isArray:function(t){return Object.prototype.toString.call(t)===e},_isNumber:function(t){return Object.prototype.toString.call(t)===i},_isString:function(t){return Object.prototype.toString.call(t)===r},_throttle:function(t,e,n){var i,r,o,a=null,s=0,l=n||{},h=function(){s=l.leading===!1?0:(new Date).getTime(),a=null,o=t.apply(i,r),i=r=null};return function(){var n=(new Date).getTime();s||l.leading!==!1||(s=n);var c=e-(n-s);return i=this,r=arguments,0>=c?(clearTimeout(a),a=null,s=n,o=t.apply(i,r),i=r=null):a||l.trailing===!1||(a=setTimeout(h,c)),o}},_hasMethods:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&this._isFunction(t[e])&&n.push(e);return n.length>0},createCanvasElement:function(){var t=n.document.createElement("canvas");try{t.style=t.style||{}}catch(e){}return t},isBrowser:function(){return"object"!=typeof exports},_isInDocument:function(t){for(;t=t.parentNode;)if(t==n.document)return!0;return!1},_simplifyArray:function(t){var e,i,r=[],o=t.length,a=n.Util;for(e=0;o>e;e++)i=t[e],a._isNumber(i)?i=Math.round(1e3*i)/1e3:a._isString(i)||(i=i.toString()),r.push(i);return r},_getImage:function(e,i){var r,o;if(e)if(this._isElement(e))i(e);else if(this._isString(e))r=new n.window.Image,r.onload=function(){i(r)},r.src=e;else if(e.data){o=n.Util.createCanvasElement(),o.width=e.width,o.height=e.height;var a=o.getContext(t);a.putImageData(e,0,0),this._getImage(o.toDataURL(),i)}else i(null);else i(null)},_getRGBAString:function(t){var e=t.red||0,n=t.green||0,i=t.blue||0,r=t.alpha||1;return["rgba(",e,",",n,",",i,",",r,")"].join(l)},_rgbToHex:function(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb:function(t){t=t.replace(s,l);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor:function(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t=h+t;return s+t},get:function(t,e){return void 0===t?e:t},getRGB:function(t){var e;return t in f?(e=f[t],{r:e[0],g:e[1],b:e[2]}):t[0]===s?this._hexToRgb(t.substring(1)):t.substr(0,4)===d?(e=p.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(t){return t=t||"black",n.Util._namedColorToRBA(t)||n.Util._hex3ColorToRGBA(t)||n.Util._hex6ColorToRGBA(t)||n.Util._rgbColorToRGBA(t)||n.Util._rgbaColorToRGBA(t)},_namedColorToRBA:function(t){var e=f[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA:function(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA:function(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA:function(t){return"#"===t[0]&&7===t.length?{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}:void 0},_hex3ColorToRGBA:function(t){return"#"===t[0]&&4===t.length?{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}:void 0},_merge:function(t,e){var n=this._clone(e);for(var i in t)this._isObject(t[i])?n[i]=this._merge(t[i],n[i]):n[i]=t[i];return n},cloneObject:function(t){var e={};for(var n in t)this._isObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];return e},cloneArray:function(t){return t.slice(0)},_degToRad:function(t){return t*o},_radToDeg:function(t){return t*a},_capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},"throw":function(t){throw new Error(u+t)},error:function(t){console.error(u+t)},warn:function(t){n.root.console&&console.warn&&n.showWarnings&&console.warn(c+t)},extend:function(t,e){function n(){this.constructor=t}n.prototype=e.prototype;var i=t.prototype;t.prototype=new n;for(var r in i)i.hasOwnProperty(r)&&(t.prototype[r]=i[r]);t.__super__=e.prototype,t["super"]=e},addMethods:function(t,e){var n;for(n in e)t.prototype[n]=e[n]},_getControlPoints:function(t,e,n,i,r,o,a){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),l=Math.sqrt(Math.pow(r-n,2)+Math.pow(o-i,2)),h=a*s/(s+l),c=a*l/(s+l),u=n-h*(r-t),d=i-h*(o-e),f=n+c*(r-t),p=i+c*(o-e);return[u,d,f,p]},_expandPoints:function(t,e){var i,r,o=t.length,a=[];for(i=2;o-2>i;i+=2)r=n.Util._getControlPoints(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e),a.push(r[0]),a.push(r[1]),a.push(t[i]),a.push(t[i+1]),a.push(r[2]),a.push(r[3]);return a},_removeLastLetter:function(t){return t.substring(0,t.length-1)},each:function(t,e){for(var n in t)e(n,t[n])},_getProjectionToSegment:function(t,e,n,i,r,o){var a,s,l,h=(t-n)*(t-n)+(e-i)*(e-i);if(0==h)a=t,s=e,l=(r-n)*(r-n)+(o-i)*(o-i);else{var c=((r-t)*(n-t)+(o-e)*(i-e))/h;0>c?(a=t,s=e,l=(t-r)*(t-r)+(e-o)*(e-o)):c>1?(a=n,s=i,l=(n-r)*(n-r)+(i-o)*(i-o)):(a=t+c*(n-t),s=e+c*(i-e),l=(a-r)*(a-r)+(s-o)*(s-o))}return[a,s,l]},_getProjectionToLine:function(t,e,i){var r=n.Util.cloneObject(t),o=Number.MAX_VALUE;return e.forEach(function(a,s){if(i||s!==e.length-1){var l=e[(s+1)%e.length],h=n.Util._getProjectionToSegment(a.x,a.y,l.x,l.y,t.x,t.y),c=h[0],u=h[1],d=h[2];o>d&&(r.x=c,r.y=u,o=d)}}),r},_prepareArrayForTween:function(t,e,i){var r,o=[],a=[];if(t.length>e.length){var s=e;e=t,t=s}for(r=0;r<t.length;r+=2)o.push({x:t[r],y:t[r+1]});for(r=0;r<e.length;r+=2)a.push({x:e[r],y:e[r+1]});var l=[];return a.forEach(function(t){var e=n.Util._getProjectionToLine(t,o,i);l.push(e.x),l.push(e.y)}),l}}}(),function(){"use strict";var t=n.Util.createCanvasElement(),e=t.getContext("2d"),i=function(){var t=n.window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}();n.Canvas=function(t){this.init(t)},n.Canvas.prototype={init:function(t){var e=t||{},r=e.pixelRatio||n.pixelRatio||i;this.pixelRatio=r,this._canvas=n.Util.createCanvasElement(),this._canvas.style.padding=0,this._canvas.style.margin=0,this._canvas.style.border=0,this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top=0,this._canvas.style.left=0},getContext:function(){return this.context},getPixelRatio:function(){return this.pixelRatio},setPixelRatio:function(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)},setWidth:function(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)},setHeight:function(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)},getWidth:function(){return this.width},getHeight:function(){return this.height},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},toDataURL:function(t,e){try{return this._canvas.toDataURL(t,e)}catch(i){try{return this._canvas.toDataURL()}catch(r){return n.Util.warn("Unable to get data URL. "+r.message),""}}}},n.SceneCanvas=function(t){var e=t||{},i=e.width||0,r=e.height||0;n.Canvas.call(this,e),this.context=new n.SceneContext(this),this.setSize(i,r)},n.Util.extend(n.SceneCanvas,n.Canvas),n.HitCanvas=function(t){var e=t||{},i=e.width||0,r=e.height||0;n.Canvas.call(this,e),this.context=new n.HitContext(this),this.setSize(i,r),this.hitCanvas=!0},n.Util.extend(n.HitCanvas,n.Canvas)}(),function(){"use strict";var t=",",e="(",i=")",r="([",o="])",a=";",s="()",l="=",h=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],c=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation"];n.Context=function(t){this.init(t)},n.Context.prototype={init:function(t){this.canvas=t,this._context=t._canvas.getContext("2d"),n.enableTrace&&(this.traceArr=[],this._enableTrace())},fillShape:function(t){t.getFillEnabled()&&this._fill(t)},strokeShape:function(t){t.getStrokeEnabled()&&this._stroke(t)},fillStrokeShape:function(t){var e=t.getFillEnabled();e&&this._fill(t),t.getStrokeEnabled()&&this._stroke(t)},getTrace:function(h){var c,u,d,f,p=this.traceArr,g=p.length,m="";for(c=0;g>c;c++)u=p[c],d=u.method,d?(f=u.args,m+=d,m+=h?s:n.Util._isArray(f[0])?r+f.join(t)+o:e+f.join(t)+i):(m+=u.property,h||(m+=l+u.val)),m+=a;return m},clearTrace:function(){this.traceArr=[]},_trace:function(t){var e,i=this.traceArr;i.push(t),e=i.length,e>=n.traceArrMax&&i.shift()},reset:function(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)},getCanvas:function(){return this.canvas},clear:function(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)},_applyLineCap:function(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)},_applyOpacity:function(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)},_applyLineJoin:function(t){var e=t.getLineJoin();e&&this.setAttr("lineJoin",e)},setAttr:function(t,e){this._context[t]=e},arc:function(){var t=arguments;this._context.arc(t[0],t[1],t[2],t[3],t[4],t[5])},beginPath:function(){this._context.beginPath()},bezierCurveTo:function(){var t=arguments;this._context.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},clearRect:function(){var t=arguments;this._context.clearRect(t[0],t[1],t[2],t[3])},clip:function(){this._context.clip()},closePath:function(){this._context.closePath()},createImageData:function(){var t=arguments;return 2===t.length?this._context.createImageData(t[0],t[1]):1===t.length?this._context.createImageData(t[0]):void 0},createLinearGradient:function(){var t=arguments;return this._context.createLinearGradient(t[0],t[1],t[2],t[3])},createPattern:function(){var t=arguments;return this._context.createPattern(t[0],t[1])},createRadialGradient:function(){var t=arguments;return this._context.createRadialGradient(t[0],t[1],t[2],t[3],t[4],t[5])},drawImage:function(){var t=arguments,e=this._context;3===t.length?e.drawImage(t[0],t[1],t[2]):5===t.length?e.drawImage(t[0],t[1],t[2],t[3],t[4]):9===t.length&&e.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},isPointInPath:function(t,e){return this._context.isPointInPath(t,e)},fill:function(){this._context.fill()},fillRect:function(t,e,n,i){this._context.fillRect(t,e,n,i)},strokeRect:function(t,e,n,i){this._context.strokeRect(t,e,n,i)},fillText:function(){var t=arguments;this._context.fillText(t[0],t[1],t[2])},measureText:function(t){return this._context.measureText(t)},getImageData:function(){var t=arguments;return this._context.getImageData(t[0],t[1],t[2],t[3])},lineTo:function(){var t=arguments;this._context.lineTo(t[0],t[1])},moveTo:function(){var t=arguments;this._context.moveTo(t[0],t[1])},rect:function(){var t=arguments;this._context.rect(t[0],t[1],t[2],t[3])},putImageData:function(){var t=arguments;this._context.putImageData(t[0],t[1],t[2])},quadraticCurveTo:function(){var t=arguments;this._context.quadraticCurveTo(t[0],t[1],t[2],t[3])},restore:function(){this._context.restore()},rotate:function(){var t=arguments;this._context.rotate(t[0])},save:function(){this._context.save()},scale:function(){var t=arguments;this._context.scale(t[0],t[1])},setLineDash:function(){var t=arguments,e=this._context;this._context.setLineDash?e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0])},getLineDash:function(){return this._context.getLineDash()},setTransform:function(){var t=arguments;this._context.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])},stroke:function(){this._context.stroke()},strokeText:function(){var t=arguments;this._context.strokeText(t[0],t[1],t[2])},transform:function(){var t=arguments;this._context.transform(t[0],t[1],t[2],t[3],t[4],t[5])},translate:function(){var t=arguments;this._context.translate(t[0],t[1])},_enableTrace:function(){var t,e,i=this,r=h.length,o=n.Util._simplifyArray,a=this.setAttr,s=function(t){var n,r=i[t];i[t]=function(){return e=o(Array.prototype.slice.call(arguments,0)),n=r.apply(i,arguments),"clearRect"===t&&(e[2]=e[2]/i.canvas.getPixelRatio(),e[3]=e[3]/i.canvas.getPixelRatio()),i._trace({method:t,args:e}),n}};for(t=0;r>t;t++)s(h[t]);i.setAttr=function(){a.apply(i,arguments),i._trace({property:arguments[0],val:arguments[1]})}}},c.forEach(function(t){Object.defineProperty(n.Context.prototype,t,{get:function(){return this._context[t]},set:function(e){this._context[t]=e}})}),n.SceneContext=function(t){n.Context.call(this,t)},n.SceneContext.prototype={_fillColor:function(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)},_fillPattern:function(t){var e=t.getFillPatternX(),i=t.getFillPatternY(),r=t.getFillPatternScale(),o=n.getAngle(t.getFillPatternRotation()),a=t.getFillPatternOffset();(e||i)&&this.translate(e||0,i||0),o&&this.rotate(o),r&&this.scale(r.x,r.y),a&&this.translate(-1*a.x,-1*a.y),this.setAttr("fillStyle",this.createPattern(t.getFillPatternImage(),t.getFillPatternRepeat()||"repeat")),this.fill()},_fillLinearGradient:function(t){var e=t.getFillLinearGradientStartPoint(),n=t.getFillLinearGradientEndPoint(),i=t.getFillLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,n.x,n.y);if(i){for(var o=0;o<i.length;o+=2)r.addColorStop(i[o],i[o+1]);this.setAttr("fillStyle",r),t._fillFunc(this)}},_fillRadialGradient:function(t){for(var e=t.getFillRadialGradientStartPoint(),n=t.getFillRadialGradientEndPoint(),i=t.getFillRadialGradientStartRadius(),r=t.getFillRadialGradientEndRadius(),o=t.getFillRadialGradientColorStops(),a=this.createRadialGradient(e.x,e.y,i,n.x,n.y,r),s=0;s<o.length;s+=2)a.addColorStop(o[s],o[s+1]);this.setAttr("fillStyle",a),this.fill()},_fill:function(t){var e=t.fill(),n=t.getFillPatternImage(),i=t.getFillLinearGradientColorStops(),r=t.getFillRadialGradientColorStops(),o=t.getFillPriority();e&&"color"===o?this._fillColor(t):n&&"pattern"===o?this._fillPattern(t):i&&"linear-gradient"===o?this._fillLinearGradient(t):r&&"radial-gradient"===o?this._fillRadialGradient(t):e?this._fillColor(t):n?this._fillPattern(t):i?this._fillLinearGradient(t):r&&this._fillRadialGradient(t)},_stroke:function(t){var e=t.dash(),i=t.getStrokeScaleEnabled()||t instanceof n.Text;t.hasStroke()&&(i||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(t),e&&t.dashEnabled()&&this.setLineDash(e),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.stroke()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t._strokeFunc(this),i||this.restore())},_applyShadow:function(t){var e=n.Util,i=e.get(t.getShadowRGBA(),"black"),r=e.get(t.getShadowBlur(),5),o=e.get(t.getShadowOffset(),{x:0,y:0}),a=t.getAbsoluteTransform().m,s=a[0],l=a[3];this.setAttr("shadowColor",i),this.setAttr("shadowBlur",r),this.setAttr("shadowOffsetX",o.x*s),this.setAttr("shadowOffsetY",o.y*l)}},n.Util.extend(n.SceneContext,n.Context),n.HitContext=function(t){n.Context.call(this,t)},n.HitContext.prototype={_fill:function(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()},_stroke:function(t){if(t.hasStroke()&&t.strokeHitEnabled()){var e=t.getStrokeScaleEnabled()||t instanceof n.Text;e||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(t),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}},n.Util.extend(n.HitContext,n.Context)}(),function(){"use strict";var t="get",e="set";n.Factory={addGetterSetter:function(t,e,n,i,r){this.addGetter(t,e,n),this.addSetter(t,e,i,r),this.addOverloadedGetterSetter(t,e)},addGetter:function(e,i,r){var o=t+n.Util._capitalize(i);e.prototype[o]=function(){var t=this.attrs[i];return void 0===t?r:t}},addSetter:function(t,i,r,o){var a=e+n.Util._capitalize(i);t.prototype[a]=function(t){return r&&(t=r.call(this,t)),this._setAttr(i,t),o&&o.call(this),this}},addComponentsGetterSetter:function(i,r,o,a,s){var l,h,c=o.length,u=n.Util._capitalize,d=t+u(r),f=e+u(r);i.prototype[d]=function(){var t={};for(l=0;c>l;l++)h=o[l],t[h]=this.getAttr(r+u(h));return t},i.prototype[f]=function(t){var e,n=this.attrs[r];a&&(t=a.call(this,t));for(e in t)t.hasOwnProperty(e)&&this._setAttr(r+u(e),t[e]);return this._fireChangeEvent(r,n,t),s&&s.call(this),this},this.addOverloadedGetterSetter(i,r)},addOverloadedGetterSetter:function(i,r){var o=n.Util._capitalize(r),a=e+o,s=t+o;i.prototype[r]=function(){return arguments.length?(this[a](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter:function(e,i,r,o){var a=t+n.Util._capitalize(i),s=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[a]=function(){n.Util.error(s);var t=this.attrs[i];return void 0===t?r:t},this.addSetter(e,i,o,function(){n.Util.error(s)}),this.addOverloadedGetterSetter(e,i)},backCompat:function(t,e){n.Util.each(e,function(e,i){var r=t.prototype[i];t.prototype[e]=function(){r.apply(this,arguments),n.Util.error(e+" method is deprecated and will be removed soon. Use "+i+" instead")}})},afterSetFilter:function(){
this._filterUpToDate=!1}},n.Validators={RGBComponent:function(t){return t>255?255:0>t?0:Math.round(t)},alphaComponent:function(t){return t>1?1:1e-4>t?1e-4:t}}}(),function(t){"use strict";var e="absoluteOpacity",n="absoluteTransform",i="Change",r="children",o=".",a="",s="get",l="id",h="konva",c="listening",u="mouseenter",d="mouseleave",f="name",p="set",g="Shape",m=" ",v="stage",y="transform",b="Stage",w="visible",x=["id"],S=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(m);t.Node=function(t){this._init(t)},t.Util.addMethods(t.Node,{_init:function(i){var r=this;this._id=t.idCounter++,this.eventListeners={},this.attrs={},this._cache={},this._filterUpToDate=!1,this.setAttrs(i),this.on(S,function(){this._clearCache(y),r._clearSelfAndDescendantCache(n)}),this.on("visibleChange.konva",function(){r._clearSelfAndDescendantCache(w)}),this.on("listeningChange.konva",function(){r._clearSelfAndDescendantCache(c)}),this.on("opacityChange.konva",function(){r._clearSelfAndDescendantCache(e)})},_clearCache:function(t){t?delete this._cache[t]:this._cache={}},_getCache:function(t,e){var n=this._cache[t];return void 0===n&&(this._cache[t]=e.call(this)),this._cache[t]},_clearSelfAndDescendantCache:function(t){this._clearCache(t),this.children&&this.getChildren().each(function(e){e._clearSelfAndDescendantCache(t)})},clearCache:function(){return delete this._cache.canvas,this._filterUpToDate=!1,this},cache:function(e){var n=e||{},i=this.getClientRect(!0),r=n.width||i.width,o=n.height||i.height,a=n.x||i.x,s=n.y||i.y,l=n.offset||0,h=n.drawBorder||!1;if(!r||!o)throw new Error("Width or height of caching configuration equals 0.");r+=2*l,o+=2*l,a-=l,s-=l;var c=new t.SceneCanvas({width:r,height:o}),u=new t.SceneCanvas({width:r,height:o}),d=new t.HitCanvas({pixelRatio:1,width:r,height:o}),f=c.getContext(),p=d.getContext();return d.isCache=!0,this.clearCache(),f.save(),p.save(),f.translate(-a,-s),p.translate(-a,-s),this.drawScene(c,this,!0),this.drawHit(d,this,!0),f.restore(),p.restore(),h&&(f.save(),f.beginPath(),f.rect(0,0,r,o),f.closePath(),f.setAttr("strokeStyle","red"),f.setAttr("lineWidth",5),f.stroke(),f.restore()),this._cache.canvas={scene:c,filter:u,hit:d,x:a,y:s},this},getClientRect:function(){throw new Error('abstract "getClientRect" method call')},_transformedRect:function(t){var e,n,i,r,o=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],a=this.getTransform();return o.forEach(function(t){var o=a.point(t);void 0===e&&(e=i=o.x,n=r=o.y),e=Math.min(e,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x),r=Math.max(r,o.y)}),{x:Math.round(e),y:Math.round(n),width:Math.round(i-e),height:Math.round(r-n)}},_drawCachedSceneCanvas:function(t){t.save(),t._applyOpacity(this),t.translate(this._cache.canvas.x,this._cache.canvas.y);var e=this._getCachedSceneCanvas(),n=e.pixelRatio;t.drawImage(e._canvas,0,0,e.width/n,e.height/n),t.restore()},_drawCachedHitCanvas:function(t){var e=this._cache.canvas,n=e.hit;t.save(),t.translate(this._cache.canvas.x,this._cache.canvas.y),t.drawImage(n._canvas,0,0),t.restore()},_getCachedSceneCanvas:function(){var e,n,i,r,o=this.filters(),a=this._cache.canvas,s=a.scene,l=a.filter,h=l.getContext();if(o){if(!this._filterUpToDate){var c=s.pixelRatio;try{for(e=o.length,h.clear(),h.drawImage(s._canvas,0,0,s.getWidth()/c,s.getHeight()/c),n=h.getImageData(0,0,l.getWidth(),l.getHeight()),i=0;e>i;i++)r=o[i],r.call(this,n),h.putImageData(n,0,0)}catch(u){t.Util.warn("Unable to apply filter. "+u.message)}this._filterUpToDate=!0}return l}return s},on:function(t,e){var n,i,r,s,l,h=t.split(m),c=h.length;for(n=0;c>n;n++)i=h[n],r=i.split(o),s=r[0],l=r[1]||a,this.eventListeners[s]||(this.eventListeners[s]=[]),this.eventListeners[s].push({name:l,handler:e});return this},off:function(t){var e,n,i,r,a,s,l=(t||"").split(m),h=l.length;if(!t)for(n in this.eventListeners)this._off(n);for(e=0;h>e;e++)if(i=l[e],r=i.split(o),a=r[0],s=r[1],a)this.eventListeners[a]&&this._off(a,s);else for(n in this.eventListeners)this._off(n,s);return this},dispatchEvent:function(t){var e={target:this,type:t.type,evt:t};this.fire(t.type,e)},addEventListener:function(t,e){this.on(t,function(t){e.call(this,t.evt)})},removeEventListener:function(t){this.off(t)},remove:function(){var t=this.getParent();return t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),delete this.parent),this._clearSelfAndDescendantCache(v),this._clearSelfAndDescendantCache(n),this._clearSelfAndDescendantCache(w),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(e),this},destroy:function(){t._removeId(this.getId()),t._removeName(this.getName(),this._id),this.remove()},getAttr:function(e){var n=s+t.Util._capitalize(e);return t.Util._isFunction(this[n])?this[n]():this.attrs[e]},getAncestors:function(){for(var e=this.getParent(),n=new t.Collection;e;)n.push(e),e=e.getParent();return n},getAttrs:function(){return this.attrs||{}},setAttrs:function(e){var n,i;if(!e)return this;for(n in e)n!==r&&(i=p+t.Util._capitalize(n),t.Util._isFunction(this[i])?this[i](e[n]):this._setAttr(n,e[n]));return this},isListening:function(){return this._getCache(c,this._isListening)},_isListening:function(){var t=this.getListening(),e=this.getParent();return"inherit"===t?e?e.isListening():!0:t},isVisible:function(){return this._getCache(w,this._isVisible)},_isVisible:function(){var t=this.getVisible(),e=this.getParent();return"inherit"===t?e?e.isVisible():!0:t},shouldDrawHit:function(t){var e=this.getLayer();return t&&t.isCache||e&&e.hitGraphEnabled()&&this.isListening()&&this.isVisible()},show:function(){return this.setVisible(!0),this},hide:function(){return this.setVisible(!1),this},getZIndex:function(){return this.index||0},getAbsoluteZIndex:function(){function t(l){for(e=[],n=l.length,i=0;n>i;i++)r=l[i],s++,r.nodeType!==g&&(e=e.concat(r.getChildren().toArray())),r._id===a._id&&(i=n);e.length>0&&e[0].getDepth()<=o&&t(e)}var e,n,i,r,o=this.getDepth(),a=this,s=0;return a.nodeType!==b&&t(a.getStage().getChildren()),s},getDepth:function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},setPosition:function(t){return this.setX(t.x),this.setY(t.y),this},getPosition:function(){return{x:this.getX(),y:this.getY()}},getAbsolutePosition:function(){var e=this.getAbsoluteTransform().getMatrix(),n=new t.Transform,i=this.offset();return n.m=e.slice(),n.translate(i.x,i.y),n.getTranslation()},setAbsolutePosition:function(t){var e,n=this._clearTransform();return this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,e=this.getAbsoluteTransform(),e.invert(),e.translate(t.x,t.y),t={x:this.attrs.x+e.getTranslation().x,y:this.attrs.y+e.getTranslation().y},this.setPosition({x:t.x,y:t.y}),this._setTransform(n),this},_setTransform:function(t){var e;for(e in t)this.attrs[e]=t[e];this._clearCache(y),this._clearSelfAndDescendantCache(n)},_clearTransform:function(){var t={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(y),this._clearSelfAndDescendantCache(n),t},move:function(t){var e=t.x,n=t.y,i=this.getX(),r=this.getY();return void 0!==e&&(i+=e),void 0!==n&&(r+=n),this.setPosition({x:i,y:r}),this},_eachAncestorReverse:function(t,e){var n,i,r=[],o=this.getParent();if(e&&e._id===this._id)return t(this),!0;for(r.unshift(this);o&&(!e||o._id!==e._id);)r.unshift(o),o=o.parent;for(n=r.length,i=0;n>i;i++)t(r[i])},rotate:function(t){return this.setRotation(this.getRotation()+t),this},moveToTop:function(){if(!this.parent)return t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index;return this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},moveUp:function(){if(!this.parent)return t.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return n-1>e?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1},moveDown:function(){if(!this.parent)return t.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1},moveToBottom:function(){if(!this.parent)return t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1},setZIndex:function(e){if(!this.parent)return t.Util.warn("Node has no parent. zIndex parameter is ignored."),!1;var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this},getAbsoluteOpacity:function(){return this._getCache(e,this._getAbsoluteOpacity)},_getAbsoluteOpacity:function(){var t=this.getOpacity();return this.getParent()&&(t*=this.getParent().getAbsoluteOpacity()),t},moveTo:function(t){return this.getParent()!==t&&(this.remove(),t.add(this)),this},toObject:function(){var e,n,i,r,o={},a=this.getAttrs();o.attrs={};for(e in a)n=a[e],t.Util._isFunction(n)||t.Util._isElement(n)||t.Util._isObject(n)||t.Util._hasMethods(n)||(i=this[e],delete a[e],r=i?i.call(this):null,a[e]=n,r!==n&&(o.attrs[e]=n));return o.className=this.getClassName(),o},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},getLayer:function(){var t=this.getParent();return t?t.getLayer():null},getStage:function(){return this._getCache(v,this._getStage)},_getStage:function(){var t=this.getParent();return t?t.getStage():void 0},fire:function(t,e,n){return n?this._fireAndBubble(t,e||{}):this._fire(t,e||{}),this},getAbsoluteTransform:function(t){return t?this._getAbsoluteTransform(t):this._getCache(n,this._getAbsoluteTransform)},_getAbsoluteTransform:function(e){var n,i,r=new t.Transform;return this._eachAncestorReverse(function(t){n=t.transformsEnabled(),i=t.getTransform(),"all"===n?r.multiply(i):"position"===n&&r.translate(t.x(),t.y())},e),r},getTransform:function(){return this._getCache(y,this._getTransform)},_getTransform:function(){var e=new t.Transform,n=this.getX(),i=this.getY(),r=t.getAngle(this.getRotation()),o=this.getScaleX(),a=this.getScaleY(),s=this.getSkewX(),l=this.getSkewY(),h=this.getOffsetX(),c=this.getOffsetY();return(0!==n||0!==i)&&e.translate(n,i),0!==r&&e.rotate(r),(0!==s||0!==l)&&e.skew(s,l),(1!==o||1!==a)&&e.scale(o,a),(0!==h||0!==c)&&e.translate(-1*h,-1*c),e},clone:function(e){var n,i,r,o,a,s=t.Util.cloneObject(this.attrs);for(var l in x){var c=x[l];delete s[c]}for(n in e)s[n]=e[n];var u=new this.constructor(s);for(n in this.eventListeners)for(i=this.eventListeners[n],r=i.length,o=0;r>o;o++)a=i[o],a.name.indexOf(h)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(a));return u},toDataURL:function(e){e=e||{};var n=e.mimeType||null,i=e.quality||null,r=this.getStage(),o=e.x||0,a=e.y||0,s=e.pixelRatio||1,l=new t.SceneCanvas({width:e.width||this.getWidth()||(r?r.getWidth():0),height:e.height||this.getHeight()||(r?r.getHeight():0),pixelRatio:s}),h=l.getContext();return h.save(),(o||a)&&h.translate(-1*o,-1*a),this.drawScene(l),h.restore(),l.toDataURL(n,i)},toImage:function(e){if(!e||!e.callback)throw"callback required for toImage method config argument";t.Util._getImage(this.toDataURL(e),function(t){e.callback(t)})},setSize:function(t){return this.setWidth(t.width),this.setHeight(t.height),this},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||0},getClassName:function(){return this.className||this.nodeType},getType:function(){return this.nodeType},getDragDistance:function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():t.dragDistance},_get:function(t){return this.className===t||this.nodeType===t?[this]:[]},_off:function(t,e){var n,i,r=this.eventListeners[t];for(n=0;n<r.length;n++)if(i=r[n].name,!("konva"===i&&"konva"!==e||e&&i!==e)){if(r.splice(n,1),0===r.length){delete this.eventListeners[t];break}n--}},_fireChangeEvent:function(t,e,n){this._fire(t+i,{oldVal:e,newVal:n})},setId:function(e){var n=this.getId();return t._removeId(n),t._addId(this,e),this._setAttr(l,e),this},setName:function(e){var n,i,r=(this.getName()||"").split(/\s/g),o=(e||"").split(/\s/g);for(i=0;i<r.length;i++)n=r[i],-1===o.indexOf(n)&&n&&t._removeName(n,this._id);for(i=0;i<o.length;i++)n=o[i],-1===r.indexOf(n)&&n&&t._addName(this,n);return this._setAttr(f,e),this},addName:function(t){if(!this.hasName(t)){var e=this.name(),n=e?e+" "+t:t;this.setName(n)}return this},hasName:function(t){var e=(this.name()||"").split(/\s/g);return-1!==e.indexOf(t)},removeName:function(t){var e=(this.name()||"").split(/\s/g),n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.setName(e.join(" ")))},setAttr:function(e,n){var i=p+t.Util._capitalize(e),r=this[i];return t.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this},_setAttr:function(t,e){var n;void 0!==e&&(n=this.attrs[t],this.attrs[t]=e,this._fireChangeEvent(t,n,e))},_setComponentAttr:function(t,e,n){var i;void 0!==n&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,i,n))},_fireAndBubble:function(t,e,n){var i=!0;if(e&&this.nodeType===g&&(e.target=this),t===u&&n&&(this._id===n._id||this.isAncestorOf&&this.isAncestorOf(n))?i=!1:t===d&&n&&(this._id===n._id||this.isAncestorOf&&this.isAncestorOf(n))&&(i=!1),i){this._fire(t,e);var r=(t===u||t===d)&&(n&&n.isAncestorOf&&n.isAncestorOf(this)||!(!n||!n.isAncestorOf));e&&!e.cancelBubble&&this.parent&&this.parent.isListening()&&!r&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n.parent):this._fireAndBubble.call(this.parent,t,e))}},_fire:function(t,e){var n,i=this.eventListeners[t];if(e.type=t,i)for(n=0;n<i.length;n++)i[n].handler.call(this,e)},draw:function(){return this.drawScene(),this.drawHit(),this}}),t.Node.create=function(e,n){return t.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)},t.Node._createNode=function(e,n){var i,r,o,a=t.Node.prototype.getClassName.call(e),s=e.children;if(n&&(e.attrs.container=n),i=new t[a](e.attrs),s)for(r=s.length,o=0;r>o;o++)i.add(this._createNode(s[o]));return i},t.Factory.addOverloadedGetterSetter(t.Node,"position"),t.Factory.addGetterSetter(t.Node,"x",0),t.Factory.addGetterSetter(t.Node,"y",0),t.Factory.addGetterSetter(t.Node,"opacity",1),t.Factory.addGetter(t.Node,"name"),t.Factory.addOverloadedGetterSetter(t.Node,"name"),t.Factory.addGetter(t.Node,"id"),t.Factory.addOverloadedGetterSetter(t.Node,"id"),t.Factory.addGetterSetter(t.Node,"rotation",0),t.Factory.addComponentsGetterSetter(t.Node,"scale",["x","y"]),t.Factory.addGetterSetter(t.Node,"scaleX",1),t.Factory.addGetterSetter(t.Node,"scaleY",1),t.Factory.addComponentsGetterSetter(t.Node,"skew",["x","y"]),t.Factory.addGetterSetter(t.Node,"skewX",0),t.Factory.addGetterSetter(t.Node,"skewY",0),t.Factory.addComponentsGetterSetter(t.Node,"offset",["x","y"]),t.Factory.addGetterSetter(t.Node,"offsetX",0),t.Factory.addGetterSetter(t.Node,"offsetY",0),t.Factory.addSetter(t.Node,"dragDistance"),t.Factory.addOverloadedGetterSetter(t.Node,"dragDistance"),t.Factory.addSetter(t.Node,"width",0),t.Factory.addOverloadedGetterSetter(t.Node,"width"),t.Factory.addSetter(t.Node,"height",0),t.Factory.addOverloadedGetterSetter(t.Node,"height"),t.Factory.addGetterSetter(t.Node,"listening","inherit"),t.Factory.addGetterSetter(t.Node,"filters",void 0,function(t){return this._filterUpToDate=!1,t}),t.Factory.addGetterSetter(t.Node,"visible","inherit"),t.Factory.addGetterSetter(t.Node,"transformsEnabled","all"),t.Factory.addOverloadedGetterSetter(t.Node,"size"),t.Factory.backCompat(t.Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),t.Collection.mapMethods(t.Node)}(n),function(){"use strict";n.Filters.Grayscale=function(t){var e,n,i=t.data,r=i.length;for(e=0;r>e;e+=4)n=.34*i[e]+.5*i[e+1]+.16*i[e+2],i[e]=n,i[e+1]=n,i[e+2]=n}}(),function(){"use strict";n.Filters.Brighten=function(t){var e,n=255*this.brightness(),i=t.data,r=i.length;for(e=0;r>e;e+=4)i[e]+=n,i[e+1]+=n,i[e+2]+=n},n.Factory.addGetterSetter(n.Node,"brightness",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Invert=function(t){var e,n=t.data,i=n.length;for(e=0;i>e;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]}}(),function(){"use strict";function t(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function e(e,n){var o,a,s,l,h,c,u,d,f,p,g,m,v,y,b,w,x,S,_,C,k,T,F,E,A=e.data,D=e.width,N=e.height,M=n+n+1,L=D-1,P=N-1,I=n+1,$=I*(I+1)/2,R=new t,O=null,z=R,B=null,j=null,H=i[n],W=r[n];for(s=1;M>s;s++)z=z.next=new t,s===I&&(O=z);for(z.next=R,u=c=0,a=0;N>a;a++){for(w=x=S=_=d=f=p=g=0,m=I*(C=A[c]),v=I*(k=A[c+1]),y=I*(T=A[c+2]),b=I*(F=A[c+3]),d+=$*C,f+=$*k,p+=$*T,g+=$*F,z=R,s=0;I>s;s++)z.r=C,z.g=k,z.b=T,z.a=F,z=z.next;for(s=1;I>s;s++)l=c+((s>L?L:s)<<2),d+=(z.r=C=A[l])*(E=I-s),f+=(z.g=k=A[l+1])*E,p+=(z.b=T=A[l+2])*E,g+=(z.a=F=A[l+3])*E,w+=C,x+=k,S+=T,_+=F,z=z.next;for(B=R,j=O,o=0;D>o;o++)A[c+3]=F=g*H>>W,0!==F?(F=255/F,A[c]=(d*H>>W)*F,A[c+1]=(f*H>>W)*F,A[c+2]=(p*H>>W)*F):A[c]=A[c+1]=A[c+2]=0,d-=m,f-=v,p-=y,g-=b,m-=B.r,v-=B.g,y-=B.b,b-=B.a,l=u+((l=o+n+1)<L?l:L)<<2,w+=B.r=A[l],x+=B.g=A[l+1],S+=B.b=A[l+2],_+=B.a=A[l+3],d+=w,f+=x,p+=S,g+=_,B=B.next,m+=C=j.r,v+=k=j.g,y+=T=j.b,b+=F=j.a,w-=C,x-=k,S-=T,_-=F,j=j.next,c+=4;u+=D}for(o=0;D>o;o++){for(x=S=_=w=f=p=g=d=0,c=o<<2,m=I*(C=A[c]),v=I*(k=A[c+1]),y=I*(T=A[c+2]),b=I*(F=A[c+3]),d+=$*C,f+=$*k,p+=$*T,g+=$*F,z=R,s=0;I>s;s++)z.r=C,z.g=k,z.b=T,z.a=F,z=z.next;for(h=D,s=1;n>=s;s++)c=h+o<<2,d+=(z.r=C=A[c])*(E=I-s),f+=(z.g=k=A[c+1])*E,p+=(z.b=T=A[c+2])*E,g+=(z.a=F=A[c+3])*E,w+=C,x+=k,S+=T,_+=F,z=z.next,P>s&&(h+=D);for(c=o,B=R,j=O,a=0;N>a;a++)l=c<<2,A[l+3]=F=g*H>>W,F>0?(F=255/F,A[l]=(d*H>>W)*F,A[l+1]=(f*H>>W)*F,A[l+2]=(p*H>>W)*F):A[l]=A[l+1]=A[l+2]=0,d-=m,f-=v,p-=y,g-=b,m-=B.r,v-=B.g,y-=B.b,b-=B.a,l=o+((l=a+I)<P?l:P)*D<<2,d+=w+=B.r=A[l],f+=x+=B.g=A[l+1],p+=S+=B.b=A[l+2],g+=_+=B.a=A[l+3],B=B.next,m+=C=j.r,v+=k=j.g,y+=T=j.b,b+=F=j.a,w-=C,x-=k,S-=T,_-=F,j=j.next,c+=D}}var i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];n.Filters.Blur=function(t){var n=Math.round(this.blurRadius());n>0&&e(t,n)},n.Factory.addGetterSetter(n.Node,"blurRadius",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";function t(t,e,n){var i=4*(n*t.width+e),r=[];return r.push(t.data[i++],t.data[i++],t.data[i++],t.data[i++]),r}function e(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function i(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function r(n,r){var o=t(n,0,0),a=t(n,n.width-1,0),s=t(n,0,n.height-1),l=t(n,n.width-1,n.height-1),h=r||10;if(e(o,a)<h&&e(a,l)<h&&e(l,s)<h&&e(s,o)<h){for(var c=i([a,o,l,s]),u=[],d=0;d<n.width*n.height;d++){var f=e(c,[n.data[4*d],n.data[4*d+1],n.data[4*d+2]]);u[d]=h>f?0:255}return u}}function o(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function a(t,e,n){for(var i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;n>s;s++)for(var l=0;e>l;l++){for(var h=s*e+l,c=0,u=0;r>u;u++)for(var d=0;r>d;d++){var f=s+u-o,p=l+d-o;if(f>=0&&n>f&&p>=0&&e>p){var g=f*e+p,m=i[u*r+d];c+=t[g]*m}}a[h]=2040===c?255:0}return a}function s(t,e,n){for(var i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;n>s;s++)for(var l=0;e>l;l++){for(var h=s*e+l,c=0,u=0;r>u;u++)for(var d=0;r>d;d++){var f=s+u-o,p=l+d-o;if(f>=0&&n>f&&p>=0&&e>p){var g=f*e+p,m=i[u*r+d];c+=t[g]*m}}a[h]=c>=1020?255:0}return a}function l(t,e,n){for(var i=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],r=Math.round(Math.sqrt(i.length)),o=Math.floor(r/2),a=[],s=0;n>s;s++)for(var l=0;e>l;l++){for(var h=s*e+l,c=0,u=0;r>u;u++)for(var d=0;r>d;d++){var f=s+u-o,p=l+d-o;if(f>=0&&n>f&&p>=0&&e>p){var g=f*e+p,m=i[u*r+d];c+=t[g]*m}}a[h]=c}return a}n.Filters.Mask=function(t){var e=this.threshold(),n=r(t,e);return n&&(n=a(n,t.width,t.height),n=s(n,t.width,t.height),n=l(n,t.width,t.height),o(t,n)),t},n.Factory.addGetterSetter(n.Node,"threshold",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.RGB=function(t){var e,n,i=t.data,r=i.length,o=this.red(),a=this.green(),s=this.blue();for(e=0;r>e;e+=4)n=(.34*i[e]+.5*i[e+1]+.16*i[e+2])/255,i[e]=n*o,i[e+1]=n*a,i[e+2]=n*s,i[e+3]=i[e+3]},n.Factory.addGetterSetter(n.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),n.Factory.addGetterSetter(n.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),n.Factory.addGetterSetter(n.Node,"blue",0,n.Validators.RGBComponent,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.RGBA=function(t){var e,n,i=t.data,r=i.length,o=this.red(),a=this.green(),s=this.blue(),l=this.alpha();for(e=0;r>e;e+=4)n=1-l,i[e]=o*l+i[e]*n,i[e+1]=a*l+i[e+1]*n,i[e+2]=s*l+i[e+2]*n},n.Factory.addGetterSetter(n.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),n.Factory.addGetterSetter(n.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),n.Factory.addGetterSetter(n.Node,"blue",0,n.Validators.RGBComponent,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:0>t?0:t})}(),function(){"use strict";n.Filters.HSV=function(t){var e,n,i,r,o,a=t.data,s=a.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,u=l*h*Math.cos(c*Math.PI/180),d=l*h*Math.sin(c*Math.PI/180),f=.299*l+.701*u+.167*d,p=.587*l-.587*u+.33*d,g=.114*l-.114*u-.497*d,m=.299*l-.299*u-.328*d,v=.587*l+.413*u+.035*d,y=.114*l-.114*u+.293*d,b=.299*l-.3*u+1.25*d,w=.587*l-.586*u-1.05*d,x=.114*l+.886*u-.2*d;for(e=0;s>e;e+=4)n=a[e+0],i=a[e+1],r=a[e+2],o=a[e+3],a[e+0]=f*n+p*i+g*r,a[e+1]=m*n+v*i+y*r,a[e+2]=b*n+w*i+x*r,a[e+3]=o},n.Factory.addGetterSetter(n.Node,"hue",0,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"saturation",0,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"value",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Factory.addGetterSetter(n.Node,"hue",0,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"saturation",0,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"luminance",0,null,n.Factory.afterSetFilter),n.Filters.HSL=function(t){var e,n,i,r,o,a=t.data,s=a.length,l=1,h=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,u=127*this.luminance(),d=l*h*Math.cos(c*Math.PI/180),f=l*h*Math.sin(c*Math.PI/180),p=.299*l+.701*d+.167*f,g=.587*l-.587*d+.33*f,m=.114*l-.114*d-.497*f,v=.299*l-.299*d-.328*f,y=.587*l+.413*d+.035*f,b=.114*l-.114*d+.293*f,w=.299*l-.3*d+1.25*f,x=.587*l-.586*d-1.05*f,S=.114*l+.886*d-.2*f;for(e=0;s>e;e+=4)n=a[e+0],i=a[e+1],r=a[e+2],o=a[e+3],a[e+0]=p*n+g*i+m*r+u,a[e+1]=v*n+y*i+b*r+u,a[e+2]=w*n+x*i+S*r+u,a[e+3]=o}}(),function(){"use strict";n.Filters.Emboss=function(t){var e=10*this.embossStrength(),n=255*this.embossWhiteLevel(),i=this.embossDirection(),r=this.embossBlend(),o=0,a=0,s=t.data,l=t.width,h=t.height,c=4*l,u=h;switch(i){case"top-left":o=-1,a=-1;break;case"top":o=-1,a=0;break;case"top-right":o=-1,a=1;break;case"right":o=0,a=1;break;case"bottom-right":o=1,a=1;break;case"bottom":o=1,a=0;break;case"bottom-left":o=1,a=-1;break;case"left":o=0,a=-1}do{var d=(u-1)*c,f=o;1>u+f&&(f=0),u+f>h&&(f=0);var p=(u-1+f)*l*4,g=l;do{var m=d+4*(g-1),v=a;1>g+v&&(v=0),g+v>l&&(v=0);var y=p+4*(g-1+v),b=s[m]-s[y],w=s[m+1]-s[y+1],x=s[m+2]-s[y+2],S=b,_=S>0?S:-S,C=w>0?w:-w,k=x>0?x:-x;if(C>_&&(S=w),k>_&&(S=x),S*=e,r){var T=s[m]+S,F=s[m+1]+S,E=s[m+2]+S;s[m]=T>255?255:0>T?0:T,s[m+1]=F>255?255:0>F?0:F,s[m+2]=E>255?255:0>E?0:E}else{var A=n-S;0>A?A=0:A>255&&(A=255),s[m]=s[m+1]=s[m+2]=A}}while(--g)}while(--u)},n.Factory.addGetterSetter(n.Node,"embossStrength",.5,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"embossWhiteLevel",.5,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"embossDirection","top-left",null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"embossBlend",!1,null,n.Factory.afterSetFilter)}(),function(){"use strict";function t(t,e,n,i,r){var o,a=n-e,s=r-i;return 0===a?i+s/2:0===s?i:(o=(t-e)/a,o=s*o+i)}n.Filters.Enhance=function(e){var n,i,r,o,a=e.data,s=a.length,l=a[0],h=l,c=a[1],u=c,d=a[2],f=d,p=this.enhance();if(0!==p){for(o=0;s>o;o+=4)n=a[o+0],l>n?l=n:n>h&&(h=n),i=a[o+1],c>i?c=i:i>u&&(u=i),r=a[o+2],d>r?d=r:r>f&&(f=r);h===l&&(h=255,l=0),u===c&&(u=255,c=0),f===d&&(f=255,d=0);var g,m,v,y,b,w,x,S,_;for(p>0?(m=h+p*(255-h),v=l-p*(l-0),b=u+p*(255-u),w=c-p*(c-0),S=f+p*(255-f),_=d-p*(d-0)):(g=.5*(h+l),m=h+p*(h-g),v=l+p*(l-g),y=.5*(u+c),b=u+p*(u-y),w=c+p*(c-y),x=.5*(f+d),S=f+p*(f-x),_=d+p*(d-x)),o=0;s>o;o+=4)a[o+0]=t(a[o+0],l,h,v,m),a[o+1]=t(a[o+1],c,u,w,b),a[o+2]=t(a[o+2],d,f,_,S)}},n.Factory.addGetterSetter(n.Node,"enhance",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Posterize=function(t){var e,n=Math.round(254*this.levels())+1,i=t.data,r=i.length,o=255/n;for(e=0;r>e;e+=1)i[e]=Math.floor(i[e]/o)*o},n.Factory.addGetterSetter(n.Node,"levels",.5,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Noise=function(t){var e,n=255*this.noise(),i=t.data,r=i.length,o=n/2;for(e=0;r>e;e+=4)i[e+0]+=o-2*o*Math.random(),i[e+1]+=o-2*o*Math.random(),i[e+2]+=o-2*o*Math.random()},n.Factory.addGetterSetter(n.Node,"noise",.2,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Pixelate=function(t){var e,n,i,r,o,a,s,l,h,c,u,d,f,p,g=Math.ceil(this.pixelSize()),m=t.width,v=t.height,y=Math.ceil(m/g),b=Math.ceil(v/g);for(t=t.data,d=0;y>d;d+=1)for(f=0;b>f;f+=1){for(r=0,o=0,a=0,s=0,l=d*g,h=l+g,c=f*g,u=c+g,p=0,e=l;h>e;e+=1)if(!(e>=m))for(n=c;u>n;n+=1)n>=v||(i=4*(m*n+e),r+=t[i+0],o+=t[i+1],a+=t[i+2],s+=t[i+3],p+=1);for(r/=p,o/=p,a/=p,e=l;h>e;e+=1)if(!(e>=m))for(n=c;u>n;n+=1)n>=v||(i=4*(m*n+e),t[i+0]=r,t[i+1]=o,t[i+2]=a,t[i+3]=s)}},n.Factory.addGetterSetter(n.Node,"pixelSize",8,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Threshold=function(t){var e,n=255*this.threshold(),i=t.data,r=i.length;for(e=0;r>e;e+=1)i[e]=i[e]<n?0:255},n.Factory.addGetterSetter(n.Node,"threshold",.5,null,n.Factory.afterSetFilter)}(),function(){"use strict";n.Filters.Sepia=function(t){var e,n,i,r,o,a,s,l,h,c=t.data,u=t.width,d=t.height,f=4*u;do{e=(d-1)*f,n=u;do i=e+4*(n-1),r=c[i],o=c[i+1],a=c[i+2],s=.393*r+.769*o+.189*a,l=.349*r+.686*o+.168*a,h=.272*r+.534*o+.131*a,c[i]=s>255?255:s,c[i+1]=l>255?255:l,c[i+2]=h>255?255:h,c[i+3]=c[i+3];while(--n)}while(--d)}}(),function(){"use strict";n.Filters.Solarize=function(t){var e=t.data,n=t.width,i=t.height,r=4*n,o=i;do{var a=(o-1)*r,s=n;do{var l=a+4*(s-1),h=e[l],c=e[l+1],u=e[l+2];h>127&&(h=255-h),c>127&&(c=255-c),u>127&&(u=255-u),e[l]=h,e[l+1]=c,e[l+2]=u}while(--s)}while(--o)}}(),function(){"use strict";var t=function(t,e,n){var i,r,o,a,s=t.data,l=e.data,h=t.width,c=t.height,u=n.polarCenterX||h/2,d=n.polarCenterY||c/2,f=0,p=0,g=0,m=0,v=Math.sqrt(u*u+d*d);r=h-u,o=c-d,a=Math.sqrt(r*r+o*o),v=a>v?a:v;var y,b,w,x,S=c,_=h,C=360/_*Math.PI/180;for(b=0;_>b;b+=1)for(w=Math.sin(b*C),x=Math.cos(b*C),y=0;S>y;y+=1)r=Math.floor(u+v*y/S*x),o=Math.floor(d+v*y/S*w),i=4*(o*h+r),f=s[i+0],p=s[i+1],g=s[i+2],m=s[i+3],i=4*(b+y*h),l[i+0]=f,l[i+1]=p,l[i+2]=g,l[i+3]=m},e=function(t,e,n){var i,r,o,a,s,l,h=t.data,c=e.data,u=t.width,d=t.height,f=n.polarCenterX||u/2,p=n.polarCenterY||d/2,g=0,m=0,v=0,y=0,b=Math.sqrt(f*f+p*p);r=u-f,o=d-p,l=Math.sqrt(r*r+o*o),b=l>b?l:b;var w,x,S,_,C=d,k=u,T=n.polarRotation||0;for(r=0;u>r;r+=1)for(o=0;d>o;o+=1)a=r-f,s=o-p,w=Math.sqrt(a*a+s*s)*C/b,x=(180*Math.atan2(s,a)/Math.PI+360+T)%360,x=x*k/360,S=Math.floor(x),_=Math.floor(w),i=4*(_*u+S),g=h[i+0],m=h[i+1],v=h[i+2],y=h[i+3],i=4*(o*u+r),c[i+0]=g,c[i+1]=m,c[i+2]=v,c[i+3]=y},i=n.Util.createCanvasElement();n.Filters.Kaleidoscope=function(n){var r,o,a,s,l,h,c,u,d,f,p=n.width,g=n.height,m=Math.round(this.kaleidoscopePower()),v=Math.round(this.kaleidoscopeAngle()),y=Math.floor(p*(v%360)/360);if(!(1>m)){i.width=p,i.height=g;var b=i.getContext("2d").getImageData(0,0,p,g);t(n,b,{polarCenterX:p/2,polarCenterY:g/2});for(var w=p/Math.pow(2,m);8>=w;)w=2*w,m-=1;w=Math.ceil(w);var x=w,S=0,_=x,C=1;for(y+w>p&&(S=x,_=0,C=-1),o=0;g>o;o+=1)for(r=S;r!==_;r+=C)a=Math.round(r+y)%p,d=4*(p*o+a),l=b.data[d+0],h=b.data[d+1],c=b.data[d+2],u=b.data[d+3],f=4*(p*o+r),b.data[f+0]=l,b.data[f+1]=h,b.data[f+2]=c,b.data[f+3]=u;for(o=0;g>o;o+=1)for(x=Math.floor(w),s=0;m>s;s+=1){for(r=0;x+1>r;r+=1)d=4*(p*o+r),l=b.data[d+0],h=b.data[d+1],c=b.data[d+2],u=b.data[d+3],f=4*(p*o+2*x-r-1),b.data[f+0]=l,b.data[f+1]=h,b.data[f+2]=c,b.data[f+3]=u;x*=2}e(b,n,{polarRotation:0})}},n.Factory.addGetterSetter(n.Node,"kaleidoscopePower",2,null,n.Factory.afterSetFilter),n.Factory.addGetterSetter(n.Node,"kaleidoscopeAngle",0,null,n.Factory.afterSetFilter)}(),function(){"use strict";function t(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()}n.Container=function(t){this.__init(t)},n.Util.addMethods(n.Container,{__init:function(t){this.children=new n.Collection,n.Node.call(this,t)},getChildren:function(t){if(!t)return this.children;var e=new n.Collection;return this.children.each(function(n){t(n)&&e.push(n)}),e},hasChildren:function(){return this.getChildren().length>0},removeChildren:function(){for(var t,e=n.Collection.toCollection(this.children),i=0;i<e.length;i++)t=e[i],delete t.parent,t.index=0,t.hasChildren()&&t.removeChildren(),t.remove();return e=null,this.children=new n.Collection,this},destroyChildren:function(){for(var t,e=n.Collection.toCollection(this.children),i=0;i<e.length;i++)t=e[i],delete t.parent,t.index=0,t.destroy();return e=null,this.children=new n.Collection,
this},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}if(t.getParent())return t.moveTo(this),this;var i=this.children;return this._validateAdd(t),t.index=i.length,t.parent=this,i.push(t),this._fire("add",{child:t}),n.DD&&t.isDragging()&&n.DD.anim.setLayers(t.getLayer()),this},destroy:function(){this.hasChildren()&&this.destroyChildren(),n.Node.prototype.destroy.call(this)},find:function(e){var i,r,o,a,s,l,h,c=[],u=e.replace(/ /g,"").split(","),d=u.length;for(i=0;d>i;i++)if(o=u[i],t(o)||(n.Util.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),n.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),n.Util.warn("Konva is awesome, right?")),"#"===o.charAt(0))s=this._getNodeById(o.slice(1)),s&&c.push(s);else if("."===o.charAt(0))a=this._getNodesByName(o.slice(1)),c=c.concat(a);else for(l=this.getChildren(),h=l.length,r=0;h>r;r++)c=c.concat(l[r]._get(o));return n.Collection.toCollection(c)},findOne:function(t){return this.find(t)[0]},_getNodeById:function(t){var e=n.ids[t];return void 0!==e&&this.isAncestorOf(e)?e:null},_getNodesByName:function(t){var e=n.names[t]||[];return this._getDescendants(e)},_get:function(t){for(var e=n.Node.prototype._get.call(this,t),i=this.getChildren(),r=i.length,o=0;r>o;o++)e=e.concat(i[o]._get(t));return e},toObject:function(){var t=n.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),i=e.length,r=0;i>r;r++){var o=e[r];t.children.push(o.toObject())}return t},_getDescendants:function(t){for(var e=[],n=t.length,i=0;n>i;i++){var r=t[i];this.isAncestorOf(r)&&e.push(r)}return e},isAncestorOf:function(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1},clone:function(t){var e=n.Node.prototype.clone.call(this,t);return this.getChildren().each(function(t){e.add(t.clone())}),e},getAllIntersections:function(t){var e=[];return this.find("Shape").each(function(n){n.isVisible()&&n.intersects(t)&&e.push(n)}),e},_setChildrenIndices:function(){this.children.each(function(t,e){t.index=e})},drawScene:function(t,e,n){var i=this.getLayer(),r=t||i&&i.getCanvas(),o=r&&r.getContext(),a=this._cache.canvas,s=a&&a.scene;return this.isVisible()&&(!n&&s?(o.save(),i._applyTransform(this,o,e),this._drawCachedSceneCanvas(o),o.restore()):this._drawChildren(r,"drawScene",e,!1,n)),this},drawHit:function(t,e,n){var i=this.getLayer(),r=t||i&&i.hitCanvas,o=r&&r.getContext(),a=this._cache.canvas,s=a&&a.hit;return this.shouldDrawHit(r)&&(i&&i.clearHitCache(),!n&&s?(o.save(),i._applyTransform(this,o,e),this._drawCachedHitCanvas(o),o.restore()):this._drawChildren(r,"drawHit",e)),this},_drawChildren:function(t,e,n,i,r){var o,a,s=this.getLayer(),l=t&&t.getContext(),h=this.getClipWidth(),c=this.getClipHeight(),u=h&&c;u&&s&&(o=this.getClipX(),a=this.getClipY(),l.save(),s._applyTransform(this,l),l.beginPath(),l.rect(o,a,h,c),l.clip(),l.reset()),this.children.each(function(o){o[e](t,n,i,r)}),u&&l.restore()},shouldDrawHit:function(t){var e=this.getLayer(),i=n.DD,r=i&&n.isDragging()&&-1!==n.DD.anim.getLayers().indexOf(e);return t&&t.isCache||e&&e.hitGraphEnabled()&&this.isVisible()&&!r},getClientRect:function(t){var e,n,i,r,o={x:0,y:0,width:0,height:0};return this.children.each(function(t){var o=t.getClientRect();void 0===e?(e=o.x,n=o.y,i=o.x+o.width,r=o.y+o.height):(e=Math.min(e,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x+o.width),r=Math.max(r,o.y+o.height))}),0!==this.children.length&&(o={x:e,y:n,width:i-e,height:r-n}),t?o:this._transformedRect(o)}}),n.Util.extend(n.Container,n.Node),n.Container.prototype.get=n.Container.prototype.find,n.Factory.addComponentsGetterSetter(n.Container,"clip",["x","y","width","height"]),n.Factory.addGetterSetter(n.Container,"clipX"),n.Factory.addGetterSetter(n.Container,"clipY"),n.Factory.addGetterSetter(n.Container,"clipWidth"),n.Factory.addGetterSetter(n.Container,"clipHeight"),n.Collection.mapMethods(n.Container)}(),function(t){"use strict";function e(t){t.fill()}function n(t){t.stroke()}function i(t){t.fill()}function r(t){t.stroke()}function o(){this._clearCache(s)}function a(){this._clearCache(l)}var s="hasShadow",l="shadowRGBA";t.Shape=function(t){this.__init(t)},t.Util.addMethods(t.Shape,{__init:function(s){this.nodeType="Shape",this._fillFunc=e,this._strokeFunc=n,this._fillFuncHit=i,this._strokeFuncHit=r;for(var l,h=t.shapes;l=t.Util.getRandomColor(),!l||l in h;);this.colorKey=l,h[l]=this,t.Node.call(this,s),this.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",o),this.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",a)},hasChildren:function(){return!1},getChildren:function(){return[]},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},hasShadow:function(){return this._getCache(s,this._hasShadow)},_hasShadow:function(){return this.getShadowEnabled()&&0!==this.getShadowOpacity()&&!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY())},getShadowRGBA:function(){return this._getCache(l,this._getShadowRGBA)},_getShadowRGBA:function(){if(this.hasShadow()){var e=t.Util.colorToRGBA(this.shadowColor());return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.getShadowOpacity()||1)+")"}},hasFill:function(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops())},hasStroke:function(){return!!this.stroke()},intersects:function(t){var e,n=this.getStage(),i=n.bufferHitCanvas;return i.getContext().clear(),this.drawScene(i),e=i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0},destroy:function(){t.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey]},_useBufferCanvas:function(t){return!t&&this.perfectDrawEnabled()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage()||this.perfectDrawEnabled()&&this.hasShadow()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage()},getSelfRect:function(){var t=this.getSize();return{x:this._centroid?Math.round(-t.width/2):0,y:this._centroid?Math.round(-t.height/2):0,width:t.width,height:t.height}},getClientRect:function(t){var e=this.getSelfRect(),n=this.hasStroke()&&this.strokeWidth()||0,i=e.width+n,r=e.height+n,o=this.shadowOffsetX(),a=this.shadowOffsetY(),s=i+Math.abs(o),l=r+Math.abs(a),h=this.hasShadow()&&this.shadowBlur()||0,c=s+2*h,u=l+2*h,d=0;Math.round(n/2)!==n/2&&(d=1);var f={width:c+d,height:u+d,x:-Math.round(n/2+h)+Math.min(o,0)+e.x,y:-Math.round(n/2+h)+Math.min(a,0)+e.y};return t?f:this._transformedRect(f)},drawScene:function(t,e,n,i){var r,o,a,s=this.getLayer(),l=t||s.getCanvas(),h=l.getContext(),c=this._cache.canvas,u=this.sceneFunc(),d=this.hasShadow(),f=this.hasStroke();if(!this.isVisible())return this;if(c)return h.save(),s._applyTransform(this,h,e),this._drawCachedSceneCanvas(h),h.restore(),this;if(!u)return this;if(h.save(),this._useBufferCanvas(n)&&!i){if(r=this.getStage(),o=r.bufferCanvas,a=o.getContext(),a.clear(),a.save(),a._applyLineJoin(this),!n)if(s)s._applyTransform(this,a,e);else{var p=this.getAbsoluteTransform(e).getMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}u.call(this,a),a.restore(),d&&!l.hitCanvas?(h.save(),h._applyShadow(this),h._applyOpacity(this),h.drawImage(o._canvas,0,0),h.restore()):(h._applyOpacity(this),h.drawImage(o._canvas,0,0))}else{if(h._applyLineJoin(this),!n)if(s)s._applyTransform(this,h,e);else{var g=this.getAbsoluteTransform(e).getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}d&&f&&!l.hitCanvas?(h.save(),n||h._applyOpacity(this),h._applyShadow(this),u.call(this,h),h.restore(),this.hasFill()&&this.getShadowForStrokeEnabled()&&u.call(this,h)):d&&!l.hitCanvas?(h.save(),n||h._applyOpacity(this),h._applyShadow(this),u.call(this,h),h.restore()):(n||h._applyOpacity(this),u.call(this,h))}return h.restore(),this},drawHit:function(t,e,n){var i=this.getLayer(),r=t||i.hitCanvas,o=r.getContext(),a=this.hitFunc()||this.sceneFunc(),s=this._cache.canvas,l=s&&s.hit;if(!this.shouldDrawHit(r))return this;if(i&&i.clearHitCache(),l)return o.save(),i._applyTransform(this,o,e),this._drawCachedHitCanvas(o),o.restore(),this;if(!a)return this;if(o.save(),o._applyLineJoin(this),!n)if(i)i._applyTransform(this,o,e);else{var h=this.getAbsoluteTransform(e).getMatrix();o.transform(h[0],h[1],h[2],h[3],h[4],h[5])}return a.call(this,o),o.restore(),this},drawHitFromCache:function(e){var n,i,r,o,a,s,l=e||0,h=this._cache.canvas,c=this._getCachedSceneCanvas(),u=h.hit,d=u.getContext(),f=u.getWidth(),p=u.getHeight();d.clear(),d.drawImage(c._canvas,0,0,f,p);try{for(n=d.getImageData(0,0,f,p),i=n.data,r=i.length,o=t.Util._hexToRgb(this.colorKey),a=0;r>a;a+=4)s=i[a+3],s>l?(i[a]=o.r,i[a+1]=o.g,i[a+2]=o.b,i[a+3]=255):i[a+3]=0;d.putImageData(n,0,0)}catch(g){t.Util.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}}),t.Util.extend(t.Shape,t.Node),t.Factory.addGetterSetter(t.Shape,"stroke"),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"strokeAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"strokeWidth",2),t.Factory.addGetterSetter(t.Shape,"strokeHitEnabled",!0),t.Factory.addGetterSetter(t.Shape,"perfectDrawEnabled",!0),t.Factory.addGetterSetter(t.Shape,"shadowForStrokeEnabled",!0),t.Factory.addGetterSetter(t.Shape,"lineJoin"),t.Factory.addGetterSetter(t.Shape,"lineCap"),t.Factory.addGetterSetter(t.Shape,"sceneFunc"),t.Factory.addGetterSetter(t.Shape,"hitFunc"),t.Factory.addGetterSetter(t.Shape,"dash"),t.Factory.addGetterSetter(t.Shape,"shadowColor"),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"shadowAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"shadowBlur"),t.Factory.addGetterSetter(t.Shape,"shadowOpacity"),t.Factory.addComponentsGetterSetter(t.Shape,"shadowOffset",["x","y"]),t.Factory.addGetterSetter(t.Shape,"shadowOffsetX",0),t.Factory.addGetterSetter(t.Shape,"shadowOffsetY",0),t.Factory.addGetterSetter(t.Shape,"fillPatternImage"),t.Factory.addGetterSetter(t.Shape,"fill"),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillRed",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillGreen",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillBlue",0,t.Validators.RGBComponent),t.Factory.addDeprecatedGetterSetter(t.Shape,"fillAlpha",1,t.Validators.alphaComponent),t.Factory.addGetterSetter(t.Shape,"fillPatternX",0),t.Factory.addGetterSetter(t.Shape,"fillPatternY",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientColorStops"),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartRadius",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndRadius",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientColorStops"),t.Factory.addGetterSetter(t.Shape,"fillPatternRepeat","repeat"),t.Factory.addGetterSetter(t.Shape,"fillEnabled",!0),t.Factory.addGetterSetter(t.Shape,"strokeEnabled",!0),t.Factory.addGetterSetter(t.Shape,"shadowEnabled",!0),t.Factory.addGetterSetter(t.Shape,"dashEnabled",!0),t.Factory.addGetterSetter(t.Shape,"strokeScaleEnabled",!0),t.Factory.addGetterSetter(t.Shape,"fillPriority","color"),t.Factory.addComponentsGetterSetter(t.Shape,"fillPatternOffset",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillPatternOffsetX",0),t.Factory.addGetterSetter(t.Shape,"fillPatternOffsetY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillPatternScale",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillPatternScaleX",1),t.Factory.addGetterSetter(t.Shape,"fillPatternScaleY",1),t.Factory.addComponentsGetterSetter(t.Shape,"fillLinearGradientStartPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientStartPointX",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientStartPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillLinearGradientEndPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientEndPointX",0),t.Factory.addGetterSetter(t.Shape,"fillLinearGradientEndPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillRadialGradientStartPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartPointX",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientStartPointY",0),t.Factory.addComponentsGetterSetter(t.Shape,"fillRadialGradientEndPoint",["x","y"]),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndPointX",0),t.Factory.addGetterSetter(t.Shape,"fillRadialGradientEndPointY",0),t.Factory.addGetterSetter(t.Shape,"fillPatternRotation",0),t.Factory.backCompat(t.Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),t.Collection.mapMethods(t.Shape)}(n),function(){"use strict";function t(t,e){t.content.addEventListener(e,function(n){t[R+e](n)},!1)}var e="Stage",i="string",r="px",o="mouseout",a="mouseleave",s="mouseover",l="mouseenter",h="mousemove",c="mousedown",u="mouseup",d="click",f="dblclick",p="touchstart",g="touchend",m="tap",v="dbltap",y="touchmove",b="DOMMouseScroll",w="mousewheel",x="wheel",S="contentMouseout",_="contentMouseover",C="contentMousemove",k="contentMousedown",T="contentMouseup",F="contentClick",E="contentDblclick",A="contentTouchstart",D="contentTouchend",N="contentDbltap",M="contentTouchmove",L="div",P="relative",I="konvajs-content",$=" ",R="_",O="container",z="",B=[c,h,u,o,p,y,g,s,b,w,x],j=B.length;n.Stage=function(t){this.___init(t)},n.Util.addMethods(n.Stage,{___init:function(t){this.nodeType=e,n.Container.call(this,t),this._id=n.idCounter++,this._buildDOM(),this._bindContentEvents(),this._enableNestedTransforms=!1,n.stages.push(this)},_validateAdd:function(t){"Layer"!==t.getType()&&n.Util["throw"]("You may only add layers to the stage.")},setContainer:function(t){if(typeof t===i){var e=t;if(t=n.document.getElementById(t),!t)throw"Can not find container in document with id "+e}return this._setAttr(O,t),this},shouldDrawHit:function(){return!0},draw:function(){return n.Node.prototype.draw.call(this),this},setHeight:function(t){return n.Node.prototype.setHeight.call(this,t),this._resizeDOM(),this},setWidth:function(t){return n.Node.prototype.setWidth.call(this,t),this._resizeDOM(),this},clear:function(){var t,e=this.children,n=e.length;for(t=0;n>t;t++)e[t].clear();return this},clone:function(t){return t||(t={}),t.container=n.document.createElement(L),n.Container.prototype.clone.call(this,t)},destroy:function(){var t=this.content;n.Container.prototype.destroy.call(this),t&&n.Util._isInDocument(t)&&this.getContainer().removeChild(t);var e=n.stages.indexOf(this);e>-1&&n.stages.splice(e,1)},getPointerPosition:function(){return this.pointerPos},getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,r=t.x||0,o=t.y||0,a=new n.SceneCanvas({width:t.width||this.getWidth(),height:t.height||this.getHeight(),pixelRatio:t.pixelRatio}),s=a.getContext()._context,l=this.children;(r||o)&&s.translate(-1*r,-1*o),l.each(function(t){var e=t.getCanvas().getWidth(),n=t.getCanvas().getHeight(),i=t.getCanvas().getPixelRatio();s.drawImage(t.getCanvas()._canvas,0,0,e/i,n/i)});var h=a.toDataURL(e,i);return t.callback&&t.callback(h),h},toImage:function(t){var e=t.callback;t.callback=function(t){n.Util._getImage(t,function(t){e(t)})},this.toDataURL(t)},getIntersection:function(t){var e,n,i=this.getChildren(),r=i.length,o=r-1;for(e=o;e>=0;e--)if(n=i[e].getIntersection(t))return n;return null},_resizeDOM:function(){if(this.content){var t,e,n=this.getWidth(),i=this.getHeight(),o=this.getChildren(),a=o.length;for(this.content.style.width=n+r,this.content.style.height=i+r,this.bufferCanvas.setSize(n,i),this.bufferHitCanvas.setSize(n,i),t=0;a>t;t++)e=o[t],e.setSize(n,i),e.draw()}},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return n.Container.prototype.add.call(this,t),t._setCanvasSize(this.width(),this.height()),t.draw(),this.content.appendChild(t.canvas._canvas),this},getParent:function(){return null},getLayer:function(){return null},getLayers:function(){return this.getChildren()},_bindContentEvents:function(){for(var e=0;j>e;e++)t(this,B[e])},_mouseover:function(t){n.UA.mobile||(this._setPointerPosition(t),this._fire(_,{evt:t}))},_mouseout:function(t){if(!n.UA.mobile){this._setPointerPosition(t);var e=this.targetShape;e&&!n.isDragging()&&(e._fireAndBubble(o,{evt:t}),e._fireAndBubble(a,{evt:t}),this.targetShape=null),this.pointerPos=void 0,this._fire(S,{evt:t})}},_mousemove:function(t){if(n.UA.ieMobile)return this._touchmove(t);if(("undefined"!=typeof t.movementX||"undefined"!=typeof t.movementY)&&0===t.movementY&&0===t.movementX)return null;if(n.UA.mobile)return null;this._setPointerPosition(t);var e;n.isDragging()||(e=this.getIntersection(this.getPointerPosition()),e&&e.isListening()?n.isDragging()||this.targetShape&&this.targetShape._id===e._id?e._fireAndBubble(h,{evt:t}):(this.targetShape&&(this.targetShape._fireAndBubble(o,{evt:t},e),this.targetShape._fireAndBubble(a,{evt:t},e)),e._fireAndBubble(s,{evt:t},this.targetShape),e._fireAndBubble(l,{evt:t},this.targetShape),this.targetShape=e):this.targetShape&&!n.isDragging()&&(this.targetShape._fireAndBubble(o,{evt:t}),this.targetShape._fireAndBubble(a,{evt:t}),this.targetShape=null),this._fire(C,{evt:t})),t.preventDefault&&t.preventDefault()},_mousedown:function(t){if(n.UA.ieMobile)return this._touchstart(t);if(!n.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());n.listenClickTap=!0,e&&e.isListening()&&(this.clickStartShape=e,e._fireAndBubble(c,{evt:t})),this._fire(k,{evt:t})}t.preventDefault&&t.preventDefault()},_mouseup:function(t){if(n.UA.ieMobile)return this._touchend(t);if(!n.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),i=this.clickStartShape,r=!1,o=n.DD;n.inDblClickWindow?(r=!0,n.inDblClickWindow=!1):o&&o.justDragged?o&&(o.justDragged=!1):n.inDblClickWindow=!0,setTimeout(function(){n.inDblClickWindow=!1},n.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(u,{evt:t}),n.listenClickTap&&i&&i._id===e._id&&(e._fireAndBubble(d,{evt:t}),r&&e._fireAndBubble(f,{evt:t}))),this._fire(T,{evt:t}),n.listenClickTap&&(this._fire(F,{evt:t}),r&&this._fire(E,{evt:t})),n.listenClickTap=!1}t.preventDefault&&t.preventDefault()},_touchstart:function(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());n.listenClickTap=!0,e&&e.isListening()&&(this.tapStartShape=e,e._fireAndBubble(p,{evt:t}),e.isListening()&&t.preventDefault&&t.preventDefault()),this._fire(A,{evt:t})},_touchend:function(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),i=!1;n.inDblClickWindow?(i=!0,n.inDblClickWindow=!1):n.inDblClickWindow=!0,setTimeout(function(){n.inDblClickWindow=!1},n.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(g,{evt:t}),n.listenClickTap&&e._id===this.tapStartShape._id&&(e._fireAndBubble(m,{evt:t}),i&&e._fireAndBubble(v,{evt:t})),e.isListening()&&t.preventDefault&&t.preventDefault()),n.listenClickTap&&(this._fire(D,{evt:t}),i&&this._fire(N,{evt:t})),n.listenClickTap=!1},_touchmove:function(t){this._setPointerPosition(t);var e,i=n.DD;n.isDragging()||(e=this.getIntersection(this.getPointerPosition()),e&&e.isListening()&&(e._fireAndBubble(y,{evt:t}),e.isListening()&&t.preventDefault&&t.preventDefault()),this._fire(M,{evt:t})),i&&n.isDragging()&&t.preventDefault()},_DOMMouseScroll:function(t){this._mousewheel(t)},_mousewheel:function(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()&&e._fireAndBubble(w,{evt:t})},_wheel:function(t){this._mousewheel(t)},_setPointerPosition:function(t){var e=this._getContentPosition(),i=null,r=null;if(t=t?t:window.event,void 0!==t.touches){if(t.touches.length>0){var o=t.touches[0];i=o.clientX-e.left,r=o.clientY-e.top}}else e?"mozilla"===n.UA.browser?(i=t.layerX||t.clientX-e.left,r=t.layerY||t.clientY-e.top):(i=t.clientX-e.left,r=t.clientY-e.top):(i=t.offsetX,r=t.offetY);null!==i&&null!==r&&(this.pointerPos={x:i,y:r})},_getContentPosition:function(){var t=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:t.top,left:t.left}},_buildDOM:function(){var t=this.getContainer();if(!t){if(n.Util.isBrowser())throw"Stage has no container. A container is required.";t=n.document.createElement(L)}t.innerHTML=z,this.content=n.document.createElement(L),this.content.style.position=P,this.content.className=I,this.content.setAttribute("role","presentation"),t.appendChild(this.content),this.bufferCanvas=new n.SceneCanvas({pixelRatio:1}),this.bufferHitCanvas=new n.HitCanvas,this._resizeDOM()},_onContent:function(t,e){var n,i,r=t.split($),o=r.length;for(n=0;o>n;n++)i=r[n],this.content.addEventListener(i,e,!1)},cache:function(){n.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.")},clearCache:function(){}}),n.Util.extend(n.Stage,n.Container),n.Factory.addGetter(n.Stage,"container"),n.Factory.addOverloadedGetterSetter(n.Stage,"container")}(),function(){"use strict";n.BaseLayer=function(t){this.___init(t)},n.Util.addMethods(n.BaseLayer,{___init:function(t){this.nodeType="Layer",n.Container.call(this,t)},createPNGStream:function(){return this.canvas._canvas.createPNGStream()},getCanvas:function(){return this.canvas},getHitCanvas:function(){return this.hitCanvas},getContext:function(){return this.getCanvas().getContext()},clear:function(t){return this.getContext().clear(t),this},clearHitCache:function(){this._hitImageData=void 0},setZIndex:function(t){n.Node.prototype.setZIndex.call(this,t);var e=this.getStage();return e&&(e.content.removeChild(this.getCanvas()._canvas),t<e.getChildren().length-1?e.content.insertBefore(this.getCanvas()._canvas,e.getChildren()[t+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas)),this},moveToTop:function(){n.Node.prototype.moveToTop.call(this);var t=this.getStage();t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas))},moveUp:function(){var t=n.Node.prototype.moveUp.call(this);if(t){var e=this.getStage();e&&(e.content.removeChild(this.getCanvas()._canvas),this.index<e.getChildren().length-1?e.content.insertBefore(this.getCanvas()._canvas,e.getChildren()[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas))}},moveDown:function(){if(n.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas)}}},moveToBottom:function(){if(n.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas)}}},getLayer:function(){return this},remove:function(){var t=this.getCanvas()._canvas;return n.Node.prototype.remove.call(this),t&&t.parentNode&&n.Util._isInDocument(t)&&t.parentNode.removeChild(t),this},getStage:function(){return this.parent},setSize:function(t,e){this.canvas.setSize(t,e)},getWidth:function(){return this.parent?this.parent.getWidth():void 0},setWidth:function(){n.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},getHeight:function(){return this.parent?this.parent.getHeight():void 0},setHeight:function(){n.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},_applyTransform:function(t,e,n){var i=t.getAbsoluteTransform(n).getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}}),n.Util.extend(n.BaseLayer,n.Container),n.Factory.addGetterSetter(n.BaseLayer,"clearBeforeDraw",!0),n.Collection.mapMethods(n.BaseLayer)}(),function(){"use strict";var t="#",e="beforeDraw",i="draw",r=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],o=r.length;n.Layer=function(t){this.____init(t)},n.Util.addMethods(n.Layer,{____init:function(t){this.nodeType="Layer",this.canvas=new n.SceneCanvas,this.hitCanvas=new n.HitCanvas({pixelRatio:1}),n.BaseLayer.call(this,t)},_setCanvasSize:function(t,e){this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e)},_validateAdd:function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&n.Util["throw"]("You may only add groups and shapes to a layer.")},getIntersection:function(t){var e,n,i,a;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var s=1,l=!1;;){for(n=0;o>n;n++){if(i=r[n],e=this._getIntersection({x:t.x+i.x*s,y:t.y+i.y*s}),a=e.shape)return a;if(l=!!e.antialiased,!e.antialiased)break}if(!l)return null;s+=1}},_getImageData:function(t,e){var n=this.hitCanvas.width||1,i=this.hitCanvas.height||1,r=Math.round(e)*n+Math.round(t);return this._hitImageData||(this._hitImageData=this.hitCanvas.context.getImageData(0,0,n,i)),[this._hitImageData.data[4*r+0],this._hitImageData.data[4*r+1],this._hitImageData.data[4*r+2],this._hitImageData.data[4*r+3]]},_getIntersection:function(e){var i,r,o=this.hitCanvas.pixelRatio,a=this.hitCanvas.context.getImageData(Math.round(e.x*o),Math.round(e.y*o),1,1).data,s=a[3];return 255===s?(i=n.Util._rgbToHex(a[0],a[1],a[2]),r=n.shapes[t+i],r?{shape:r}:{antialiased:!0}):s>0?{antialiased:!0}:{}},drawScene:function(t,r){var o=this.getLayer(),a=t||o&&o.getCanvas();return this._fire(e,{node:this}),this.getClearBeforeDraw()&&a.getContext().clear(),n.Container.prototype.drawScene.call(this,a,r),this._fire(i,{node:this}),this},drawHit:function(t,e){var i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.getClearBeforeDraw()&&i.getHitCanvas().getContext().clear(),n.Container.prototype.drawHit.call(this,r,e),this.imageData=null,this},clear:function(t){return n.BaseLayer.prototype.clear.call(this,t),this.getHitCanvas().getContext().clear(t),this.imageData=null,this},setVisible:function(t){return n.Node.prototype.setVisible.call(this,t),t?(this.getCanvas()._canvas.style.display="block",this.hitCanvas._canvas.style.display="block"):(this.getCanvas()._canvas.style.display="none",this.hitCanvas._canvas.style.display="none"),this},enableHitGraph:function(){return this.setHitGraphEnabled(!0),this},disableHitGraph:function(){return this.setHitGraphEnabled(!1),this},setSize:function(t,e){n.BaseLayer.prototype.setSize.call(this,t,e),this.hitCanvas.setSize(t,e)}}),n.Util.extend(n.Layer,n.BaseLayer),n.Factory.addGetterSetter(n.Layer,"hitGraphEnabled",!0),n.Collection.mapMethods(n.Layer)}(),function(){"use strict";n.FastLayer=function(t){this.____init(t)},n.Util.addMethods(n.FastLayer,{____init:function(t){this.nodeType="Layer",this.canvas=new n.SceneCanvas,n.BaseLayer.call(this,t)},_validateAdd:function(t){var e=t.getType();"Shape"!==e&&n.Util["throw"]("You may only add shapes to a fast layer.")},_setCanvasSize:function(t,e){this.canvas.setSize(t,e)},hitGraphEnabled:function(){return!1},getIntersection:function(){return null},drawScene:function(t){var e=this.getLayer(),i=t||e&&e.getCanvas();return this.getClearBeforeDraw()&&i.getContext().clear(),n.Container.prototype.drawScene.call(this,i),this},draw:function(){return this.drawScene(),this},setVisible:function(t){return n.Node.prototype.setVisible.call(this,t),t?this.getCanvas()._canvas.style.display="block":this.getCanvas()._canvas.style.display="none",this}}),n.Util.extend(n.FastLayer,n.BaseLayer),n.Collection.mapMethods(n.FastLayer)}(),function(){"use strict";n.Group=function(t){this.___init(t)},n.Util.addMethods(n.Group,{___init:function(t){this.nodeType="Group",n.Container.call(this,t)},_validateAdd:function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&n.Util["throw"]("You may only add groups and shapes to groups.")}}),n.Util.extend(n.Group,n.Container),n.Collection.mapMethods(n.Group)}(),function(t){"use strict";function e(t){setTimeout(t,1e3/60)}function n(){return o.apply(t.root,arguments)}var i=500,r=function(){return t.root.performance&&t.root.performance.now?function(){return t.root.performance.now()}:function(){return(new Date).getTime()}}(),o=function(){return t.root.requestAnimationFrame||t.root.webkitRequestAnimationFrame||t.root.mozRequestAnimationFrame||t.root.oRequestAnimationFrame||t.root.msRequestAnimationFrame||e}();t.Animation=function(e,n){var i=t.Animation;this.func=e,this.setLayers(n),this.id=i.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r()}},t.Animation.prototype={setLayers:function(t){var e=[];return e=t?t.length>0?t:[t]:[],this.layers=e,this},getLayers:function(){return this.layers},addLayer:function(t){var e,n=this.layers,i=n.length;for(e=0;i>e;e++)if(n[e]._id===t._id)return!1;return this.layers.push(t),!0},isRunning:function(){var e,n=t.Animation,i=n.animations,r=i.length;for(e=0;r>e;e++)if(i[e].id===this.id)return!0;return!1},start:function(){var e=t.Animation;return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),e._addAnimation(this),this},stop:function(){return t.Animation._removeAnimation(this),this},_updateFrameObject:function(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}},t.Animation.animations=[],t.Animation.animIdCounter=0,t.Animation.animRunning=!1,t.Animation._addAnimation=function(t){this.animations.push(t),this._handleAnimation()},t.Animation._removeAnimation=function(t){var e,n=t.id,i=this.animations,r=i.length;for(e=0;r>e;e++)if(i[e].id===n){this.animations.splice(e,1);break}},t.Animation._runFrames=function(){var t,e,n,i,o,a,s,l,h,c={},u=this.animations;for(i=0;i<u.length;i++)if(t=u[i],e=t.layers,n=t.func,t._updateFrameObject(r()),a=e.length,h=n?n.call(t,t.frame)!==!1:!0)for(o=0;a>o;o++)s=e[o],void 0!==s._id&&(c[s._id]=s);for(l in c)c.hasOwnProperty(l)&&c[l].draw()},t.Animation._animationLoop=function(){var e=t.Animation;e.animations.length?(n(e._animationLoop),e._runFrames()):e.animRunning=!1},t.Animation._handleAnimation=function(){this.animRunning||(this.animRunning=!0,this._animationLoop())};var a=t.Node.prototype.moveTo;t.Node.prototype.moveTo=function(t){a.call(this,t)},t.BaseLayer.prototype.batchDraw=function(){var e=this,n=t.Animation;return this.batchAnim||(this.batchAnim=new n(function(){e.lastBatchDrawTime&&r()-e.lastBatchDrawTime>i&&e.batchAnim.stop()},this)),this.lastBatchDrawTime=r(),this.batchAnim.isRunning()||(this.draw(),this.batchAnim.start()),this},t.Stage.prototype.batchDraw=function(){return this.getChildren().each(function(t){t.batchDraw()}),this}}(n),function(){"use strict";var t={node:1,duration:1,easing:1,onFinish:1,yoyo:1},e=1,i=2,r=3,o=0,a=["fill","stroke","shadowColor"],s=function(t,e,n,i,r,o,a){this.prop=t,this.propFunc=e,this.begin=i,this._pos=i,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()};s.prototype={fire:function(t){var e=this[t];e&&e()},setTime:function(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():0>t?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())},getTime:function(){return this._time},setPosition:function(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t},getPosition:function(t){
return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)},play:function(){this.state=i,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},reverse:function(){this.state=r,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},seek:function(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")},reset:function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},finish:function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},update:function(){this.setPosition(this.getPosition(this._time))},onEnterFrame:function(){var t=this.getTimer()-this._startTime;this.state===i?this.setTime(t):this.state===r&&this.setTime(this.duration-t)},pause:function(){this.state=e,this.fire("onPause")},getTimer:function(){return(new Date).getTime()}},n.Tween=function(e){var i,r,a=this,l=e.node,h=l._id,c=e.easing||n.Easings.Linear,u=!!e.yoyo;i="undefined"==typeof e.duration?1:0===e.duration?.001:e.duration,this.node=l,this._id=o++,this.anim=new n.Animation(function(){a.tween.onEnterFrame()},l.getLayer()||(l instanceof n.Stage?l.getLayers():null)),this.tween=new s(r,function(t){a._tweenFunc(t)},c,0,1,1e3*i,u),this._addListeners(),n.Tween.attrs[h]||(n.Tween.attrs[h]={}),n.Tween.attrs[h][this._id]||(n.Tween.attrs[h][this._id]={}),n.Tween.tweens[h]||(n.Tween.tweens[h]={});for(r in e)void 0===t[r]&&this._addAttr(r,e[r]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset},n.Tween.attrs={},n.Tween.tweens={},n.Tween.prototype={_addAttr:function(t,e){var i,r,o,s,l,h,c,u=this.node,d=u._id;if(o=n.Tween.tweens[d][t],o&&delete n.Tween.attrs[d][o][t],i=u.getAttr(t),n.Util._isArray(e))for(r=[],l=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(c=i,i=n.Util._prepareArrayForTween(i,e,u.closed())):(h=e,e=n.Util._prepareArrayForTween(e,i,u.closed()))),s=0;l>s;s++)r.push(e[s]-i[s]);else if(-1!==a.indexOf(t)){i=n.Util.colorToRGBA(i);var f=n.Util.colorToRGBA(e);r={r:f.r-i.r,g:f.g-i.g,b:f.b-i.b,a:f.a-i.a}}else r=e-i;n.Tween.attrs[d][this._id][t]={start:i,diff:r,end:e,trueEnd:h,trueStart:c},n.Tween.tweens[d][t]=this._id},_tweenFunc:function(t){var e,i,r,o,s,l,h,c,u=this.node,d=n.Tween.attrs[u._id][this._id];for(e in d){if(i=d[e],r=i.start,o=i.diff,c=i.end,n.Util._isArray(r))for(s=[],h=Math.max(r.length,c.length),l=0;h>l;l++)s.push((r[l]||0)+o[l]*t);else s=-1!==a.indexOf(e)?"rgba("+Math.round(r.r+o.r*t)+","+Math.round(r.g+o.g*t)+","+Math.round(r.b+o.b*t)+","+(r.a+o.a*t)+")":r+o*t;u.setAttr(e,s)}},_addListeners:function(){var t=this;this.tween.onPlay=function(){t.anim.start()},this.tween.onReverse=function(){t.anim.start()},this.tween.onPause=function(){t.anim.stop()},this.tween.onFinish=function(){var e=t.node,i=n.Tween.attrs[e._id][t._id];i.points&&i.points.trueEnd&&e.points(i.points.trueEnd),t.onFinish&&t.onFinish.call(t)},this.tween.onReset=function(){var e=t.node,i=n.Tween.attrs[e._id][t._id];i.points&&i.points.trueStart&&e.points(i.points.trueStart),t.onReset&&t.onReset()}},play:function(){return this.tween.play(),this},reverse:function(){return this.tween.reverse(),this},reset:function(){return this.tween.reset(),this},seek:function(t){return this.tween.seek(1e3*t),this},pause:function(){return this.tween.pause(),this},finish:function(){return this.tween.finish(),this},destroy:function(){var t,e=this.node._id,i=this._id,r=n.Tween.tweens[e];this.pause();for(t in r)delete n.Tween.tweens[e][t];delete n.Tween.attrs[e][i]}},n.Node.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()};var i=new n.Tween(t);i.play()},n.Easings={BackEaseIn:function(t,e,n,i){var r=1.70158;return n*(t/=i)*t*((r+1)*t-r)+e},BackEaseOut:function(t,e,n,i){var r=1.70158;return n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut:function(t,e,n,i){var r=1.70158;return(t/=i/2)<1?n/2*t*t*(((r*=1.525)+1)*t-r)+e:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},ElasticEaseIn:function(t,e,n,i,r,o){var a=0;return 0===t?e:1===(t/=i)?e+n:(o||(o=.3*i),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o))+e)},ElasticEaseOut:function(t,e,n,i,r,o){var a=0;return 0===t?e:1===(t/=i)?e+n:(o||(o=.3*i),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*t)*Math.sin(2*(t*i-a)*Math.PI/o)+n+e)},ElasticEaseInOut:function(t,e,n,i,r,o){var a=0;return 0===t?e:2===(t/=i/2)?e+n:(o||(o=.3*i*1.5),!r||r<Math.abs(n)?(r=n,a=o/4):a=o/(2*Math.PI)*Math.asin(n/r),1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o)+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-a)*Math.PI/o)*.5+n+e)},BounceEaseOut:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn:function(t,e,i,r){return i-n.Easings.BounceEaseOut(r-t,0,i,r)+e},BounceEaseInOut:function(t,e,i,r){return r/2>t?.5*n.Easings.BounceEaseIn(2*t,0,i,r)+e:.5*n.Easings.BounceEaseOut(2*t-r,0,i,r)+.5*i+e},EaseIn:function(t,e,n,i){return n*(t/=i)*t+e},EaseOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},EaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},StrongEaseIn:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},StrongEaseOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},StrongEaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},Linear:function(t,e,n,i){return n*t/i+e}}}(),function(){"use strict";n.DD={anim:new n.Animation(function(){var t=this.dirty;return this.dirty=!1,t}),isDragging:!1,justDragged:!1,offset:{x:0,y:0},node:null,_drag:function(t){var e=n.DD,i=e.node;if(i){if(!e.isDragging){var r=i.getStage().getPointerPosition(),o=i.dragDistance(),a=Math.max(Math.abs(r.x-e.startPointerPos.x),Math.abs(r.y-e.startPointerPos.y));if(o>a)return}i.getStage()._setPointerPosition(t),i._setDragPosition(t),e.isDragging||(e.isDragging=!0,i.fire("dragstart",{type:"dragstart",target:i,evt:t},!0)),i.fire("dragmove",{type:"dragmove",target:i,evt:t},!0)}},_endDragBefore:function(t){var e,i=n.DD,r=i.node;r&&(e=r.getLayer(),i.anim.stop(),i.isDragging&&(i.isDragging=!1,i.justDragged=!0,n.listenClickTap=!1,t&&(t.dragEndNode=r)),delete i.node,(e||r).draw())},_endDragAfter:function(t){t=t||{};var e=t.dragEndNode;t&&e&&e.fire("dragend",{type:"dragend",target:e,evt:t},!0)}},n.Node.prototype.startDrag=function(){var t=n.DD,e=this.getStage(),i=this.getLayer(),r=e.getPointerPosition(),o=this.getAbsolutePosition();r&&(t.node&&t.node.stopDrag(),t.node=this,t.startPointerPos=r,t.offset.x=r.x-o.x,t.offset.y=r.y-o.y,t.anim.setLayers(i||this.getLayers()),t.anim.start(),this._setDragPosition())},n.Node.prototype._setDragPosition=function(t){var e=n.DD,i=this.getStage().getPointerPosition(),r=this.getDragBoundFunc();if(i){var o={x:i.x-e.offset.x,y:i.y-e.offset.y};void 0!==r&&(o=r.call(this,o,t)),this.setAbsolutePosition(o),this._lastPos&&this._lastPos.x===o.x&&this._lastPos.y===o.y||(e.anim.dirty=!0),this._lastPos=o}},n.Node.prototype.stopDrag=function(){var t=n.DD,e={};t._endDragBefore(e),t._endDragAfter(e)},n.Node.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange()};var t=n.Node.prototype.destroy;n.Node.prototype.destroy=function(){var e=n.DD;e.node&&e.node._id===this._id&&this.stopDrag(),t.call(this)},n.Node.prototype.isDragging=function(){var t=n.DD;return!(!t.node||t.node._id!==this._id||!t.isDragging)},n.Node.prototype._listenDrag=function(){var t=this;this._dragCleanup(),"Stage"===this.getClassName()?this.on("contentMousedown.konva contentTouchstart.konva",function(e){n.DD.node||t.startDrag(e)}):this.on("mousedown.konva touchstart.konva",function(e){1!==e.evt.button&&2!==e.evt.button&&(n.DD.node||t.startDrag(e))})},n.Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage(),e=n.DD;t&&e.node&&e.node._id===this._id&&e.node.stopDrag()}},n.Node.prototype._dragCleanup=function(){"Stage"===this.getClassName()?(this.off("contentMousedown.konva"),this.off("contentTouchstart.konva")):(this.off("mousedown.konva"),this.off("touchstart.konva"))},n.Factory.addGetterSetter(n.Node,"dragBoundFunc"),n.Factory.addGetter(n.Node,"draggable",!1),n.Factory.addOverloadedGetterSetter(n.Node,"draggable");var e=n.document.documentElement;e.addEventListener("mouseup",n.DD._endDragBefore,!0),e.addEventListener("touchend",n.DD._endDragBefore,!0),e.addEventListener("mousemove",n.DD._drag),e.addEventListener("touchmove",n.DD._drag),e.addEventListener("mouseup",n.DD._endDragAfter,!1),e.addEventListener("touchend",n.DD._endDragAfter,!1)}(),function(){"use strict";n.Rect=function(t){this.___init(t)},n.Rect.prototype={___init:function(t){n.Shape.call(this,t),this.className="Rect",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.getCornerRadius(),n=this.getWidth(),i=this.getHeight();t.beginPath(),e?(e=Math.min(e,n/2,i/2),t.moveTo(e,0),t.lineTo(n-e,0),t.arc(n-e,e,e,3*Math.PI/2,0,!1),t.lineTo(n,i-e),t.arc(n-e,i-e,e,0,Math.PI/2,!1),t.lineTo(e,i),t.arc(e,i-e,e,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}},n.Util.extend(n.Rect,n.Shape),n.Factory.addGetterSetter(n.Rect,"cornerRadius",0),n.Collection.mapMethods(n.Rect)}(),function(){"use strict";var t=2*Math.PI-1e-4,e="Circle";n.Circle=function(t){this.___init(t)},n.Circle.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className=e,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.beginPath(),e.arc(0,0,this.getRadius(),0,t,!1),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)}},n.Util.extend(n.Circle,n.Shape),n.Factory.addGetterSetter(n.Circle,"radius",0),n.Factory.addOverloadedGetterSetter(n.Circle,"radius"),n.Collection.mapMethods(n.Circle)}(),function(){"use strict";var t=2*Math.PI-1e-4,e="Ellipse";n.Ellipse=function(t){this.___init(t)},n.Ellipse.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className=e,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var n=this.getRadiusX(),i=this.getRadiusY();e.beginPath(),e.save(),n!==i&&e.scale(1,i/n),e.arc(0,0,n,0,t,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadiusX()},getHeight:function(){return 2*this.getRadiusY()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.setRadius({x:t/2})},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.setRadius({y:t/2})}},n.Util.extend(n.Ellipse,n.Shape),n.Factory.addComponentsGetterSetter(n.Ellipse,"radius",["x","y"]),n.Factory.addGetterSetter(n.Ellipse,"radiusX",0),n.Factory.addGetterSetter(n.Ellipse,"radiusY",0),n.Collection.mapMethods(n.Ellipse)}(),function(){"use strict";var t=2*Math.PI-1e-4;n.Ring=function(t){this.___init(t)},n.Ring.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className="Ring",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.beginPath(),e.arc(0,0,this.getInnerRadius(),0,t,!1),e.moveTo(this.getOuterRadius(),0),e.arc(0,0,this.getOuterRadius(),t,0,!0),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.outerRadius()!==t/2&&this.setOuterRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.outerRadius()!==t/2&&this.setOuterRadius(t/2)},setOuterRadius:function(t){this._setAttr("outerRadius",t),this.setWidth(2*t),this.setHeight(2*t)}},n.Util.extend(n.Ring,n.Shape),n.Factory.addGetterSetter(n.Ring,"innerRadius",0),n.Factory.addGetter(n.Ring,"outerRadius",0),n.Factory.addOverloadedGetterSetter(n.Ring,"outerRadius"),n.Collection.mapMethods(n.Ring)}(),function(){"use strict";n.Wedge=function(t){this.___init(t)},n.Wedge.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className="Wedge",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){t.beginPath(),t.arc(0,0,this.getRadius(),0,n.getAngle(this.getAngle()),this.getClockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)}},n.Util.extend(n.Wedge,n.Shape),n.Factory.addGetterSetter(n.Wedge,"radius",0),n.Factory.addGetterSetter(n.Wedge,"angle",0),n.Factory.addGetterSetter(n.Wedge,"clockwise",!1),n.Factory.backCompat(n.Wedge,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),n.Collection.mapMethods(n.Wedge)}(),function(){"use strict";n.Arc=function(t){this.___init(t)},n.Arc.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className="Arc",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=n.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.getOuterRadius(),0,e,i),t.arc(0,0,this.getInnerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.getOuterRadius()!==t/2&&this.setOuterRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.getOuterRadius()!==t/2&&this.setOuterRadius(t/2)}},n.Util.extend(n.Arc,n.Shape),n.Factory.addGetterSetter(n.Arc,"innerRadius",0),n.Factory.addGetterSetter(n.Arc,"outerRadius",0),n.Factory.addGetterSetter(n.Arc,"angle",0),n.Factory.addGetterSetter(n.Arc,"clockwise",!1),n.Collection.mapMethods(n.Arc)}(),function(){"use strict";var t="Image";n.Image=function(t){this.___init(t)},n.Image.prototype={___init:function(e){n.Shape.call(this,e),this.className=t,this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()&&this.getStage()},_sceneFunc:function(t){var e,n,i,r=this.getWidth(),o=this.getHeight(),a=this.getImage();a&&(e=this.getCropWidth(),n=this.getCropHeight(),i=e&&n?[a,this.getCropX(),this.getCropY(),e,n,0,0,r,o]:[a,0,0,r,o]),(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,r,o),t.closePath(),t.fillStrokeShape(this)),a&&t.drawImage.apply(t,i)},_hitFunc:function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){var t=this.getImage();return this.attrs.width||(t?t.width:0)},getHeight:function(){var t=this.getImage();return this.attrs.height||(t?t.height:0)}},n.Util.extend(n.Image,n.Shape),n.Factory.addGetterSetter(n.Image,"image"),n.Factory.addComponentsGetterSetter(n.Image,"crop",["x","y","width","height"]),n.Factory.addGetterSetter(n.Image,"cropX",0),n.Factory.addGetterSetter(n.Image,"cropY",0),n.Factory.addGetterSetter(n.Image,"cropWidth",0),n.Factory.addGetterSetter(n.Image,"cropHeight",0),n.Collection.mapMethods(n.Image),n.Image.fromURL=function(t,e){var i=new Image;i.onload=function(){var t=new n.Image({image:i});e(t)},i.src=t}}(),function(){"use strict";function t(t){t.fillText(this.partialText,0,0)}function e(t){t.strokeText(this.partialText,0,0)}var i="auto",r="center",o="Change.konva",a="2d",s="-",l="",h="left",c="text",u="Text",d="middle",f="normal",p="px ",g=" ",m="right",v="word",y="char",b="none",w=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","lineHeight","text","width","height","wrap"],x=w.length,S=n.Util.createCanvasElement().getContext(a);n.Text=function(t){this.___init(t)},n.Text.prototype={___init:function(r){r=r||{},r.fillLinearGradientColorStops||r.fillRadialGradientColorStops||(r.fill=r.fill||"black"),void 0===r.width&&(r.width=i),void 0===r.height&&(r.height=i),n.Shape.call(this,r),this._fillFunc=t,this._strokeFunc=e,this.className=u;for(var a=0;x>a;a++)this.on(w[a]+o,this._setTextData);this._setTextData(),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(t){var e,n=this.getPadding(),i=this.getTextHeight(),o=this.getLineHeight()*i,a=this.textArr,s=a.length,l=this.getWidth();for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",d),t.setAttr("textAlign",h),t.save(),n?(t.translate(n,0),t.translate(0,n+i/2)):t.translate(0,i/2),e=0;s>e;e++){var c=a[e],u=c.text,f=c.width;t.save(),this.getAlign()===m?t.translate(l-f-2*n,0):this.getAlign()===r&&t.translate((l-f-2*n)/2,0),this.partialText=u,t.fillStrokeShape(this),t.restore(),t.translate(0,o)}t.restore()},_hitFunc:function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},setText:function(t){var e=n.Util._isString(t)?t:t.toString();return this._setAttr(c,e),this},getWidth:function(){return this.attrs.width===i?this.getTextWidth()+2*this.getPadding():this.attrs.width},getHeight:function(){return this.attrs.height===i?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(t){var e,n=S,i=this.getFontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:parseInt(i,10)}},_getContextFont:function(){return this.getFontStyle()+g+this.getFontVariant()+g+this.getFontSize()+p+this.getFontFamily()},_addTextLine:function(t,e){return this.textArr.push({text:t,width:e})},_getTextWidth:function(t){return S.measureText(t).width},_setTextData:function(){var t=this.getText().split("\n"),e=+this.getFontSize(),n=0,r=this.getLineHeight()*e,o=this.attrs.width,a=this.attrs.height,l=o!==i,h=a!==i,c=this.getPadding(),u=o-2*c,d=a-2*c,f=0,p=this.getWrap(),m=p!==b,v=p!==y&&m;this.textArr=[],S.save(),S.font=this._getContextFont();for(var w=0,x=t.length;x>w;++w){var _=t[w],C=this._getTextWidth(_);if(l&&C>u)for(;_.length>0;){for(var k=0,T=_.length,F="",E=0;T>k;){var A=k+T>>>1,D=_.slice(0,A+1),N=this._getTextWidth(D);u>=N?(k=A+1,F=D,E=N):T=A}if(!F)break;if(v){var M=Math.max(F.lastIndexOf(g),F.lastIndexOf(s))+1;M>0&&(k=M,F=F.slice(0,k),E=this._getTextWidth(F))}if(this._addTextLine(F,E),n=Math.max(n,E),f+=r,!m||h&&f+r>d)break;if(_=_.slice(k),_.length>0&&(C=this._getTextWidth(_),u>=C)){this._addTextLine(_,C),f+=r,n=Math.max(n,C);break}}else this._addTextLine(_,C),f+=r,n=Math.max(n,C);if(h&&f+r>d)break}S.restore(),this.textHeight=e,this.textWidth=n}},n.Util.extend(n.Text,n.Shape),n.Factory.addGetterSetter(n.Text,"fontFamily","Arial"),n.Factory.addGetterSetter(n.Text,"fontSize",12),n.Factory.addGetterSetter(n.Text,"fontStyle",f),n.Factory.addGetterSetter(n.Text,"fontVariant",f),n.Factory.addGetterSetter(n.Text,"padding",0),n.Factory.addGetterSetter(n.Text,"align",h),n.Factory.addGetterSetter(n.Text,"lineHeight",1),n.Factory.addGetterSetter(n.Text,"wrap",v),n.Factory.addGetter(n.Text,"text",l),n.Factory.addOverloadedGetterSetter(n.Text,"text"),n.Collection.mapMethods(n.Text)}(),function(){"use strict";n.Line=function(t){this.___init(t)},n.Line.prototype={___init:function(t){n.Shape.call(this,t),this.className="Line",this.on("pointsChange.konva tensionChange.konva closedChange.konva",function(){this._clearCache("tensionPoints")}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e,n,i,r=this.getPoints(),o=r.length,a=this.getTension(),s=this.getClosed();if(o){if(t.beginPath(),t.moveTo(r[0],r[1]),0!==a&&o>4){for(e=this.getTensionPoints(),n=e.length,i=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);n-2>i;)t.bezierCurveTo(e[i++],e[i++],e[i++],e[i++],e[i++],e[i++]);s||t.quadraticCurveTo(e[n-2],e[n-1],r[o-2],r[o-1])}else for(i=2;o>i;i+=2)t.lineTo(r[i],r[i+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}},getTensionPoints:function(){return this._getCache("tensionPoints",this._getTensionPoints)},_getTensionPoints:function(){return this.getClosed()?this._getTensionPointsClosed():n.Util._expandPoints(this.getPoints(),this.getTension())},_getTensionPointsClosed:function(){var t=this.getPoints(),e=t.length,i=this.getTension(),r=n.Util,o=r._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),a=r._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),s=n.Util._expandPoints(t,i),l=[o[2],o[3]].concat(s).concat([a[0],a[1],t[e-2],t[e-1],a[2],a[3],o[0],o[1],t[0],t[1]]);return l},getWidth:function(){return this.getSelfRect().width},getHeight:function(){return this.getSelfRect().height},getSelfRect:function(){var t;t=0!==this.getTension()?this._getTensionPoints():this.getPoints();for(var e,n,i=t[0],r=t[0],o=t[1],a=t[1],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],i=Math.min(i,e),r=Math.max(r,e),o=Math.min(o,n),a=Math.max(a,n);return{x:Math.round(i),y:Math.round(o),width:Math.round(r-i),height:Math.round(a-o)}}},n.Util.extend(n.Line,n.Shape),n.Factory.addGetterSetter(n.Line,"closed",!1),n.Factory.addGetterSetter(n.Line,"tension",0),n.Factory.addGetterSetter(n.Line,"points",[]),n.Collection.mapMethods(n.Line)}(),function(){"use strict";n.Sprite=function(t){this.___init(t)},n.Sprite.prototype={___init:function(t){n.Shape.call(this,t),this.className="Sprite",this._updated=!0;var e=this;this.anim=new n.Animation(function(){var t=e._updated;return e._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(t){var e=this.getAnimation(),n=this.frameIndex(),i=4*n,r=this.getAnimations()[e],o=this.frameOffsets(),a=r[i+0],s=r[i+1],l=r[i+2],h=r[i+3],c=this.getImage();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,l,h),t.closePath(),t.fillStrokeShape(this)),c)if(o){var u=o[e],d=2*n;t.drawImage(c,a,s,l,h,u[d+0],u[d+1],l,h)}else t.drawImage(c,a,s,l,h,0,0,l,h)},_hitFunc:function(t){var e=this.getAnimation(),n=this.frameIndex(),i=4*n,r=this.getAnimations()[e],o=this.frameOffsets(),a=r[i+2],s=r[i+3];if(t.beginPath(),o){var l=o[e],h=2*n;t.rect(l[h+0],l[h+1],a,s)}else t.rect(0,0,a,s);t.closePath(),t.fillShape(this)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},_setInterval:function(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.getFrameRate())},start:function(){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()},stop:function(){this.anim.stop(),clearInterval(this.interval)},isRunning:function(){return this.anim.isRunning()},_updateIndex:function(){var t=this.frameIndex(),e=this.getAnimation(),n=this.getAnimations(),i=n[e],r=i.length/4;r-1>t?this.frameIndex(t+1):this.frameIndex(0)}},n.Util.extend(n.Sprite,n.Shape),n.Factory.addGetterSetter(n.Sprite,"animation"),n.Factory.addGetterSetter(n.Sprite,"animations"),n.Factory.addGetterSetter(n.Sprite,"frameOffsets"),n.Factory.addGetterSetter(n.Sprite,"image"),n.Factory.addGetterSetter(n.Sprite,"frameIndex",0),n.Factory.addGetterSetter(n.Sprite,"frameRate",17),n.Factory.backCompat(n.Sprite,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),n.Collection.mapMethods(n.Sprite)}(),function(){"use strict";n.Path=function(t){this.___init(t)},n.Path.prototype={___init:function(t){this.dataArray=[];var e=this;n.Shape.call(this,t),this.className="Path",this.dataArray=n.Path.parsePathData(this.getData()),this.on("dataChange.konva",function(){e.dataArray=n.Path.parsePathData(this.getData())}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.dataArray,n=!1;t.beginPath();for(var i=0;i<e.length;i++){var r=e[i].command,o=e[i].points;switch(r){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var a=o[0],s=o[1],l=o[2],h=o[3],c=o[4],u=o[5],d=o[6],f=o[7],p=l>h?l:h,g=l>h?1:l/h,m=l>h?h/l:1;t.translate(a,s),t.rotate(d),t.scale(g,m),t.arc(0,0,p,c,c+u,1-f),t.scale(1/g,1/m),t.rotate(-d),t.translate(-a,-s);break;case"z":t.closePath(),n=!0}}n?t.fillStrokeShape(this):t.strokeShape(this)},getSelfRect:function(){var t=[];this.dataArray.forEach(function(e){t=t.concat(e.points)});for(var e,n,i=t[0],r=t[0],o=t[0],a=t[0],s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],i=Math.min(i,e),r=Math.max(r,e),o=Math.min(o,n),a=Math.max(a,n);return{x:Math.round(i),y:Math.round(o),width:Math.round(r-i),height:Math.round(a-o)}}},n.Util.extend(n.Path,n.Shape),n.Path.getLineLength=function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))},n.Path.getPointOnLine=function(t,e,n,i,r,o,a){void 0===o&&(o=e),void 0===a&&(a=n);var s=(r-n)/(i-e+1e-8),l=Math.sqrt(t*t/(1+s*s));e>i&&(l*=-1);var h,c=s*l;if(i===e)h={x:o,y:a+c};else if((a-n)/(o-e+1e-8)===s)h={x:o+l,y:a+c};else{var u,d,f=this.getLineLength(e,n,i,r);if(1e-8>f)return void 0;var p=(o-e)*(i-e)+(a-n)*(r-n);p/=f*f,u=e+p*(i-e),d=n+p*(r-n);var g=this.getLineLength(o,a,u,d),m=Math.sqrt(t*t-g*g);l=Math.sqrt(m*m/(1+s*s)),e>i&&(l*=-1),c=s*l,h={x:u+l,y:d+c}}return h},n.Path.getPointOnCubicBezier=function(t,e,n,i,r,o,a,s,l){function h(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function u(t){return 3*t*(1-t)*(1-t)}function d(t){return(1-t)*(1-t)*(1-t)}var f=s*h(t)+o*c(t)+i*u(t)+e*d(t),p=l*h(t)+a*c(t)+r*u(t)+n*d(t);return{x:f,y:p}},n.Path.getPointOnQuadraticBezier=function(t,e,n,i,r,o,a){function s(t){return t*t}function l(t){return 2*t*(1-t)}function h(t){return(1-t)*(1-t)}var c=o*s(t)+i*l(t)+e*h(t),u=a*s(t)+r*l(t)+n*h(t);return{x:c,y:u}},n.Path.getPointOnEllipticalArc=function(t,e,n,i,r,o){var a=Math.cos(o),s=Math.sin(o),l={x:n*Math.cos(r),y:i*Math.sin(r)};return{x:t+(l.x*a-l.y*s),y:e+(l.x*s+l.y*a)}},n.Path.parsePathData=function(t){if(!t)return[];var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var i=0;i<n.length;i++)e=e.replace(new RegExp(n[i],"g"),"|"+n[i]);var r=e.split("|"),o=[],a=0,s=0;for(i=1;i<r.length;i++){var l=r[i],h=l.charAt(0);l=l.slice(1),l=l.replace(new RegExp(",-","g"),"-"),l=l.replace(new RegExp("-","g"),",-"),l=l.replace(new RegExp("e,-","g"),"e-");var c=l.split(",");c.length>0&&""===c[0]&&c.shift();for(var u=0;u<c.length;u++)c[u]=parseFloat(c[u]);for(;c.length>0&&!isNaN(c[0]);){var d,f,p,g,m,v,y,b,w,x,S=null,_=[],C=a,k=s;switch(h){case"l":a+=c.shift(),s+=c.shift(),S="L",_.push(a,s);break;case"L":a=c.shift(),s=c.shift(),_.push(a,s);break;case"m":var T=c.shift(),F=c.shift();if(a+=T,s+=F,S="M",o.length>2&&"z"===o[o.length-1].command)for(var E=o.length-2;E>=0;E--)if("M"===o[E].command){a=o[E].points[0]+T,s=o[E].points[1]+F;break}_.push(a,s),h="l";break;case"M":a=c.shift(),s=c.shift(),S="M",_.push(a,s),h="L";break;case"h":a+=c.shift(),S="L",_.push(a,s);break;case"H":a=c.shift(),S="L",_.push(a,s);break;case"v":s+=c.shift(),S="L",_.push(a,s);break;case"V":s=c.shift(),S="L",_.push(a,s);break;case"C":_.push(c.shift(),c.shift(),c.shift(),c.shift()),a=c.shift(),s=c.shift(),_.push(a,s);break;case"c":_.push(a+c.shift(),s+c.shift(),a+c.shift(),s+c.shift()),a+=c.shift(),s+=c.shift(),S="C",_.push(a,s);break;case"S":f=a,p=s,d=o[o.length-1],"C"===d.command&&(f=a+(a-d.points[2]),p=s+(s-d.points[3])),_.push(f,p,c.shift(),c.shift()),a=c.shift(),s=c.shift(),S="C",_.push(a,s);break;case"s":f=a,p=s,d=o[o.length-1],"C"===d.command&&(f=a+(a-d.points[2]),p=s+(s-d.points[3])),_.push(f,p,a+c.shift(),s+c.shift()),a+=c.shift(),s+=c.shift(),S="C",_.push(a,s);break;case"Q":_.push(c.shift(),c.shift()),a=c.shift(),s=c.shift(),_.push(a,s);break;case"q":_.push(a+c.shift(),s+c.shift()),a+=c.shift(),s+=c.shift(),S="Q",_.push(a,s);break;case"T":f=a,p=s,d=o[o.length-1],"Q"===d.command&&(f=a+(a-d.points[0]),p=s+(s-d.points[1])),a=c.shift(),s=c.shift(),S="Q",_.push(f,p,a,s);break;case"t":f=a,p=s,d=o[o.length-1],"Q"===d.command&&(f=a+(a-d.points[0]),p=s+(s-d.points[1])),a+=c.shift(),s+=c.shift(),S="Q",_.push(f,p,a,s);break;case"A":g=c.shift(),m=c.shift(),v=c.shift(),y=c.shift(),b=c.shift(),w=a,x=s,a=c.shift(),s=c.shift(),S="A",_=this.convertEndpointToCenterParameterization(w,x,a,s,y,b,g,m,v);break;case"a":g=c.shift(),m=c.shift(),v=c.shift(),y=c.shift(),b=c.shift(),w=a,x=s,a+=c.shift(),s+=c.shift(),S="A",_=this.convertEndpointToCenterParameterization(w,x,a,s,y,b,g,m,v)}o.push({command:S||h,points:_,start:{x:C,y:k},pathLength:this.calcLength(C,k,S||h,_)})}("z"===h||"Z"===h)&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o},n.Path.calcLength=function(t,e,i,r){var o,a,s,l,h=n.Path;switch(i){case"L":return h.getLineLength(t,e,r[0],r[1]);case"C":for(o=0,a=h.getPointOnCubicBezier(0,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),l=.01;1>=l;l+=.01)s=h.getPointOnCubicBezier(l,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),o+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return o;case"Q":for(o=0,a=h.getPointOnQuadraticBezier(0,t,e,r[0],r[1],r[2],r[3]),l=.01;1>=l;l+=.01)s=h.getPointOnQuadraticBezier(l,t,e,r[0],r[1],r[2],r[3]),o+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return o;case"A":o=0;var c=r[4],u=r[5],d=r[4]+u,f=Math.PI/180;if(Math.abs(c-d)<f&&(f=Math.abs(c-d)),a=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),0>u)for(l=c-f;l>d;l-=f)s=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;else for(l=c+f;d>l;l+=f)s=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=h.getLineLength(a.x,a.y,s.x,s.y),a=s;return s=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),o+=h.getLineLength(a.x,a.y,s.x,s.y)}return 0},n.Path.convertEndpointToCenterParameterization=function(t,e,n,i,r,o,a,s,l){var h=l*(Math.PI/180),c=Math.cos(h)*(t-n)/2+Math.sin(h)*(e-i)/2,u=-1*Math.sin(h)*(t-n)/2+Math.cos(h)*(e-i)/2,d=c*c/(a*a)+u*u/(s*s);d>1&&(a*=Math.sqrt(d),s*=Math.sqrt(d));var f=Math.sqrt((a*a*s*s-a*a*u*u-s*s*c*c)/(a*a*u*u+s*s*c*c));r===o&&(f*=-1),isNaN(f)&&(f=0);var p=f*a*u/s,g=f*-s*c/a,m=(t+n)/2+Math.cos(h)*p-Math.sin(h)*g,v=(e+i)/2+Math.sin(h)*p+Math.cos(h)*g,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},b=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},w=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(b(t,e))},x=w([1,0],[(c-p)/a,(u-g)/s]),S=[(c-p)/a,(u-g)/s],_=[(-1*c-p)/a,(-1*u-g)/s],C=w(S,_);return b(S,_)<=-1&&(C=Math.PI),b(S,_)>=1&&(C=0),0===o&&C>0&&(C-=2*Math.PI),1===o&&0>C&&(C+=2*Math.PI),[m,v,a,s,x,C,h,o]},n.Factory.addGetterSetter(n.Path,"data"),n.Collection.mapMethods(n.Path)}(),function(){"use strict";function t(t){t.fillText(this.partialText,0,0)}function e(t){t.strokeText(this.partialText,0,0)}var i="",r="normal";n.TextPath=function(t){this.___init(t)},n.TextPath.prototype={___init:function(i){var r=this;this.dummyCanvas=n.Util.createCanvasElement(),this.dataArray=[],n.Shape.call(this,i),this._fillFunc=t,this._strokeFunc=e,this._fillFuncHit=t,this._strokeFuncHit=e,this.className="TextPath",this.dataArray=n.Path.parsePathData(this.attrs.data),this.on("dataChange.konva",function(){r.dataArray=n.Path.parsePathData(this.attrs.data)}),this.on("textChange.konva textStroke.konva textStrokeWidth.konva",r._setTextData),r._setTextData(),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline","middle"),t.setAttr("textAlign","left"),t.save();for(var e=this.glyphInfo,n=0;n<e.length;n++){t.save();var i=e[n].p0;t.translate(i.x,i.y),t.rotate(e[n].rotation),this.partialText=e[n].text,t.fillStrokeShape(this),t.restore()}t.restore()},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},setText:function(t){n.Text.prototype.setText.call(this,t);
},_getTextSize:function(t){var e=this.dummyCanvas,n=e.getContext("2d");n.save(),n.font=this._getContextFont();var i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(this.attrs.fontSize,10)}},_setTextData:function(){var t=this,e=this._getTextSize(this.attrs.text);this.textWidth=e.width,this.textHeight=e.height,this.glyphInfo=[];for(var i,r,o,a=this.attrs.text.split(""),s=-1,l=0,h=function(){l=0;for(var e=t.dataArray,n=s+1;n<e.length;n++){if(e[n].pathLength>0)return s=n,e[n];"M"===e[n].command&&(i={x:e[n].points[0],y:e[n].points[1]})}return{}},c=function(e){var a=t._getTextSize(e).width,s=0,c=0;for(r=void 0;Math.abs(a-s)/a>.01&&25>c;){c++;for(var u=s;void 0===o;)o=h(),o&&u+o.pathLength<a&&(u+=o.pathLength,o=void 0);if(o==={}||void 0===i)return void 0;var d=!1;switch(o.command){case"L":n.Path.getLineLength(i.x,i.y,o.points[0],o.points[1])>a?r=n.Path.getPointOnLine(a,i.x,i.y,o.points[0],o.points[1],i.x,i.y):o=void 0;break;case"A":var f=o.points[4],p=o.points[5],g=o.points[4]+p;0===l?l=f+1e-8:a>s?l+=Math.PI/180*p/Math.abs(p):l-=Math.PI/360*p/Math.abs(p),(0>p&&g>l||p>=0&&l>g)&&(l=g,d=!0),r=n.Path.getPointOnEllipticalArc(o.points[0],o.points[1],o.points[2],o.points[3],l,o.points[6]);break;case"C":0===l?l=a>o.pathLength?1e-8:a/o.pathLength:a>s?l+=(a-s)/o.pathLength:l-=(s-a)/o.pathLength,l>1&&(l=1,d=!0),r=n.Path.getPointOnCubicBezier(l,o.start.x,o.start.y,o.points[0],o.points[1],o.points[2],o.points[3],o.points[4],o.points[5]);break;case"Q":0===l?l=a/o.pathLength:a>s?l+=(a-s)/o.pathLength:l-=(s-a)/o.pathLength,l>1&&(l=1,d=!0),r=n.Path.getPointOnQuadraticBezier(l,o.start.x,o.start.y,o.points[0],o.points[1],o.points[2],o.points[3])}void 0!==r&&(s=n.Path.getLineLength(i.x,i.y,r.x,r.y)),d&&(d=!1,o=void 0)}},u=0;u<a.length&&(c(a[u]),void 0!==i&&void 0!==r);u++){var d=n.Path.getLineLength(i.x,i.y,r.x,r.y),f=0,p=n.Path.getPointOnLine(f+d/2,i.x,i.y,r.x,r.y),g=Math.atan2(r.y-i.y,r.x-i.x);this.glyphInfo.push({transposeX:p.x,transposeY:p.y,text:a[u],rotation:g,p0:i,p1:r}),i=r}},getSelfRect:function(){var t=[],e=this.fontSize();this.glyphInfo.forEach(function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)});for(var n,i,r=t[0],o=t[0],a=t[0],s=t[0],l=0;l<t.length/2;l++)n=t[2*l],i=t[2*l+1],r=Math.min(r,n),o=Math.max(o,n),a=Math.min(a,i),s=Math.max(s,i);return{x:Math.round(r)-e,y:Math.round(a)-e,width:Math.round(o-r)+2*e,height:Math.round(s-a)+2*e}}},n.TextPath.prototype._getContextFont=n.Text.prototype._getContextFont,n.Util.extend(n.TextPath,n.Shape),n.Factory.addGetterSetter(n.TextPath,"fontFamily","Arial"),n.Factory.addGetterSetter(n.TextPath,"fontSize",12),n.Factory.addGetterSetter(n.TextPath,"fontStyle",r),n.Factory.addGetterSetter(n.TextPath,"fontVariant",r),n.Factory.addGetter(n.TextPath,"text",i),n.Collection.mapMethods(n.TextPath)}(),function(){"use strict";n.RegularPolygon=function(t){this.___init(t)},n.RegularPolygon.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className="RegularPolygon",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e,n,i,r=this.attrs.sides,o=this.attrs.radius;for(t.beginPath(),t.moveTo(0,0-o),e=1;r>e;e++)n=o*Math.sin(2*e*Math.PI/r),i=-1*o*Math.cos(2*e*Math.PI/r),t.lineTo(n,i);t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.radius()!==t/2&&this.setRadius(t/2)}},n.Util.extend(n.RegularPolygon,n.Shape),n.Factory.addGetterSetter(n.RegularPolygon,"radius",0),n.Factory.addGetterSetter(n.RegularPolygon,"sides",0),n.Collection.mapMethods(n.RegularPolygon)}(),function(){"use strict";n.Star=function(t){this.___init(t)},n.Star.prototype={_centroid:!0,___init:function(t){n.Shape.call(this,t),this.className="Star",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var r=1;2*i>r;r++){var o=r%2===0?n:e,a=o*Math.sin(r*Math.PI/i),s=-1*o*Math.cos(r*Math.PI/i);t.lineTo(a,s)}t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(t){n.Node.prototype.setWidth.call(this,t),this.outerRadius()!==t/2&&this.setOuterRadius(t/2)},setHeight:function(t){n.Node.prototype.setHeight.call(this,t),this.outerRadius()!==t/2&&this.setOuterRadius(t/2)}},n.Util.extend(n.Star,n.Shape),n.Factory.addGetterSetter(n.Star,"numPoints",5),n.Factory.addGetterSetter(n.Star,"innerRadius",0),n.Factory.addGetterSetter(n.Star,"outerRadius",0),n.Collection.mapMethods(n.Star)}(),function(){"use strict";var t=["fontFamily","fontSize","fontStyle","padding","lineHeight","text"],e="Change.konva",i="none",r="up",o="right",a="down",s="left",l="Label",h=t.length;n.Label=function(t){this.____init(t)},n.Label.prototype={____init:function(t){var e=this;n.Group.call(this,t),this.className=l,this.on("add.konva",function(t){e._addListeners(t.child),e._sync()})},getText:function(){return this.find("Text")[0]},getTag:function(){return this.find("Tag")[0]},_addListeners:function(n){var i,r=this,o=function(){r._sync()};for(i=0;h>i;i++)n.on(t[i]+e,o)},getWidth:function(){return this.getText().getWidth()},getHeight:function(){return this.getText().getHeight()},_sync:function(){var t,e,n,i,l,h,c,u=this.getText(),d=this.getTag();if(u&&d){switch(t=u.getWidth(),e=u.getHeight(),n=d.getPointerDirection(),i=d.getPointerWidth(),c=d.getPointerHeight(),l=0,h=0,n){case r:l=t/2,h=-1*c;break;case o:l=t+i,h=e/2;break;case a:l=t/2,h=e+c;break;case s:l=-1*i,h=e/2}d.setAttrs({x:-1*l,y:-1*h,width:t,height:e}),u.setAttrs({x:-1*l,y:-1*h})}}},n.Util.extend(n.Label,n.Group),n.Collection.mapMethods(n.Label),n.Tag=function(t){this.___init(t)},n.Tag.prototype={___init:function(t){n.Shape.call(this,t),this.className="Tag",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.getWidth(),n=this.getHeight(),i=this.getPointerDirection(),l=this.getPointerWidth(),h=this.getPointerHeight(),c=this.getCornerRadius();t.beginPath(),t.moveTo(0,0),i===r&&(t.lineTo((e-l)/2,0),t.lineTo(e/2,-1*h),t.lineTo((e+l)/2,0)),c?(t.lineTo(e-c,0),t.arc(e-c,c,c,3*Math.PI/2,0,!1)):t.lineTo(e,0),i===o&&(t.lineTo(e,(n-h)/2),t.lineTo(e+l,n/2),t.lineTo(e,(n+h)/2)),c?(t.lineTo(e,n-c),t.arc(e-c,n-c,c,0,Math.PI/2,!1)):t.lineTo(e,n),i===a&&(t.lineTo((e+l)/2,n),t.lineTo(e/2,n+h),t.lineTo((e-l)/2,n)),c?(t.lineTo(c,n),t.arc(c,n-c,c,Math.PI/2,Math.PI,!1)):t.lineTo(0,n),i===s&&(t.lineTo(0,(n+h)/2),t.lineTo(-1*l,n/2),t.lineTo(0,(n-h)/2)),c&&(t.lineTo(0,c),t.arc(c,c,c,Math.PI,3*Math.PI/2,!1)),t.closePath(),t.fillStrokeShape(this)},getSelfRect:function(){var t=0,e=0,n=this.getPointerWidth(),i=this.getPointerHeight(),l=this.pointerDirection(),h=this.getWidth(),c=this.getHeight();return l===r?(e-=i,c+=i):l===a?c+=i:l===s?(t-=1.5*n,h+=n):l===o&&(h+=1.5*n),{x:t,y:e,width:h,height:c}}},n.Util.extend(n.Tag,n.Shape),n.Factory.addGetterSetter(n.Tag,"pointerDirection",i),n.Factory.addGetterSetter(n.Tag,"pointerWidth",0),n.Factory.addGetterSetter(n.Tag,"pointerHeight",0),n.Factory.addGetterSetter(n.Tag,"cornerRadius",0),n.Collection.mapMethods(n.Tag)}(),function(){"use strict";n.Arrow=function(t){this.____init(t)},n.Arrow.prototype={____init:function(t){n.Line.call(this,t),this.className="Arrow"},_sceneFunc:function(t){var e=2*Math.PI,i=this.points(),r=i.length,o=i[r-2]-i[r-4],a=i[r-1]-i[r-3],s=(Math.atan2(a,o)+e)%e,l=this.pointerLength(),h=this.pointerWidth();t.save(),t.beginPath(),t.translate(i[r-2],i[r-1]),t.rotate(s),t.moveTo(0,0),t.lineTo(-l,h/2),t.lineTo(-l,-h/2),t.closePath(),t.restore(),this.pointerAtBeginning()&&(t.save(),t.translate(i[0],i[1]),o=i[2]-i[0],a=i[3]-i[1],t.rotate((Math.atan2(-a,-o)+e)%e),t.moveTo(0,0),t.lineTo(-10,6),t.lineTo(-10,-6),t.closePath(),t.restore()),t.fillStrokeShape(this),n.Line.prototype._sceneFunc.apply(this,arguments)}},n.Util.extend(n.Arrow,n.Line),n.Factory.addGetterSetter(n.Arrow,"pointerLength",10),n.Factory.addGetterSetter(n.Arrow,"pointerWidth",10),n.Factory.addGetterSetter(n.Arrow,"pointerAtBeginning",!1),n.Collection.mapMethods(n.Arrow)}(),define("views/helpers/citymap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,_.extend(this,t.Events),this.params=e}return n.prototype.init=function(){var t=this;console.log("init map"),this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=.8,i=.5,r=500,o=1,a=100,s=20,l=a*s,h=a*s,c=Math.max(r,(this.width-l*n+h*i)/2),u=Math.max(r,(this.height+h*i)/2),d=3e3,f=2e3;this.stage=new e.Stage({container:this.params.container,width:d,height:f});var p=new e.Layer({id:"main"});this.limitBound=function(e,n){var i=-(d*o-t.width),r=0,a=-(f*o-t.height),s=0;return{x:Math.min(r,Math.max(i,e.x)),y:Math.min(s,Math.max(a,e.y))}};var g=new e.Group({rotate:40}),m=new e.Group({id:"bg",draggable:!0,dragBoundFunc:function(e){return t.limitBound(e,this.getClientRect())}});m.add(g);for(var v=0;l>=v;v+=100){var y=c+v*n,b=u-v*(1-n),w=y+h*i,x=b+h*(1-i),S=new e.Line({points:[y,b,w,x],stroke:"black",strokeWidth:1,lineCap:"round",lineJoin:"round"});m.add(S)}for(var _=0;h>=_;_+=100){var y=c+_*(1-i),b=u+_*i,w=y+l*n,x=b-l*(1-n),S=new e.Line({points:[y,b,w,x],stroke:"black",strokeWidth:1,lineCap:"round",lineJoin:"round"});m.add(S)}p.add(m),this.stage.add(p);var C=new Image;C.onload=function(){var t=new e.Image({x:0,y:0,image:C,width:C.naturalWidth,height:C.naturalHeight});g.add(t),p.draw()},C.src="/img/citymap/bg.jpg",p.on("mousewheel",function(e){var n=o,i=e.evt.wheelDelta/120>0?1.01:.99,r=Math.max(t.width/d,t.height/f);i=o*i,i=Math.min(1,Math.max(r,i)),o=i,p.scale({x:o,y:o});var a=t.width*o,s=t.height*o,l=o/n;if(a-d/o>m.x());else var h=e.evt.pageX;if(s-f/o>m.y());else var c=e.evt.pageY;m.x(Math.min(0,-((h-m.x()/o)*l-h)*o)),m.y(Math.min(0,-((c-m.y()/o)*l-c)*o)),p.draw()})},n.prototype.render=function(){return this},n.prototype.resize=function(){return},n}),define("views/city/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/topInfo","views/helpers/citymap"],function(t,e,n,i,r,o,a){var s=t.View.extend({className:"content-inner",events:{"click #reviewBtn":function(){this.params.openWindow("review")},"click #salesBtn":function(){this.params.openWindow("sales")},"click #vipBtn":function(){this.params.openWindow("vip")},"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="city",this.template=this.getTemplate("page-city-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new n(this.params);this.$el.find("#chats").html(t.render().$el);var e=new i(this.params);this.$el.find("#menu").html(e.render().$el);var s=new r(this.params);this.$el.find("#bottom").html(s.render().$el);var l=new o(this.params);this.$el.find("#topInfo").html(l.render().$el);var h=this,c=new a({container:h.$el.find("#cityMap")[0]});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),h.resize(),c.init()}),this.listenTo(this.params.app,"frame",function(){c.render()}),this.listenTo(this.params.app,"resize",function(){h.resize(),c.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return s}),define("views/city/inventory",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-inventory",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-inventory")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/mail",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-mail",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-mail")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/news",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-news",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-news")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/notifications",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-notifications",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-notifications")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/profile",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-profile",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-profile")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/quests",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-quests",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-quests")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/review",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-review",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-review")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/sales",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-sales",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-sales")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/search",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-search",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-search")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/settings",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-settings",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-settings")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/ships",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-ships",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-ships")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/shop",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-shop",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-shop")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/tournaments",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-tournaments",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-tournaments")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/units",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-units",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-units")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/city/vip",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-vip",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("window-vip")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/helpers/galaxymap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,this.widthIcon=92,this.heightIcon=92,this.widthStep=300,this.margin=50,this.initStatus=!1,this.galaxyMaxRight=0,this.galaxyMaxLeft=0,this.galaxyMaxTop=0,this.zoom=1,this.galaxyMaxBottom=0,_.extend(this,t.Events),this.animations={},this.params=e}return n.prototype.init=function(){var t=this;this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=new e.Layer({id:"main"}),i=function(e){for(var n in t.params.galaxies)if(t.params.galaxies[n].id==e.id)for(var r in t.params.galaxies[n].depend){var o=t.params.galaxies[n].depend[r];for(var a in t.params.galaxies)if(o.id==t.params.galaxies[a].id&&!t.params.galaxies[a].x&&!t.params.galaxies[a].y){var s=o.angle?Math.sin(o.angle/180*Math.PI):0,l=o.angle?Math.cos(o.angle/180*Math.PI):1;t.params.galaxies[a].x=e.x+t.widthStep*l,t.params.galaxies[a].y=e.y+t.widthStep*s,i(t.params.galaxies[a])}}for(var n in t.params.galaxies)if(t.params.galaxies[n].id!=e.id)for(var r in t.params.galaxies[n].depend){var o=t.params.galaxies[n].depend[r];if(o.id==e.id&&!t.params.galaxies[n].x&&!t.params.galaxies[n].y){var s=o.angle?Math.sin(o.angle/180*Math.PI):0,l=o.angle?Math.cos(o.angle/180*Math.PI):1;t.params.galaxies[n].x=e.x-t.widthStep*l,t.params.galaxies[n].y=e.y-t.widthStep*s,i(t.params.galaxies[n])}}},r=1;for(var o in t.params.galaxies)t.params.galaxies[o].id==r&&(t.params.galaxies[o].x=0,t.params.galaxies[o].y=0,i(t.params.galaxies[o]));for(var a in this.params.galaxies){var s=this.params.galaxies[a];void 0!==s.status&&s.status&&(this.galaxyMaxRight=Math.max(s.x,this.galaxyMaxRight),this.galaxyMaxLeft=Math.min(s.x,this.galaxyMaxLeft),this.galaxyMaxBottom=Math.max(s.y,this.galaxyMaxBottom),this.galaxyMaxTop=Math.min(s.y,this.galaxyMaxTop))}var l=this.stageSize(),h=this.galaxyMaxRight-this.galaxyMaxLeft,c=this.galaxyMaxBottom-this.galaxyMaxTop,u=Math.max(0,(this.width-h)/2)+this.widthIcon/2+this.margin-this.galaxyMaxLeft,d=Math.max(0,(this.height-c)/2)+this.heightIcon/2+this.margin-this.galaxyMaxTop,f=new e.Image({id:"bgImg",width:l.width,height:l.height,x:0,y:0});this.stage=new e.Stage({container:this.params.container,width:l.width,height:l.height}),this.limitBound=function(e){var n=t.stageSize(),i=-(n.width-t.width),r=-(n.height-t.height),o=0,a=0;return{x:Math.min(a,Math.max(i,e.x)),y:Math.min(o,Math.max(r,e.y))}};var p=0,g=0;_.each(this.params.galaxies,function(e){e.id==r&&(p=Math.min(l.width-t.width,u+e.x),g=Math.min(l.height-t.height,d+e.y))});var m=new e.Group({id:"bg",x:-p,y:-g,draggable:!0,dragBoundFunc:this.limitBound});m.add(f),n.add(m);var v=function(n){var i=void 0!==n.opened&&n.opened,r=new e.Circle({id:"icon-"+n.id,x:u+n.x+t.widthIcon/2,y:d+n.y+t.heightIcon/2,radius:t.widthIcon,fill:i?"red":"silver"});m.add(r)},y=function(n){var i=new e.Circle({id:"icon-"+n.id,x:u+n.x+t.widthIcon/2,y:d+n.y+t.heightIcon/2,radius:t.widthIcon,stroke:"black",strokeWidth:4});i.on("click",function(e){t.moveToIcon(n,this,m)}),i.on("mouseover",function(){$(t.params.container).css("cursor","pointer")}),i.on("mouseout",function(){$(t.params.container).css("cursor","default")}),m.add(i)},b=function(n){var i=new e.Text({x:u+n.x-t.widthIcon/2,y:d+n.y,width:2*t.widthIcon,align:"center",text:"System "+n.id,fontSize:20,fontFamily:"Calibri",fill:"black"});m.add(i);var i=new e.Text({x:u+n.x-t.widthIcon/2,y:d+n.y+25,width:2*t.widthIcon,align:"center",text:"King lords",fontSize:14,fontFamily:"Calibri",fill:"black"});m.add(i);var i=new e.Text({x:u+n.x-t.widthIcon/2,y:d+n.y+55,width:2*t.widthIcon,align:"center",text:"x 3/10",fontSize:14,fontFamily:"Calibri",fill:"black"});m.add(i)},w=function(n){n.depend&&_.each(n.depend,function(i){var r=_.find(t.params.galaxies,function(t){return t.id==i.id});if(r&&void 0!==r.status&&r.status){var o=new e.Line({points:[u+t.widthIcon/2+n.x,d+t.heightIcon/2+n.y,u+t.widthIcon/2+r.x,d+t.heightIcon/2+r.y],stroke:"silver",strokeWidth:5,lineCap:"round",lineJoin:"round"});m.add(o)}})};_.each(this.params.galaxies,function(t){void 0!==t.status&&t.status&&w(t)}),_.each(this.params.galaxies,function(t){void 0!==t.status&&t.status&&(v(t),b(t),y(t))}),this.stage.add(n);var x=new Image;x.onload=function(){f.fillPatternImage(x),n.draw(),t.initStatus=!0},x.src="/img/dark-s_nx.jpg"},n.prototype.moveToIcon=function(t,e,n){var i=this,r=this.stageSize(),o=n.x(),a=n.y(),s=e.x()+o-this.width/2,l=e.y()+a-this.height/2;s=Math.max(s,-1*(Math.min(0,o-s)-o)),l=Math.max(l,-1*(Math.min(0,a-l)-a)),s=Math.min(s,-1*(Math.max(-1*(r.width-this.width),o-s)-o)),l=Math.min(l,-1*(Math.max(-1*(r.height-this.height),a-l)-a)),this.animations.moveToCenter={element:"#bg",timeStart:(new Date).getTime(),x:n.x(),y:n.y(),diffX:s,diffY:l,duration:200,callback:function(){i.params.infoBtn(t)}}},n.prototype.stageSize=function(){var t=Math.max(this.width,this.galaxyMaxRight-this.galaxyMaxLeft+2*this.widthIcon+2*this.margin),e=Math.max(this.height,this.galaxyMaxBottom-this.galaxyMaxTop+2*this.heightIcon+2*this.margin);return{width:t,height:e}},n.prototype.render=function(){var t=this;if(this.initStatus){var e=(new Date).getTime();if(t.animations){var n=!1;for(var i in t.animations){var r=t.stage.findOne(t.animations[i].element);if(r){n=!0;var o=t.animations[i].timeStart+t.animations[i].duration,a=e-t.animations[i].timeStart,s=Math.min(1,Math.max(0,a/t.animations[i].duration));isNaN(t.animations[i].diffX)||r.x(t.animations[i].x-t.animations[i].diffX*s),isNaN(t.animations[i].diffY)||r.y(t.animations[i].y-t.animations[i].diffY*s),e>=o&&(t.animations[i].callback(),delete t.animations[i])}}if(n){var l=t.stage.findOne("#main");l.draw()}}}return this},n.prototype.resize=function(){this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var t=this.stageSize();this.stage.size(t);var e=this.stage.findOne("#bgImg");e&&(console.log("set bgImg",t),e.size(t));this.stage.find("#bg");return this},n}),define("views/galaxy/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/topInfo","views/helpers/galaxymap"],function(t,e,n,i,r,o,a){var s=t.View.extend({className:"content-inner",events:{"click #reviewBtn":function(){this.params.openWindow("review")},"click #salesBtn":function(){this.params.openWindow("sales")},"click #vipBtn":function(){this.params.openWindow("vip")},"click #shopBtn":function(){this.params.openWindow("shop")},"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="galaxy",this.template=this.getTemplate("page-galaxy-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new r(this.params);this.$el.find("#bottom").html(t.render().$el);var e=new n(this.params);this.$el.find("#chats").html(e.render().$el);var o=new i(this.params);this.$el.find("#menu").html(o.render().$el);var s=this,l=new a({galaxies:this.params.app.config.galaxies,container:s.$el.find("#galaxyMap")[0],infoBtn:function(t){s.params.infoWindow(t)}});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),s.resize(),l.init()}),this.listenTo(this.params.app,"frame",function(){l.render()}),this.listenTo(this.params.app,"resize",function(){s.resize(),l.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return s}),define("views/galaxy/info",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-galaxyInfo",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("page-galaxy-info")},render:function(){this.$el.html(this.template({t:$.t,galaxy:this.params.galaxy}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/helpers/planetmap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,_.extend(this,t.Events),this.params=e}return n.prototype.init=function(){var t=this;this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=new e.Layer({id:"main"}),i=this.stageSize(),r=new e.Image({width:i.width,height:i.height,x:0,y:0});this.stage=new e.Stage({container:this.params.container,width:i.width,height:i.height});var o=function(t,n,i,r,o){return new e.Text({x:n,y:i,width:r,height:o,align:"center",text:t,fontSize:14,fontFamily:"Calibri",fill:"#666"})};this.limitBound=function(e,n){var i=-(n.width-t.width),r=-(n.height-t.height),o=0,a=0;return{x:Math.min(a,Math.max(i,e.x)),y:Math.min(o,Math.max(r,e.y))}};var a=20,s=20,l=new e.Group({id:"bg",x:a,y:s,draggable:!0,dragBoundFunc:function(e){return t.limitBound(e,this.getClientRect())}});l.add(r),n.add(l);var h=new e.Group({id:"line-top",x:0,y:0});h.add(new e.Rect({x:0,y:0,width:this.width,height:20,fill:"#ccc"}));var c=new e.Group({id:"line-top",x:0,y:0});c.add(new e.Rect({x:0,y:0,width:20,height:this.height,fill:"#ccc"}));for(var u=2,d=40,f=1;f<i.width/100;f+=1)h.add(o(f,100*(f-1)+a,u,100,a)),h.add(new e.Line({points:[100*f+.5+a,0,100*f+.5+a,s],stroke:"red",strokeWidth:1,lineCap:"round",lineJoin:"round"})),l.add(new e.Line({points:[100*f+.5,0,100*f+.5,i.height],stroke:"white",strokeWidth:1,lineCap:"round",lineJoin:"round",dash:[3,3],opacity:.2}));for(var p=1;p<i.height/100;p+=1)c.add(o(p,0,100*(p-1)+s+d,s,20)),c.add(new e.Line({points:[0,100*p+.5+s,a,100*p+.5+s],stroke:"red",strokeWidth:1,lineCap:"round",lineJoin:"round"})),l.add(new e.Line({points:[0,100*p+.5,i.width,100*p+.5],stroke:"white",strokeWidth:1,lineCap:"round",lineJoin:"round",dash:[3,3],opacity:.2}));n.add(h),n.add(c),this.stage.add(n);var g=new Image;g.onload=function(){r.fillPatternImage(g),n.draw()},g.src="/img/dark-s_nx.jpg"},n.prototype.stageSize=function(){var t=3*this.width,e=3*this.height;return{width:t,height:e}},n.prototype.render=function(){return this},n.prototype.resize=function(){this.width=$(this.params.container).width(),this.height=$(this.params.container).height(),this.stage.size({width:this.width,height:this.height});var t=this,e=this.stage.find("#bg");return _.each(e,function(e){var n=e.scale(),i=e.getClientRect();n=t.limitBound(n,i),console.log("pos",n),e.scale(n)}),this},n}),define("views/helpers/raidmap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,this.widthIcon=96,this.heightIcon=96,this.widthStep=50,this.margin=50,this.initStatus=!1,_.extend(this,t.Events),this.animations={},this.params=e}return n.prototype.init=function(){var t=this;this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=new e.Layer({id:"main"}),i=10,r={};this.levelMax=0;for(var o in this.params.raids){var a=this.params.raids[o];void 0===r[a.level]&&(r[a.level]=0),r[a.level]++,this.levelMax=Math.max(this.levelMax,a.level)}var s=this.stageSize(),l=new e.Image({width:s.width,height:s.height,x:0,y:0});this.stage=new e.Stage({container:this.params.container,width:s.width,height:s.height}),this.limitBound=function(e,n){var i=t.stage.getHeight(),r=-(n.width-t.width),o=0;return{x:Math.min(o,Math.max(r,e.x)),y:Math.min(i-n.height,Math.max(0,e.y))}};var h=new e.Group({
id:"bg",x:0,y:0,draggable:!0,dragBoundFunc:function(e){var n=this.getClientRect();return t.limitBound(e,n)}}),c=new e.Group({id:"topinfo",x:this.width-110,y:this.height-60}),u=0;h.add(l),n.add(h),n.add(c);var d=function(){c.add(new e.Rect({x:0,y:0,width:100,height:30,fill:"#ccc"}));var t=new e.Text({x:0,y:0,width:100,padding:4,align:"right",text:"x 100",fontSize:24,fontFamily:"Calibri",fill:"black"});c.add(t)};d();var f=function(i){var r=new e.Image({id:"icon-"+i.code,width:t.widthIcon,height:t.heightIcon,x:i.x,y:i.y}),o=new Image;o.onload=function(){r.image(o),n.draw()},o.src="/img/test.png",r.on("click",function(){t.moveToIcon(i,this,h)}),r.on("mouseover",function(){$(t.params.container).css("cursor","pointer")}),r.on("mouseout",function(){$(t.params.container).css("cursor","default")}),h.add(r)},p=function(n,i){var r=new e.Text({x:i,y:2,width:t.widthIcon,align:"center",text:"Level "+n,fontSize:14,fontFamily:"Calibri",fill:"#666"});h.add(r)},g=function(n){n.need&&_.each(n.need,function(i){var r=_.find(t.params.raids,function(t){return t.code==i}),o=new e.Line({points:[n.x+t.widthIcon/2,n.y+t.heightIcon/2,r.x+t.widthIcon/2,r.y+t.heightIcon/2],stroke:"silver",strokeWidth:15,lineCap:"round",lineJoin:"round"});h.add(o)})};h.add(new e.Rect({x:0,y:0,width:s.width,height:20,fill:"#ccc"})),h.add(new e.Rect({x:0,y:0,width:t.margin+t.widthStep*(5*Math.floor(i/5)+1)+t.widthIcon/2,height:20,fill:"#8BC34A"}));for(var m in r){u++;var v=r[m],y=0;_.each(this.params.raids,function(e){if(m==e.level){y++;var n=(t.height-2*t.margin-v*t.heightIcon)/(v+1),i=t.margin+t.widthStep*e.level;e.x=i,e.y=n*y+t.heightIcon*(y-1)}});var b=t.margin+t.widthStep*m;p(m,b)}_.each(this.params.raids,function(t){g(t)}),_.each(this.params.raids,function(t){f(t)}),this.stage.add(n);var w=new Image;w.onload=function(){l.fillPatternImage(w),t.initStatus=!0,n.draw()},w.src="/img/dark-s_nx.jpg"},n.prototype.stageSize=function(){return{width:Math.max(this.width,2*this.margin+this.widthStep*this.levelMax+this.widthIcon),height:this.height}},n.prototype.moveToIcon=function(t,e,n){var i=this,r=this.stageSize(),o=n.x(),a=(n.y(),e.x()+o-this.width/2);a=Math.max(a,-1*(Math.min(0,o-a)-o)),a=Math.min(a,-1*(Math.max(-1*(r.width-this.width),o-a)-o)),this.animations.moveToCenter={element:"#bg",timeStart:(new Date).getTime(),x:n.x(),y:n.y(),diffX:a,diffY:0,duration:200,callback:function(){i.params.infoBtn(t)}}},n.prototype.render=function(){var t=this;if(this.initStatus){var e=(new Date).getTime();if(t.animations){var n=!1;for(var i in t.animations){var r=t.stage.findOne(t.animations[i].element);if(r){n=!0;var o=t.animations[i].timeStart+t.animations[i].duration,a=e-t.animations[i].timeStart,s=Math.min(1,Math.max(0,a/t.animations[i].duration));isNaN(t.animations[i].diffX)||r.x(t.animations[i].x-t.animations[i].diffX*s),isNaN(t.animations[i].diffY)||r.y(t.animations[i].y-t.animations[i].diffY*s),e>=o&&(t.animations[i].callback(),delete t.animations[i])}}if(n){var l=t.stage.findOne("#main");l.draw()}}}return this},n.prototype.resize=function(){this.width=$(this.params.container).width(),this.height=$(this.params.container).height(),this.stage.size({width:this.width,height:this.height});var t=this,e=this.stage.find("#bg");return _.each(e,function(e){var n=e.scale(),i=e.getClientRect();n=t.limitBound(n,i)}),this},n}),define("views/helpers/sagamap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,this.widthIcon=96,this.heightIcon=96,this.widthStep=50,this.margin=50,this.initStatus=!1,_.extend(this,t.Events),this.animations={},this.params=e}return n.prototype.init=function(){var t=this;this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=new e.Layer({id:"main"}),i=10,r={};this.levelMax=0;for(var o in this.params.sagas){var a=this.params.sagas[o];void 0===r[a.level]&&(r[a.level]=0),r[a.level]++,this.levelMax=Math.max(this.levelMax,a.level)}var s=this.stageSize(),l=new e.Image({width:s.width,height:s.height,x:0,y:0});this.stage=new e.Stage({container:this.params.container,width:s.width,height:s.height}),this.limitBound=function(e,n){var i=t.stage.getHeight(),r=-(n.width-t.width),o=0;return{x:Math.min(o,Math.max(r,e.x)),y:Math.min(i-n.height,Math.max(0,e.y))}};var h=new e.Group({id:"bg",x:0,y:0,draggable:!0,dragBoundFunc:function(e){var n=this.getClientRect();return t.limitBound(e,n)}}),c=0;h.add(l),n.add(h);var u=function(i){var r=new e.Image({id:"icon-"+i.code,width:t.widthIcon,height:t.heightIcon,x:i.x,y:i.y}),o=new Image;o.onload=function(){r.image(o),n.draw()},o.src="/img/test.png",r.on("click",function(e){t.moveToIcon(i,this,h)}),r.on("mouseover",function(){$(t.params.container).css("cursor","pointer")}),r.on("mouseout",function(){$(t.params.container).css("cursor","default")}),h.add(r)},d=function(n,i){var r=new e.Text({x:i,y:2,width:t.widthIcon,align:"center",text:"Level "+n,fontSize:14,fontFamily:"Calibri",fill:"#666"});h.add(r)},f=function(n){n.need&&_.each(n.need,function(i){var r=_.find(t.params.sagas,function(t){return t.code==i}),o=new e.Line({points:[n.x+t.widthIcon/2,n.y+t.heightIcon/2,r.x+t.widthIcon/2,r.y+t.heightIcon/2],stroke:"silver",strokeWidth:15,lineCap:"round",lineJoin:"round"});h.add(o)})};h.add(new e.Rect({x:0,y:0,width:s.width,height:20,fill:"#ccc"})),h.add(new e.Rect({x:0,y:0,width:t.margin+t.widthStep*(5*Math.floor(i/5)+1)+t.widthIcon/2,height:20,fill:"#8BC34A"}));for(var p in r){c++;var g=r[p],m=0;_.each(this.params.sagas,function(e){if(p==e.level){m++;var n=(t.height-2*t.margin-g*t.heightIcon)/(g+1),i=t.margin+t.widthStep*e.level;e.x=i,e.y=n*m+t.heightIcon*(m-1)}});var v=t.margin+t.widthStep*p;parseInt(p)&&d(p,v)}_.each(this.params.sagas,function(t){f(t)}),_.each(this.params.sagas,function(t){u(t)}),this.stage.add(n);var y=new Image;y.onload=function(){l.fillPatternImage(y),t.initStatus=!0,n.draw()},y.src="/img/dark-s_nx.jpg"},n.prototype.stageSize=function(){return{width:Math.max(this.width,2*this.margin+this.widthStep*this.levelMax+this.widthIcon),height:this.height}},n.prototype.moveToIcon=function(t,e,n){var i=this,r=this.stageSize(),o=n.x(),a=(n.y(),e.x()+o-this.width/2);a=Math.max(a,-1*(Math.min(0,o-a)-o)),a=Math.min(a,-1*(Math.max(-1*(r.width-this.width),o-a)-o)),console.log("diffXIcon",a),this.animations.moveToCenter={element:"#bg",timeStart:(new Date).getTime(),x:n.x(),y:n.y(),diffX:a,diffY:0,duration:200,callback:function(){i.params.infoBtn(t)}}},n.prototype.render=function(){var t=this;if(this.initStatus){var e=(new Date).getTime();if(t.animations){var n=!1;for(var i in t.animations){var r=t.stage.findOne(t.animations[i].element);if(r){n=!0;var o=t.animations[i].timeStart+t.animations[i].duration,a=e-t.animations[i].timeStart,s=Math.min(1,Math.max(0,a/t.animations[i].duration));isNaN(t.animations[i].diffX)||r.x(t.animations[i].x-t.animations[i].diffX*s),isNaN(t.animations[i].diffY)||r.y(t.animations[i].y-t.animations[i].diffY*s),e>=o&&(t.animations[i].callback(),delete t.animations[i])}}if(n){var l=t.stage.findOne("#main");l.draw()}}}return this},n.prototype.resize=function(){this.width=$(this.params.container).width(),this.height=$(this.params.container).height(),this.stage.size({width:this.width,height:this.height});var t=this,e=this.stage.find("#bg");return _.each(e,function(e){var n=e.scale(),i=e.getClientRect();n=t.limitBound(n,i)}),this},n}),define("views/helpers/stars",["backbone","backbone-validation"],function(t,e){function n(t,e){this.elementName=t,this.inited=!1,this.Rnd=Math.random,this.Sin=Math.sin,this.Floor=Math.floor,this.warpZ=30,this.units=500,this.stars=[],this.cycle=0,this.Z=.035,this.speed=1}return n.prototype.setSpeed=function(t){this.speed=t},n.prototype.init=function(){if(!this.inited){this.canvas=document.getElementById(this.elementName),this.resize();for(var t,t,e=0;e<this.units;e++)t={},this.resetstar(t),this.stars.push(t);this.inited=!0}},n.prototype.jump=function(){this.Z=.5},n.prototype.resetstar=function(t){t.x=(this.Rnd()*this.canvas.width-.5*this.canvas.width)*this.warpZ,t.y=(this.Rnd()*this.canvas.height-.5*this.canvas.height)*this.warpZ,t.z=this.warpZ,t.px=0,t.py=0},n.prototype.resize=function(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.mousex=this.width/2,this.mousey=this.height/2,this.G=this.canvas.getContext("2d"),this.G.globalAlpha=.25},n.prototype.frameRender=function(){if(this.inited){this.G.fillStyle="#000",this.G.fillRect(0,0,this.width,this.height);var t=this.mousex-this.width/2+this.width/2,e=this.mousey-this.height/2+this.height/2,n=this.Floor(500*this.Z);n>100&&(n=100);for(var i=0;i<this.units;i++){var r=this.stars[i],o=r.x/r.z,a=r.y/r.z,s=2*(1/r.z+1);0!==r.px&&(this.G.strokeStyle="hsl("+this.cycle*i%360+","+n+"%,80%)",this.G.lineWidth=s,this.G.beginPath(),this.G.moveTo(o+t,a+e),this.G.lineTo(r.px+t,r.py+e),this.G.stroke()),r.px=o,r.py=a,r.z-=this.Z,(r.z<this.Z||r.px>this.width||r.py>this.height)&&this.resetstar(r)}this.cycle+=.01}},n}),define("views/helpers/systemmap",["backbone","konva"],function(t,e){function n(e){this.width=0,this.height=0,_.extend(this,t.Events),this.params=e,this.prevRenderTime=0,this.initStatus=!1,this.animations={},this.zoom=2,this.speed={sun:0,venus:10.36,eart:11.19,mars:5.03,mercury:4.25,neptune:23.56,pluto:1.23,saturn:36.09,uranus:21.38,jupiter:60.2},this.mass={sun:1989e3,venus:4.8,eart:5.97,moon:.07,mars:.63,mercury:.32,neptune:101.59,pluto:.01,saturn:561.8,uranus:86,jupiter:1876},this.sizes={sun:695.99,venus:6.052,eart:6.378,moon:1.738,mars:3.488,mercury:2.439,neptune:24.75,pluto:2,saturn:60.1,uranus:26.5,jupiter:71.3},this.planets=[{name:"sun",speed:0,mass:1989e3},{name:"1",speed:.01,angle:Math.PI/2,radius:38,size:5},{name:"2",speed:1,angle:Math.PI,radius:72,size:5},{name:"3",speed:1,angle:2*Math.PI,radius:100,size:10},{name:"4",speed:1,angle:-Math.PI/2,radius:200,size:15},{name:"5",speed:1,angle:-Math.PI/2,radius:250,size:15},{name:"6",speed:1,angle:-Math.PI/2,radius:300,size:15},{name:"7",speed:1,angle:-Math.PI/2,radius:350,size:15},{name:"8",speed:1,angle:-Math.PI/2,radius:400,size:15},{name:"9",speed:1,angle:-Math.PI/2,radius:450,size:15},{name:"10",speed:1,angle:-Math.PI/2,radius:500,size:15}];var n=this;_.each(this.planets,function(t){n.stageWidth=Math.max(n.width,2*(t.radius+t.size)*n.zoom),n.stageHeight=Math.max(n.height,2*(t.radius+t.size)*n.zoom)})}return n.prototype.setZoom=function(t){return this.zoom=t,this},n.prototype.init=function(){var t=this;this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var n=new e.Layer({id:"main"}),i=this.stageSize(),r=new e.Image({id:"bgImg",width:this.width,height:this.height,x:0,y:0});this.stage=new e.Stage({container:this.params.container,width:this.width,height:this.height});this.limitBound=function(t){return t};var o=20,a=20,s=new e.Group({id:"bg",x:-(i.width-this.width)/2,y:-(i.height-this.height)/2,draggable:!0,dragBoundFunc:this.limitBound}),l=new e.Group({id:"grid"});n.add(r),n.add(s),n.add(l);var h=new e.Group({id:"line-top",x:0,y:0});h.add(new e.Rect({x:0,y:0,width:this.width,height:20,fill:"#ccc"}));var c=new e.Group({id:"line-top",x:0,y:0});c.add(new e.Rect({x:0,y:0,width:20,height:this.height,fill:"#ccc"}));for(var u=0;u<this.width/100*this.zoom;u+=this.zoom)h.add(new e.Line({points:[100*u+.5+o,0,100*u+.5+o,a],stroke:"black",strokeWidth:1}));for(var u=0;u<this.width/10*this.zoom;u+=this.zoom)l.add(new e.Line({points:[10*u+.5,0,10*u+.5,i.height],stroke:"white",strokeWidth:1,opacity:u%(10*this.zoom)==0?.3:.1})),console.log("(x%(10*this.zoom",u+"%10*"+this.zoom,u%(10*this.zoom));for(var d=0;d<this.height/100*this.zoom;d+=this.zoom)c.add(new e.Line({points:[0,100*d+.5+a,o,100*d+.5+a],stroke:"black",strokeWidth:1}));for(var d=0;d<this.height/10*this.zoom;d+=this.zoom)l.add(new e.Line({points:[0,10*d+.5,i.width,10*d+.5],stroke:"white",strokeWidth:1,opacity:d%(10*this.zoom)==0?.3:.1}));n.add(h),n.add(c),this.stage.add(n);var f=new Image;f.onload=function(){r.fillPatternImage(f),n.draw(),t.initStatus=!0},f.src="/img/dark-s_nx.jpg";for(var p=i.width/2,g=i.height/2,m=20;100>m;m+=30){var v=Math.PI,y=[],b=0,w=50/m,x=200/m,S=x-w,C=w,k=C+S,T=-x;for(v=C;k>=v;v+=.01)v=Math.min(v,k),y[y.length]=p+(b+m*v)*Math.sin(v+T)*t.zoom,y[y.length]=g+(b+m*v)*Math.cos(v+T)*t.zoom;s.add(new e.Line({points:y,stroke:"red",strokeWidth:1,opacity:.9}))}for(var m=20;100>m;m+=30){var v=Math.PI,y=[],b=0,w=50/m,x=200/m,S=x-w;console.log("fromX",w);var C=w,k=C+S,T=-w;for(v=C;k>=v;v+=.01)v=Math.min(v,k),y[y.length]=p+(b+m*v)*Math.cos(v+T)*t.zoom,y[y.length]=g+(b+m*v)*Math.sin(v+T)*t.zoom;s.add(new e.Line({points:y,stroke:"blue",strokeWidth:1,opacity:.9}))}_.each(this.planets,function(n){s.add(new e.Circle({x:i.width/2,y:i.height/2,radius:n.radius*t.zoom,stroke:"white",strokeWidth:1,opacity:.2}))}),_.each(this.planets,function(n){s.add(new e.Circle({id:"planet-"+n.name,x:i.width/2+n.radius*Math.sin(n.angle)*t.zoom,y:i.height/2+n.radius*Math.cos(n.angle)*t.zoom,radius:n.size*t.zoom,stroke:"white",fill:"white",strokeWidth:1,opacity:.5})),t.animations["movePlanet"+n.name]={element:"#planet-"+n.name,timeStart:(new Date).getTime(),angle:n.angle,planet:n};var r=2*Math.PI*n.radius*1e3,o=r/n.speed*360;console.log("planet",n,r,parseInt(o/864e5))}),s.add(new e.Circle({id:"star",x:i.width/2,y:i.height/2,radius:20*t.zoom,stroke:"orange",fill:"orange",strokeWidth:1,opacity:.5})),console.log("backgroundGroup",s.width(),n.width())},n.prototype.stageSize=function(){return{width:this.stageWidth,height:this.stageHeight}},n.prototype.render=function(){var t=this;if(this.initStatus){var e=(new Date).getTime();if(t.animations&&e-this.prevRenderTime>6e4){var n=this.stageSize();this.prevRenderTime=e;var i=!1;for(var r in t.animations){var o=t.stage.findOne(t.animations[r].element);if(o){var a=t.animations[r].planet,s=2*Math.PI*a.radius*1e3,l=s/a.speed*360,h=e-t.animations[r].timeStart;a.angle=t.animations[r].angle+360/l*h*(Math.PI/180),o.x(n.width/2+a.radius*Math.sin(a.angle)*t.zoom),o.y(n.height/2+a.radius*Math.cos(a.angle)*t.zoom),i=!0}}if(i){var c=t.stage.findOne("#main");c.draw()}}}return this},n.prototype.resize=function(){this.width=$(this.params.container).width(),this.height=$(this.params.container).height();var t=this.stageSize();this.stage.size(t);var e=this.stage.findOne("#bgImg");e&&(console.log("set bgImg",t),e.size(t));this.stage.find("#bg");return this},n}),define("views/index/error",["backbone"],function(t,e){var n=t.View.extend({id:"modal-error",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("page-index-error")},render:function(){console.log("this.params.error",this.params.error),this.$el.html(this.template({error:this.params.error,t:$.t}));var t=this;return this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this}});return n}),define("views/index/index",["backbone","backbone-validation","views/helpers/controll","views/helpers/stars"],function(t,e,n,i){var r=t.View.extend({className:"content-inner",events:{"click #serverNameSelect":"toggleServerList","click #langSelect":"toggleLangList","click #auth_signup-form a":"links","submit #auth_signup-form":"submit","click #serverList ul li":"selectServer","click #langs .datalist-langList li":"selectLang","click #playBtn":"play"},initialize:function(t){this.params=t,this.params.controllerName="index",this.template=this.getTemplate("page-index-index");var e=this;this.listenTo(this.params.app,"resize",function(){e.resize()})},render:function(){this.$el.html(this.template({t:$.t,langs:this.params.langs,langSelect:this.params.profile.getLang(),serverSelect:this.params.profile.getServer(),serverList:this.params.serverList}));var t=new n(this.params);this.$el.find("#bottom").html(t.render().$el);var e=this;return _.defer(function(){}),this.params.serverList.length||(e.loaderActive(),this.params.init(function(){setTimeout(function(){e.render(),e.loaderHideAndShowYourServer()},1e3)})),this},play:function(){var t=this;t.loaderProgress(),t.$el.find("#yourServer").hide(),t.$el.find("#langs").hide();var e=0;this.t=setInterval(function(){var n=10*++e;t.$el.find("#loader .value").text(n+"%"),t.$el.find(".loader-progress-line").css("width",n+"%"),100==n&&(t.params.starsHelper.jump(),t.$el.find("#yourServer").hide(),t.$el.find("#loader").hide(),t.params.play({success:function(){},error:function(){t.render()}}),clearInterval(t.t))},100)},loaderActive:function(){var t=this;t.$el.find("#loader").show(),t.$el.find(".loader-progress").addClass("active")},loaderProgress:function(){var t=this;t.$el.find(".loader-progress").show(),t.$el.find("#loader").show()},loaderHideAndShowYourServer:function(){var t=this;t.$el.find(".loader-progress").removeClass("active").hide(),t.$el.find("#loader").hide(),t.$el.find("#yourServer").show(),t.$el.find("#langs").show()},toggleServerList:function(t){var e=this.$el.find("#serverList");$(e).toggle()},toggleLangList:function(t){var e=this.$el.find("#langList");$(e).toggle()},hideLangList:function(){var t=this;t.$el.find("#langList").hide()},showServerList:function(){var t=this;t.$el.find("#loader").hide(),t.$el.find("#serverList").show()},hideServerList:function(){var t=this;t.$el.find("#serverList").hide()},selectServer:function(t){var e=$(t.currentTarget).data("value"),n=this.params.serverList.findWhere({code:e});this.params.profile.setServer(n),this.hideServerList(),this.render()},selectLang:function(t){var e=this,n=$(t.currentTarget).data("value");this.params.profile.setLang(n,function(){e.render()})},resize:function(){}}),o=t.View.extend({className:"content-inner",events:{},initialize:function(t){this.params=t,this.params.controllerName="index",this.template=this.getTemplate("page-index"),this.starsHelper=new i("app-stars")},render:function(){this.$el.html(this.template({t:$.t}));var t=this;this.params.starsHelper=this.starsHelper;var e=new r(this.params);return e.render(),this.$el.find(".layout").html(e.el),_.defer(function(){t.starsHelper.init()}),this.listenTo(this.params.app,"frame",function(){t.starsHelper.frameRender()}),this.listenTo(this.params.app,"resize",function(){t.starsHelper.resize()}),this}});return o}),define("views/planet/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/topInfo","views/helpers/planetmap"],function(t,e,n,i,r,o,a){var s=t.View.extend({className:"content-inner",events:{"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="planet",this.template=this.getTemplate("page-planet-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new r(this.params);this.$el.find("#bottom").html(t.render().$el);var e=new n(this.params);this.$el.find("#chats").html(e.render().$el);var s=new i(this.params);this.$el.find("#menu").html(s.render().$el);var l=new o(this.params);this.$el.find("#topInfo").html(l.render().$el);var h=this,c=new a({container:h.$el.find("#planetMap")[0]});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),h.resize(),c.init()}),this.listenTo(this.params.app,"frame",function(){c.render()}),this.listenTo(this.params.app,"resize",function(){h.resize(),c.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return s}),define("views/raid/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/raidmap"],function(t,e,n,i,r,o){var a=t.View.extend({className:"content-inner",events:{"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="raid",this.template=this.getTemplate("page-raid-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new r(this.params);this.$el.find("#bottom").html(t.render().$el);var e=new n(this.params);this.$el.find("#chats").html(e.render().$el);var a=new i(this.params);this.$el.find("#menu").html(a.render().$el);var s=this,l=new o({raids:this.params.app.config.raids,container:s.$el.find("#raidMap")[0],infoBtn:function(t){s.params.infoWindow(t)}});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),s.resize(),l.init()}),this.listenTo(this.params.app,"frame",function(){l.render()}),this.listenTo(this.params.app,"resize",function(){s.resize(),l.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return a}),define("views/raid/info",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-raidInfo",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("page-raid-info")},render:function(){this.$el.html(this.template({t:$.t,raid:this.params.raid}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/saga/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/sagamap"],function(t,e,n,i,r,o){var a=t.View.extend({className:"content-inner",events:{"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="saga",this.template=this.getTemplate("page-saga-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new r(this.params);this.$el.find("#bottom").html(t.render().$el);var e=new n(this.params);this.$el.find("#chats").html(e.render().$el);var a=new i(this.params);this.$el.find("#menu").html(a.render().$el);var s=this,l=new o({sagas:this.params.app.config.sagas,container:s.$el.find("#sagaMap")[0],infoBtn:function(t){s.params.infoWindow(t)}});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),s.resize(),l.init()}),this.listenTo(this.params.app,"frame",function(){l.render()}),this.listenTo(this.params.app,"resize",function(){s.resize(),l.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return a}),define("views/saga/info",["backbone","backbone-validation"],function(t,e){var n=t.View.extend({id:"modal-sagaInfo",events:{},initialize:function(t){this.params=t,this.template=this.getTemplate("page-saga-info")},render:function(){console.log(this.params),this.$el.html(this.template({t:$.t,saga:this.params.saga}));var t=this;return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),t.resize()}),this.listenTo(this.params.app,"resize",function(){t.resize()}),this.$el.find(".modal").modal("show"),this.$el.find(".modal").on("hidden.bs.modal",function(e){t.remove()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return n}),define("views/system/index",["backbone","backbone-validation","views/helpers/chats","views/helpers/menu","views/helpers/controll","views/helpers/topInfo","views/helpers/systemmap"],function(t,e,n,i,r,o,a){var s=t.View.extend({className:"content-inner",events:{"click #creditsBtn":function(){this.params.openWindow("credits")}},initialize:function(t){this.params=t,this.params.controllerName="system",this.template=this.getTemplate("page-system-index")},render:function(){this.$el.html(this.template({t:$.t}));var t=new r(this.params);this.$el.find("#bottom").html(t.render().$el);var e=new n(this.params);this.$el.find("#chats").html(e.render().$el);var s=new i(this.params);this.$el.find("#menu").html(s.render().$el);var l=new o(this.params);this.$el.find("#topInfo").html(l.render().$el);var h=this,c=new a({container:h.$el.find("#systemMap")[0],infoBtn:function(){}});return _.defer(function(){$('[data-toggle="tooltip"]').tooltip(),h.resize(),c.init()}),this.listenTo(this.params.app,"frame",function(){c.render()}),this.listenTo(this.params.app,"resize",function(){h.resize(),c.resize()}),this},resize:function(){},submit:function(t){return t.preventDefault(),!1}});return s}),define("vk",["config","vkontakte"],function(t){VK.init(t.vkontakte.init)})}();